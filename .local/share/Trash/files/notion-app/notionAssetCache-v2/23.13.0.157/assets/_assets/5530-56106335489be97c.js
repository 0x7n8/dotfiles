"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5530],{81575:(e,t,o)=>{o.d(t,{AK:()=>m,Mc:()=>l,OS:()=>d,Td:()=>S,Uu:()=>a,XC:()=>s,ZK:()=>v,e8:()=>u,gV:()=>p,hc:()=>f,n0:()=>y,u0:()=>g,xi:()=>c});var i=o(97978),n=o(15010),r=o(35057);function l(e){i.j(e,"add_slack_integration")}function a(e){i.j(e,"remove_slack_integration")}function s(e,t){i.j(e,"slack_notification_create",t)}function c(e,t){i.j(e,"slack_notification_delete",t)}function d(e,t){i.j(e,"slack_notification_update",t)}function p(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_render_button",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id})}function u(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_render_invite_popup",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id})}function m(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_click_invite_button",{subscription_tier:o,domain_type:l,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function g(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_completed",{subscription_tier:o,domain_type:l,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id,error:t.error,invite_stage:t.invite_stage})}function S(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_dismiss_popup",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id})}function f(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_click_select_all",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_user_count:t.invited_user_count,is_unselect:t.is_unselect,invite_token_query:t.invite_token_query})}function y(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_start_slack_integration",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id,from:t.from})}function v(e,t){const o=r.zt(),l=n.JF();i.j(e,"slack_imports_invite_complete_slack_integration",{subscription_tier:o,domain_type:l,origin:t.origin,invite_flow_id:t.invite_flow_id,from:t.from,is_success:t.is_success})}},17501:(e,t,o)=>{o.d(t,{C:()=>d,R:()=>c});var i=o(480),n=o(86628),r=o(66890),l=o(49117),a=o(33929),s=o(6258);function c(e){const{store:t,automationStore:o}=e,r=(0,i.O7)().currentUser.id;return(0,n.VK)((()=>{const e=t.getRecordStoreUIRoot();if(o&&e instanceof s.G)return(0,l.Gb)({type:"button_block",automationStore:o,blockStore:t,pageStore:e,intl:a.default.getIntl(),parentRecordStore:o,currentUserId:r})}),[o,t,r])}function d(e){const{automationStore:t,propertyId:o,propertySchema:s}=e,c=(0,i.O7)(),d=(0,r.DK)(),p=c.currentUser.id;return(0,n.VK)((()=>{if(t&&d)return(0,l.Gb)({automationStore:t,collectionContextStore:d,currentUserId:p,intl:a.default.getIntl(),parentRecordStore:t,propertyId:o,propertySchema:s,type:"button_property"})}),[t,d,p,o,s])}},57410:(e,t,o)=>{o.d(t,{Z:()=>V});o(57658);var i=o(43261),n=o.n(i),r=o(67294),l=o(480),a=o(86628),s=o(24405),c=o(6695),d=o(56666),p=o(37612),u=o(9291),m=o(53965),g=o(26249),S=o(73657),f=o(52275),y=o(68894),v=o(32163),h=o(72495),x=o(69872),b=o(65183),w=o(33929),_=o(29798),C=o(85893);const j=(0,u.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"},none:{defaultMessage:"None",id:"database.viewSettings.propertySelect.noneMessage"},remove:{defaultMessage:"Remove",id:"database.viewSettings.propertySelect.removeMessage"}});function M(e){let{currentProperty:t,showNoneOption:o,showRemoveOption:i,getProperties:g,onAccept:M,inputPlaceholder:V,defaultShowPropertyCount:k,schema:T,format:F,renderProperty:K}=e;const P=(0,l.Fy)(),[Z,B]=(0,r.useState)(""),[z,L]=(0,r.useState)(!1),O=(0,a.qz)(void 0,_.Z),A=(0,s.yK)((e=>({icon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},menuItem:{color:e.mediumTextColor}})),[]),I=(0,c.iB)(F,T,void 0,c.j5.Page).collection_page_properties||[],R=!k||z,W=w.default.formatMessage(j.none),H=o?{key:"none",render:e=>(0,C.jsx)(f.Z,{...e,checkState:!t,title:W}),action:()=>{M(void 0)}}:void 0,D=i?{key:"remove",render:e=>(0,C.jsx)(f.Z,{...e,icon:(0,p.y)(A.icon),title:w.default.formatMessage(j.remove)}),action:()=>{M(void 0)}}:void 0,E=g();let G=m.MR(E,(e=>I.findIndex((t=>t.property===e))));if(Z){const e=new Map;let t=G.map((t=>{const o=T[t],i=o?`${o.name} ${b.SO[o.type]}`:"";return e.set(t,i),i}));t=n().filter(Z,t).map((e=>{let{original:t}=e;return t})),G=G.filter((o=>t.includes(e.get(o)||"")))}else!R&&k&&(G=G.slice(0,k));const Q=m.oA([!Z||n().test(Z,W)?H:void 0,...G.map((e=>function(e,t,o,i,n){const r=t[e];if(!r)return;const l={key:e,render:t=>{const o=e===i;return n?n(t,e,o,r):(0,C.jsx)(x.Z,{...t,propertySchema:r,format:x.L.Name,checkState:o})},action:()=>{o(e)}};return l}(e,T,M,t,K)))]);if(!R&&E.length>G.length&&!Z){const e={key:"show_more",render:e=>(0,C.jsx)(f.Z,{...e,icon:(0,d.o)(A.icon),style:A.menuItem,title:(0,C.jsx)(u.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:E.length-G.length}})}),action:()=>{L(!0)}};Q.push(e)}const N=Q.length>0,U=Boolean(Z),$=!D||N||U;$&&!N&&Q.push({action:m.ZT,key:"noResults",render:e=>(0,C.jsx)(S.Z,{...e,caption:(0,C.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});const q=[];return $&&q.push({key:"input",comp:(0,C.jsx)(h.Z,{children:(0,C.jsx)(y.ZP,{focusInitial:!P.isMobile||void 0,focus:!P.isMobile||void 0,value:Z,onChange:e=>{B(e.target.value),O.setState({...O.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),L(!1)},placeholder:V||w.default.formatMessage(j.inputPlaceholder)})})}),(Q.length>0||D)&&q.push({key:"properties",comp:(0,C.jsx)(v.Z,{type:v.i.Vertical,initialFocus:0,sections:[...Q.length>0?[{key:"results",render:e=>(0,C.jsx)(h.Z,{...e}),items:Q}]:[],...D?[{key:"remove",render:e=>(0,C.jsx)(h.Z,{topBorder:Q.length>0,...e}),items:[D]}]:[]],store:O})}),(0,C.jsx)(C.Fragment,{children:q.map((e=>{let{key:t,comp:o}=e;return(0,C.jsx)(r.Fragment,{children:o},t)}))})}const V=r.memo(M,g.Z)},33732:(e,t,o)=>{o.d(t,{Z:()=>de,v:()=>ce});o(57658),o(21703);var i=o(67294),n=o(480),r=o(86628),l=o(24405),a=o(49085),s=o(15145),c=o(6906),d=o(99036),p=o(12396),u=o(53877),m=o(6695),g=o(9291),S=o(53965),f=o(7032),y=o(37810),v=o(36610),h=o(8406),x=o(5149),b=o(96802),w=o(8055),_=o(80402),C=o(13447),j=o(4430),M=o(75330),V=o(10906),k=o(64921),T=o(31945),F=o(74194),K=o(78140),P=o(53437),Z=o(58297),B=o(72495),z=o(24006),L=o(86825),O=o(28020),A=o(40863),I=o(33929);const R=(0,g.defineMessages)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),W=(0,g.defineMessages)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}});function H(e){return e?"page_content"===e.type?I.default.formatMessage(R.page_content):"page_cover"===e.type?I.default.formatMessage(R.page_cover):void 0:I.default.formatMessage(R.none)}function D(e){switch(e){case"small":return I.default.formatMessage(W.small);case"medium":return I.default.formatMessage(W.medium);case"large":return I.default.formatMessage(W.large)}}var E=o(92918),G=o(65183),Q=o(48543),N=o(84210),U=o(60709),$=o(18514),q=o(80444),Y=o(77080),J=o(36857),X=o(88923),ee=o(73590),te=o(94166),oe=o(18533),ie=o(57410),ne=o(8306),re=o(85893);const le=6,ae=6,se=a.default.createClass(void 0);function ce(e){const{currentViewType:t,theme:o}=e,i=t?Q.Ls[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,title:(0,Q.LQ)(e),body:(0,re.jsxs)(re.Fragment,{children:[(0,Q.RI)(e),i&&t&&e===i&&(0,re.jsx)("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor},children:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:(0,c.Z)(t)}})})]}),icon:(0,Q.RO)(e)({width:16,fill:o.mediumTextColor})})))}const de=(0,g.injectIntl)((function(e){let{collectionContextStore:t,showDoneButton:o,collectionSettingsStore:a}=e;const s=(0,l.Fg)(),c=(0,n.O7)(),p=(0,n.Fy)(),u=(0,r.qz)(void 0,se),m=(0,r.VK)((()=>Y.default.checkGate("charts_mvp")),[]),S=(0,i.useCallback)((e=>(0,re.jsx)(Fe,{collectionContextStore:t,hoveredTypeStore:u,viewType:e})),[t,u]),f=(0,i.useCallback)((()=>function(e){e.setState(void 0)}(u)),[u]),y=(0,r.VK)((()=>t.normalizedQueryStore.state),[t]),v=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),w=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]),_=(0,r.VK)((()=>t.isFullScreen.state),[t]),M=(0,r.VK)((()=>t.isRootChild.state),[t]),V=(0,r.VK)((()=>t.collectionViewBlockStore()),[t]),k=(0,r.VK)((()=>pe(t)),[t]),T=(0,r.VK)((()=>Boolean(ue(t))),[t]),F="table"===k||"board"===k||"gallery"===k,K="table"===k,P=Object.keys(v).filter((e=>{const t=v[e];return t&&(0,d.Lt)(t)})),z="timeline"===k&&P.length>0,A=(0,r.VK)((()=>"timeline"===k&&P.length>1&&V&&!(0,O.qG)(V.id)),[k,P,V]),I="timeline"===k&&Boolean(null==y?void 0:y.timeline_by_end),R="calendar"===k&&P.length>0,W=(0,r.VK)((()=>"calendar"===k&&Y.default.checkGate("collections_calendar_toggle_weekends")),[k]),H="calendar"===k,D="board"===k,E=(0,r.VK)((()=>(0,j.d$)({environment:c,isFullScreen:_,isRootChild:M})),[c,_,M]),Q="timeline"===k&&Boolean(w.timeline_show_table)&&E,N="timeline"===k&&E,U=(0,r.VK)((()=>null==V?void 0:V.getCollectionViewSourceCollectionStore()),[V]),q=(0,r.VK)((()=>!("collectionTypedView"===t.contextType||U&&_)),[t,U,_]),J=(0,r.VK)((()=>!t.isInHomeWidget.state),[t]),X=(0,r.VK)((()=>t.permissionScopes.state),[t]),te=(0,r.VK)((()=>u.state||k),[u,k]),oe=(0,r.VK)((()=>t.shouldShowSource.state),[t]);if(!V)return null;const ie="page"===k,le=["table","board","timeline","calendar","list","gallery"];return m&&le.push("chart"),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(B.Z,{topBorder:!1,shouldShowBottomDivider:p.isMobile,children:(0,re.jsxs)("div",{style:{...!p.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...p.isMobile&&{background:s.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},onMouseLeave:f,children:[(0,re.jsx)("div",{style:{display:"flex",flexFlow:"wrap",justifyContent:"center"},children:le.map(S)}),(0,re.jsx)("div",{style:{color:s.lightTextColor,fontSize:12,margin:"6px 8px 0px 8px"},children:G.sN[te]})]})}),(0,re.jsxs)(B.Z,{children:[q&&(0,re.jsx)(L.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:oe,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const i=!t.shouldShowSource.state;C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:e,perform:e=>{b.FH({stores:[o],update:{hide_linked_collection_name:!i},transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"toggle_show_collection_title"})}(c,t),disabled:!X.canConfigureBlock,textWrapperStyle:{opacity:1}}),T&&(0,re.jsx)(Te,{collectionContextStore:t}),K&&(0,re.jsx)(we,{collectionContextStore:t}),F&&(0,re.jsx)(_e,{collectionContextStore:t}),ie&&(0,re.jsx)(Se,{collectionContextStore:t}),z&&(0,re.jsx)(fe,{collectionContextStore:t}),I&&(0,re.jsx)(ye,{collectionContextStore:t}),A&&(0,re.jsx)(Ce,{collectionContextStore:t}),R&&(0,re.jsx)(ve,{collectionContextStore:t}),H&&(0,re.jsx)(je,{collectionContextStore:t}),W&&(0,re.jsx)(Me,{collectionContextStore:t}),N&&(0,re.jsx)(ne.N,{collectionContextStore:t}),Q&&(0,re.jsx)(he,{collectionContextStore:t,collectionSettingsStore:a}),D&&(0,re.jsx)(xe,{collectionContextStore:t,collectionSettingsStore:a}),J&&(0,re.jsx)(Ve,{collectionContextStore:t}),(0,re.jsx)(ke,{collectionContextStore:t})]}),o&&(0,re.jsx)(B.Z,{disableMobileBorders:!0,children:(0,re.jsx)(Z.Z,{style:{display:"flex",margin:"0 14px"},onClick:()=>function(e,t,o){x.wl({collectionSettingsStore:t,item:{type:"main"}}),h.wd({environment:e,collectionContextStore:o,action:"click_create_view_done"})}(c,a,t),children:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"})})}),(0,re.jsx)(B.Z,{topBorder:!1,children:(0,re.jsx)(ee.Z,{href:(0,$.UY)("guides.databaseView"),title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})})]})}));function pe(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function ue(e){return G.DL[pe(e)]}function me(e){return G.oy[pe(e)]}function ge(e){return G._Y[pe(e)]}function Se(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,r.VK)((()=>t.collectionViewStore()),[t]);return i?(0,re.jsx)("div",{style:{padding:5},children:(0,re.jsx)(F.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{J.Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=J.Z.state.pageId;t&&C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:o,perform:e=>{b.FH({stores:[i],update:{page_pointer:{id:(0,f.Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})}):null}function fe(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,n.MO)(),l=(0,r.VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by}),[t]),a=(0,r.VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),s=(0,r.VK)((()=>t.permissionScopes.state),[t]),c=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,r.VK)((()=>t.collectionViewStore()),[t]),u=(0,r.VK)((()=>t.collectionStore()),[t]),m=(0,r.VK)((()=>null==u?void 0:u.getSchema()),[u]),S=(0,r.VK)((()=>null==u?void 0:u.getFormat()),[u]);if(!(l&&p&&u&&S&&m))return null;const f=c[l];return f?(0,re.jsx)(T.ZP,{popupType:i?P.kQ.SlideUp:P.kQ.Popup,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te.Z,{title:a?(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}):(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!s.canConfigureBlock,showChevron:!0,right:(0,re.jsx)("div",{style:y.Z.textOverflowStyle,children:f.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let n;return n=i?{menuType:U.og.ActionSheet}:{menuType:U.og.Popup,width:300},(0,re.jsx)(K.Z,{...n,children:(0,re.jsx)(ie.Z,{schema:m,format:S,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,d.Lt)(t)})),onAccept:i=>{i&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:o,perform:e=>{M.Es({collectionViewStore:p,update:{timeline_by:i},transaction:e})}}),e.close(),h.wd({environment:o,collectionContextStore:t,action:"update_timeline_by",original_view_type:void 0,property_type:f.type}))}})})}}):null}function ye(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,n.MO)(),l=(0,r.VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),a=(0,r.VK)((()=>t.permissionScopes.state),[t]),s=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,r.VK)((()=>t.collectionViewStore()),[t]),p=(0,r.VK)((()=>t.collectionStore()),[t]),u=(0,r.VK)((()=>null==p?void 0:p.getSchema()),[p]),m=(0,r.VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&c&&p&&m&&u))return null;const S=s[l];return S?(0,re.jsx)(T.ZP,{popupType:i?P.kQ.SlideUp:P.kQ.Popup,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:S.name,disabled:!a.canConfigureBlock,...e}),render:e=>{let n;return n=i?{menuType:U.og.ActionSheet}:{menuType:U.og.Popup,width:300},(0,re.jsx)(K.Z,{...n,children:(0,re.jsx)(ie.Z,{schema:u,format:m,currentProperty:l,getProperties:()=>Object.keys(s).filter((e=>{const t=s[e];return t&&(0,d.Lt)(t)})),onAccept:i=>{i&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:o,perform:e=>{M.Es({collectionViewStore:c,update:{timeline_by_end:i},transaction:e})}}),e.close(),h.wd({environment:o,collectionContextStore:t,action:"update_timeline_by_end",original_view_type:void 0,property_type:S.type}))}})})}}):null}function ve(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,n.MO)(),l=(0,r.VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by}),[t]),a=(0,r.VK)((()=>t.permissionScopes.state),[t]),s=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,r.VK)((()=>t.collectionViewStore()),[t]),p=(0,r.VK)((()=>t.collectionStore()),[t]),u=(0,r.VK)((()=>null==p?void 0:p.getSchema()),[p]),m=(0,r.VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&c&&p&&m&&u))return null;const S=s[l];return S?(0,re.jsx)(T.ZP,{popupType:i?P.kQ.SlideUp:P.kQ.Popup,alignmentToOrigin:T.vR.End,placementToOrigin:T.pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,re.jsx)("div",{style:y.Z.textOverflowStyle,children:S.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let n;return n=i?{menuType:U.og.ActionSheet}:{menuType:U.og.Popup,width:300},(0,re.jsx)(K.Z,{...n,children:(0,re.jsx)(ie.Z,{schema:u,format:m,currentProperty:l,getProperties:()=>Object.keys(s).filter((e=>{const t=s[e];return t&&(0,d.Lt)(t)})),onAccept:i=>{i&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:o,perform:e=>{M.Es({collectionViewStore:c,update:{calendar_by:i},transaction:e})}}),e.close(),h.wd({environment:o,collectionContextStore:t,action:"update_calendar_by",original_view_type:void 0,property_type:S.type}))}})})}}):null}function he(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,n.O7)(),l=((0,r.VK)((()=>t.normalizedFormatStore.state),[t]).timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,a=(0,r.VK)((()=>t.permissionScopes.state),[t]);return(0,re.jsx)(te.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:l}}),onClick:()=>{x.H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"table"}}),h.wd({environment:i,collectionContextStore:t,action:"click_timeline_table_properties"})},disabled:!a.canConfigureBlock})}function xe(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,n.O7)(),l=(0,r.VK)((()=>t.normalizedFormatStore.state.board_columns_by),[t]),a=(0,r.VK)((()=>t.normalizedSchemaStore.state),[t]),s=(0,r.VK)((()=>t.permissionScopes.state),[t]),c=(0,r.VK)((()=>(0,E.h6)(t.normalizedFormatStore.state)),[t]);if(!l)return null;const d=a[l.property];return d?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(te.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.layoutTab.boardGroupByButton.title"}),showChevron:!0,right:d.name,onClick:()=>{x.H4({collectionSettingsStore:o,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),h.wd({environment:i,collectionContextStore:t,action:"click_board_group_by",original_view_type:void 0,property_type:d.type})},disabled:!s.canConfigureBlock}),(0,re.jsx)(L.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!c,focused:!1,onClick:()=>{x.iN({environment:i,collectionContextStore:t})},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})]}):null}function be(e,t,o){const i=o.collectionViewStore();if(!i)return;const{serverCommitResult:n}=C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:t,perform:t=>{b.FH({stores:[i],update:{calendar_view_range:e},transaction:t})}}),r=O.AK.state,l=o.dateRangeStart.state,a=o.dateRangeEnd.state,{newDateRangeStart:s,newDateRangeEnd:c}=function(e){const{newViewRange:t,oldCalendarEnd:o,startOfWeekSetting:i}=e;if("month"===t){const e=(0,u.IS)((0,u.kl)(o),i);return{newDateRangeStart:e,newDateRangeEnd:(0,u.V7)((0,u._)({date:e,monthsToAdd:1}),i)}}return{newDateRangeStart:(0,u.IS)(Date.now(),i),newDateRangeEnd:(0,u.V7)(Date.now(),i)}}({oldCalendarEnd:a,newViewRange:e,startOfWeekSetting:r});M.t5({dateRangeStart:s,dateRangeEnd:c,collectionContextStore:o}),n.then((()=>{h.wd({environment:t,collectionContextStore:o,action:"update_calendar_view_range"})})).catch((()=>{M.t5({dateRangeStart:l,dateRangeEnd:a,collectionContextStore:o})}))}function we(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,r.VK)((()=>t.permissionScopes.state),[t]),l=(0,r.VK)((()=>!Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines)),[t]);return(0,re.jsx)(L.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:l,focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const i=Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines);_.AU({environment:e,collectionViewStore:o,currentValue:i}),h.wd({environment:e,collectionContextStore:t,action:"toggle_table_vertical_lines"})}(o,t),disabled:!i.canConfigureBlock,textWrapperStyle:{opacity:1}})}function _e(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,r.VK)((()=>t.normalizedFormatStore.state),[t]),l=(0,r.VK)((()=>t.permissionScopes.state),[t]),a=(0,r.VK)((()=>pe(t)),[t]);return(0,re.jsx)(L.Z,{title:"table"===a?(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"}):(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"}),on:Boolean(i.table_wrap),focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const i=Boolean(t.normalizedFormatStore.state.table_wrap);_.qY({environment:e,collectionViewStore:o,currentValue:i}),v.wd(e,{view_type:pe(t),action:"set_first_load_limit"}),h.wd({environment:e,collectionContextStore:t,action:"toggle_table_wrap_cells"})}(o,t),disabled:!l.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Ce(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),i=(0,r.VK)((()=>t.normalizedQueryStore.state),[t]),l=null==i?void 0:i.timeline_by_end,a=(0,r.VK)((()=>t.permissionScopes.state),[t]);return(0,re.jsx)(L.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(l),onClick:()=>function(e,t){const o=t.normalizedQueryStore.state,i=t.collectionViewStore(),n=null==o?void 0:o.timeline_by,r=null==o?void 0:o.timeline_by_end;if(!n||!i)return;const l=r?void 0:n;C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:e,perform:e=>{M.Es({collectionViewStore:i,update:{timeline_by_end:l??null},transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"toggle_timeline_separate_dates"})}(o,t),disabled:!a.canConfigureBlock,textWrapperStyle:{opacity:1}})}function je(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),l=(0,r.VK)((()=>t.permissionScopes.state),[t]),a=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}(t)),[t]),s=(0,r.VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),c=(0,i.useMemo)((()=>["month","week"].map((e=>({key:e,title:I.default.formatMessage(A.Lh[e])})))),[]);return(0,re.jsx)(oe.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:t,openButtonPopup:s,selectedKey:a,popupStyle:{minWidth:190},options:c,onChange:e=>be(e,o,t),disabled:!l.canConfigureBlock})}function Me(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),l=(0,r.VK)((()=>{var e;return Boolean((null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("calendar_show_weekends").getValue())??!0)}),[t]),a=(0,i.useCallback)((()=>{const e=t.collectionViewStore();e&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleToggleShowWeekends",environment:o,perform:t=>{b.FH({stores:[e],update:{calendar_show_weekends:!l},transaction:t})}}),h.wd({environment:o,collectionContextStore:t,action:"toggle_calendar_show_weekends"}))}),[t,o,l]);return(0,re.jsx)(te.Z,{title:(0,re.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show weekends",id:"database.viewSettings.layoutTab.showWeekends.title"})}),showChevron:!1,right:(0,re.jsx)(z.Z,{on:l,onClick:a,noColor:!1}),onClick:a})}function Ve(e){let{collectionContextStore:t}=e;const o=(0,l.Fg)(),i=(0,n.O7)(),a=(0,r.VK)((()=>t.permissionScopes.state),[t]),c=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=pe(e);return(null==t?void 0:t.collection_peek_mode)||Q.Ls[o]}(t)),[t]),d=(0,r.VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),p=(0,r.VK)((()=>pe(t)),[t]);return(0,re.jsx)(oe.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:t,openButtonPopup:d,selectedKey:c,popupStyle:{minWidth:190},options:ce({currentViewType:p,theme:o}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:()=>function(e,t){h.nS({environment:e,collectionContextStore:t,from:"collection_view_settings"})}(i,t),onChange:e=>function(e,t,o){const i=o.collectionViewStore();if(i&&e&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:t,perform:t=>{b.FH({stores:[i],update:{collection_peek_mode:e},transaction:t})}}),h.gl({environment:t,collectionContextStore:o,peek_mode:e,from:"collection_view_settings"}),X.default.state.open&&X.default.state.collectionContextStore===o)){const{mainEditorCurrentBlockStore:o}=q.default.state,i="full_page"===e?(0,N.ZP)({store:X.default.state.target,fullyQualified:!1,pageVisitSource:s.tY.Expand}):(0,V.mb)({store:X.default.state.target,mainEditorCurrentBlockStore:o,collectionContextStore:X.default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,X.getPeekModeFromCollectionPeekModeFormat)(e)});i&&w.c4({environment:t,url:i})}}(e,i,t),disabled:!a.canConfigureBlock})}function ke(e){let{collectionContextStore:t}=e;const o=(0,n.O7)(),l=(0,r.VK)((()=>t.shouldShowPageIcon()??!0),[t]),a=(0,i.useCallback)((()=>{const e=t.collectionViewStore();e&&(C.createAndCommit({userAction:"CollectionSettingsProperty.TitleOptions.handleToggleShowIcon",environment:o,perform:t=>{b.FH({stores:[e],update:{show_page_icon:!l},transaction:t})}}),h.wd({environment:o,collectionContextStore:t,action:"toggle_show_page_icon"}))}),[t,o,l]);return(0,re.jsx)(te.Z,{title:(0,re.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Show page icon",id:"database.viewSettings.layoutTab.showPageIcon.title"})}),showChevron:!1,right:(0,re.jsx)(z.Z,{on:l,onClick:a,noColor:!1}),onClick:a})}function Te(e){let{collectionContextStore:t}=e;const o=(0,l.Fg)(),i=(0,n.O7)(),{device:a}=i,s=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=ue(e);if(o&&t)return t[o]}(t)),[t]),c=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=me(e);if(o&&t){const e=t[o];if(e)return e}return m.PZ}(t)),[t]),d=(0,r.VK)((()=>!a.isMobile||"board"===pe(t)),[a,t]),u=(0,r.VK)((()=>t.permissionScopes.state),[t]),f=(0,r.VK)((()=>function(e,t,o){const i=o.normalizedSchemaStore.state;let n=Object.keys(i);n=S.MR(n,(e=>{const t=i[e];return t?t.name:""}));const r=S.oA(n.map((o=>{const n=i[o];if(n&&"file"===n.type)return{key:{type:"property",property:o},title:n.name,icon:(0,re.jsx)(p.ZP,{type:n.type,icon:n.icon,size:e.device.isMobile?16:14,theme:t,style:{fill:t.regularIconColor}})}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,title:H(e)}))),...r]}(i,o,t)),[i,o,t]),y=(0,r.VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=ge(e);if(o&&t)return t[o]}(t)),[t]);return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(oe.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:s,popupStyle:{minWidth:190},options:f,onChange:e=>function(e,t,o){const i=ue(o),n=o.collectionViewStore();i&&n&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:t,perform:t=>{b.FH({stores:[n],update:{[i]:e},transaction:t})}}),h.wd({environment:t,collectionContextStore:o,action:"update_cover_format"}))}(e,i,t),disabled:!u.canConfigureBlock}),d&&(0,re.jsx)(oe.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:c,popupStyle:{minWidth:190},options:["small","medium","large"].map((e=>({key:e,title:D(e)}))),onChange:e=>function(e,t,o){const i=me(o),n=o.collectionViewStore();i&&n&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:t,perform:t=>{b.FH({stores:[n],update:{[i]:e},transaction:t})}}),h.wd({environment:t,collectionContextStore:o,action:"toggle_cover_size_format"}))}(e,i,t),disabled:!u.canConfigureBlock}),s&&(0,re.jsx)(L.Z,{title:(0,re.jsx)(g.FormattedMessage,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===y,focused:!1,onClick:()=>function(e,t){const o=ge(t),i=t.collectionViewStore(),n=t.normalizedFormatStore.state;o&&i&&(C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:e,perform:e=>{b.FH({stores:[i],update:{[o]:"contain"===n[o]?"cover":"contain"},transaction:e})}}),h.wd({environment:e,collectionContextStore:t,action:"toggle_cover_aspect_format"}))}(i,t),disabled:!u.canConfigureBlock,textWrapperStyle:{opacity:1}})]})}function Fe(e){let{viewType:t,collectionContextStore:o,hoveredTypeStore:i}=e;const a=(0,l.Fg)(),s=(0,n.O7)(),c=(0,g.useIntl)(),d=(0,r.VK)((()=>pe(o)),[o]),p=(0,r.VK)((()=>o.permissionScopes.state),[o]),u=(0,r.VK)((()=>Y.default.checkGate("charts_mvp")),[]),m=d===t,S=m||!p.canConfigureBlock;return(0,re.jsxs)(k.Z,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:u?`calc(25% - ${2*le}px)`:`calc(33% - ${2*le}px)`,flexGrow:0,flexShrink:0,fontSize:11,borderRadius:4,margin:le,padding:ae,boxShadow:`0 0 0 1px ${a.regularDividerColor}`,color:a.mediumTextColor,fill:a.mediumTextColor,...m&&{boxShadow:`0 0 0 2px ${a.blueColor}`,color:a.blueColor,fill:a.blueColor,fontWeight:500}},disabled:S,onClick:()=>{C.createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:s,perform:e=>{M.z2({environment:s,collectionContextStore:o,newViewType:t,transaction:e,intl:c})}}),h.wd({environment:s,collectionContextStore:o,action:"change_type",original_view_type:d})},onMouseMove:()=>{i.setState(t)},children:[G.aW[t]({width:void 0,height:20,marginBottom:4,marginTop:4}),(0,re.jsx)("div",{children:G.Bh[t]})]},t)}},8306:(e,t,o)=>{o.d(t,{N:()=>ne,Z:()=>re});var i=o(43261),n=o.n(i),r=o(67294),l=o(480),a=o(86628),s=o(24405),c=o(49085),d=o(98953),p=o(99036),u=o(80951),m=o(12396),g=o(6695),S=o(5257),f=o(39132),y=o(61061),v=o(47453),h=o(37612),x=o(9291),b=o(53965),w=o(1898),_=o(37810),C=o(8406),j=o(5149),M=o(87085),V=o(96802),k=o(13447),T=o(4430),F=o(75330),K=o(73657),P=o(54119),Z=o(52275),B=o(79131),z=o(5145),L=o(73063),O=o(68894),A=o(32163),I=o(89728),R=o(72495),W=o(86825),H=o(26388),D=o(66957),E=o(68641),G=o(43224),Q=o(19124),N=o(33929),U=o(98742),$=o(18514),q=o(4023),Y=o(29798),J=o(73590),X=o(97372),ee=o(94166),te=o(85893);const oe=(0,x.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertiesTab.inputPlaceholder"},toggleFrozenColumnsAriaLabel:{defaultMessage:"Toggle frozen columns",id:"database.viewSettings.propertiesTab.toggleFrozenColumnsAriaLabel"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}}),ie=c.default.createClass("");function ne(e){const{collectionContextStore:t,onClick:o}=e,i=(0,l.O7)(),n=(0,a.Kw)(t.normalizedFormatStore),r=Boolean(n.timeline_show_table),s=(0,a.Kw)(t.permissionScopes);return(0,te.jsx)(W.Z,{title:(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:r,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(k.createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:i,perform:t=>{V.FH({stores:[e],update:{timeline_show_table:!r,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),C.wd({environment:i,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}const re=function(e){let{collectionContextStore:t,timelineViewTab:o,collectionSettingsStore:i}=e;const n=(0,l.O7)(),r=(0,a.qz)(void 0,Y.Z),s=(0,a.qz)(void 0,ie),c=(0,l.Fy)(),d=(0,a.VK)((()=>s.state),[s]),p=(0,a.VK)((()=>(0,E.WY)({collectionContextStore:t})),[t]),u=(0,a.VK)((()=>(0,E.jI)({timelineViewTab:o,collectionContextStore:t})),[o,t]),m=(0,a.VK)((()=>(0,T.d$)({environment:n,isFullScreen:t.isFullScreen.state,isRootChild:t.isRootChild.state})),[n,t]);return(0,te.jsxs)(X.ZP,{collectionSettingsStore:i,title:(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:(0,te.jsx)(R.Z,{children:(0,te.jsx)(O.ZP,{focusInitial:!c.isMobile,value:d,showClearButton:!0,onChange:e=>{s.setState(e.target.value),r.setState({...r.state,focus:{section:0,indexLocal:0,indexGlobal:0}})},placeholder:N.default.formatMessage(oe.inputPlaceholder)})}),footer:(0,te.jsx)(ce,{collectionContextStore:t,timelineViewTab:o}),children:["timeline"===p&&m&&(0,te.jsx)(ye,{collectionSettingsStore:i,collectionContextStore:t,timelineViewTab:o,inputStore:s}),u&&(0,te.jsx)(xe,{collectionContextStore:t,collectionSettingsStore:i,inputStore:s,menuListStore:r,formatKey:u}),(0,te.jsx)(R.Z,{children:(0,te.jsx)(de,{collectionContextStore:t,collectionSettingsStore:i,timelineViewTab:o})})]})};function le(e){let{viewType:t}=e;return"table"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===t||"chart"===t?null:void(0,w.t1)(t)}function ae(e){let{viewType:t}=e;return"table"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===t?(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===t||"chart"===t?null:void(0,w.t1)(t)}function se(e,t,o){const{formatKey:i,visibility:n}=e,r=t.collectionViewStore();if(!r)return;const l=t.normalizedFormatStore.state[i]||[];let a=l.filter((e=>Boolean(e.visible))),s=l.filter((e=>!Boolean(e.visible)));me.includes(i)&&(a=ge(a),s=ge(s));const c=[...a.map((e=>({...e,visible:n}))),...s.map((e=>({...e,visible:n})))];k.createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:o,perform:e=>{V.FH({stores:[r],update:{[i]:c},transaction:e})}})}function ce(e){let{collectionContextStore:t,timelineViewTab:o}=e;const i=(0,l.O7)(),n=(0,a.VK)((()=>t.permissionScopes.state),[t]),r=(0,a.VK)((()=>"timeline"===(0,E.WY)({collectionContextStore:t})&&"table"===o&&!(0,E.vw)({collectionContextStore:t})),[t,o]),s=n.canConfigureCollection&&!r&&!n.isExternallyImportedAndSyncedCollection;return(0,te.jsxs)(R.Z,{topBorder:!0,children:[s&&(0,te.jsx)(ee.Z,{icon:v.R,title:(0,te.jsx)(x.FormattedMessage,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:()=>function(e,t){t.collectionStore()&&(C.wd({environment:e,collectionContextStore:t,action:"click_new_property"}),j.wl({collectionSettingsStore:t.settingsStore,item:{type:"propertyType",onAccept:(o,i,n,r)=>{M.PW({environment:e,propertyType:o,isSuggestedProperty:i,propertyName:n,selectOptions:r,collectionContextStore:t,from:"view_settings"})}}}))}(i,t)}),(0,te.jsx)(J.Z,{href:(0,$.UY)("guides.databaseProperties"),title:(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})]})}function de(e){let{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:i}=e;const n=(0,l.O7)(),r=(0,a.VK)((()=>t.normalizedDeletedSchemaStore.state),[t]),s=Object.keys(r).length;return(0,a.VK)((()=>t.permissionScopes.state),[t]).canConfigureCollection&&s>0?(0,te.jsx)(ee.Z,{icon:h.y,title:(0,te.jsx)(x.FormattedMessage,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:()=>function(e,t,o,i){o.collectionStore()&&(C.wd({environment:e,collectionContextStore:o,action:"click_deleted_properties"}),j.H4({collectionSettingsStore:t,item:{type:"deletedProperties",timelineViewTab:i}}))}(n,o,t,i),right:s,showChevron:!0}):null}function pe(e,t,o){const i=o.state,n=t.permissionScopes.state;return!e.device.isMobile&&n.canConfigureBlock&&!i}function ue(e){e.reset()}const me=["board_properties","gallery_properties","calendar_properties"];function ge(e){const t=e.find((e=>"title"===e.property));return t?[t,...e.filter((e=>"title"!==e.property))]:e}function Se(e,t,o,i,n,r,l){const{formatKey:a,propertyFormat:s}=e,c=i.permissionScopes.state,v=!s.visible,h=i.normalizedSchemaStore.state,x=(0,u.Qm)({schema:h,property:s.property}),b=pe(t,i,l)&&("title"!==s.property||!me.includes(a)),w="title"!==s.property||function(e,t){const o=t.normalizedFormatStore.state,i=(0,E.WY)({collectionContextStore:t});return"board"===i?(0,g.Lw)(o.board_cover):"gallery"===i?(0,g.Lw)(o.gallery_cover):"timeline"===i&&("timeline_table_properties"===e||(0,g.vP)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}(a,i);let M=!c.canConfigureCollection||c.isSyncedCollection&&((0,d.w)(s.property)||(0,p.HF)(s.property));if("collectionTypedView"===i.contextType&&c.canConfigureBlock&&(M=!1),x)return{key:s.property,render:e=>{var r;return(0,te.jsx)(H.ZP,{disableTooltip:!(null!==(r=x.description)&&void 0!==r&&r.length),renderTooltip:e=>(0,te.jsxs)("div",{...e,style:G.F6,children:[(0,te.jsx)("div",{children:x.name}),void 0!==(null==x?void 0:x.description)&&x.description.length>0?(0,te.jsx)("div",{style:{color:o.mediumInvertedTextColor},children:x.description}):null]}),placement:q.u.Left,render:r=>(0,te.jsx)(Z.Z,{...(0,U.Z)(e,r),title:(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[b&&(0,te.jsx)(z.ZP,{iconSize:12,style:{marginRight:8}}),(0,te.jsx)(m.ZP,{type:x.type,icon:x.icon,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,te.jsx)("span",{style:{marginLeft:8,..._.Z.textOverflowStyle},children:x.name}),(0,p.qQ)(x)&&(0,p.q3)(x)&&("text"===x.type||(0,Q.KZ)())&&(0,te.jsx)(P.Z,{})]}),right:(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,te.jsx)(L.Z,{icon:v?y.B:f.c,iconStyle:{width:16,height:16},isDarkIconColor:!v,onClick:()=>{!function(e,t,o,i){var n;const{formatKey:r,propertyFormat:l}=e,a=o.collectionViewStore();if(!a)return;const s=o.normalizedFormatStore.state,c=(s[r]||[]).filter((e=>e.property!==l.property)),d={...l,visible:!l.visible},p=c.filter((e=>e.visible)),u=c.filter((e=>!e.visible));let m=[];m=me.includes(r)?!0===d.visible?[...ge([...p,d]),...ge(u)]:[...ge(p),...ge([d,...u])]:[...p,d,...u];const g={...s,[r]:m};k.createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:t,perform:e=>{F.iG({collectionViewStore:a,update:{format:g},transaction:e})}}),C.wd({environment:t,collectionContextStore:o,action:"toggle_property_visibility",original_view_type:a.getType(),property_type:null===(n=a.getCollectionStore())||void 0===n||null===(n=n.getSchema()[d.property])||void 0===n?void 0:n.type}),ue(i)}({formatKey:a,propertyFormat:s},t,i,l)},ariaLabel:n.formatMessage(oe.togglePropertyVisibilityAriaLabel),disabled:!w||!c.canConfigureBlock}),!M&&(0,S.o)({width:12,fill:o.lightTextColor,marginLeft:5})]})})})},action:()=>{M||function(e,t,o,i){var n,r,l;const a=(null===(n=i.collectionStore())||void 0===n?void 0:n.getSchema())||i.normalizedSchemaStore.state||{},{formatKey:s,propertyFormat:c}=e;C.wd({environment:t,collectionContextStore:i,action:"click_property",original_view_type:null==i||null===(r=i.collectionViewStore())||void 0===r?void 0:r.getType(),property_type:null===(l=a[c.property])||void 0===l?void 0:l.type}),j.H4({collectionSettingsStore:o,item:{type:"property",formatKey:s,property:c.property}})}({formatKey:a,propertyFormat:s},t,r,i)}}}function fe(e,t,o,i,n,r,l){const{formatKey:a,properties:s}=e;return b.oA(s.map((e=>Se({formatKey:a,propertyFormat:e},t,o,i,n,r,l))))}function ye(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:i,inputStore:n}=e;const a=(0,l.O7)(),s=(0,r.useCallback)((()=>function(e){ue(e)}(n)),[n]),c=(0,r.useCallback)((e=>function(e,t,o,i,n){C.wd({environment:t,collectionContextStore:i,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),j.FK({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:0===e?"timeline":"table"}}),ue(n)}(e,a,t,o,n)),[a,t,o,n]),d="timeline"===i?0:1;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(D.Z,{tabs:[(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),(0,te.jsx)(x.FormattedMessage,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:d,onChange:c}),"table"===i&&(0,te.jsx)(R.Z,{children:(0,te.jsx)(ne,{collectionContextStore:o,onClick:s})})]})}function ve(e){const t=(0,l.O7)(),{props:o,formatKey:i,children:n,collectionContextStore:r,inputStore:s}=e,c=(0,a.VK)((()=>r.permissionScopes.state),[r]),d=(0,a.VK)((()=>s.state),[s]),p=(0,a.VK)((()=>"timeline_table_properties"===i?"table":(0,E.WY)({collectionContextStore:r})),[r,i]);return(0,te.jsx)(R.Z,{...o,noTextOverflow:!0,isTitleUppercase:!1,title:(0,te.jsx)(ae,{viewType:p}),desktopTitleStyle:{height:19},right:!d&&c.canConfigureBlock&&(0,te.jsx)(I.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){C.wd({environment:t,collectionContextStore:o,action:"click_show_all_properties"}),se({formatKey:e,visibility:!0},o,t)}(i,t,r),children:(0,te.jsx)(x.FormattedMessage,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})}),style:{width:"100%",paddingBottom:0},children:n})}function he(e){const t=(0,l.O7)(),{formatKey:o,visibleProperties:i,hiddenProperties:n,children:r,collectionContextStore:s,inputStore:c,menuListStore:d}=e,p=b.oA([...i.map((e=>"title"===e.property&&me.includes(o)?{key:e.property,draggable:!1}:e.property)),i.length>0&&n.length>0&&{key:"group-header-hidden-property",draggable:!1},...n.map((e=>"title"===e.property&&me.includes(o)?{key:e.property,draggable:!1}:e.property))]);return(0,a.VK)((()=>pe(t,s,c)),[t,s,c])?(0,te.jsx)(B.ZP,{direction:"vertical",keys:p,renderKey:(e,t)=>r[t],onDrop:(e,i)=>{!function(e,t,o,i){const{formatKey:n,newPropertyKeys:r}=e,l=o.collectionViewStore();if(!l)return;const a=o.normalizedFormatStore.state[n]||[],s=r.indexOf("group-header-hidden-property");let c=b.oA(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));if(o)return s>=0?{...o,visible:Boolean(t<s)}:o}))),d=a.filter((e=>!r.includes(e.property)));me.includes(n)&&(c=ge(c),d=ge(d));const p=[...c,...d];k.createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:t,perform:e=>{V.FH({stores:[l],update:{[n]:p},transaction:e})}}),C.wd({environment:t,collectionContextStore:o,action:"reorder_properties",original_view_type:l.getType()}),i.reset()}({formatKey:o,newPropertyKeys:e},t,s,d)}}):(0,te.jsx)(te.Fragment,{children:r})}function xe(e){let{formatKey:t,collectionContextStore:o,collectionSettingsStore:i,inputStore:r,menuListStore:c}=e;const d=(0,s.Fg)(),p=(0,l.O7)(),m=(0,x.useIntl)(),g=(0,a.VK)((()=>o.permissionScopes.state),[o]),S=(0,a.VK)((()=>o.normalizedFormatStore.state),[o]),f=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),y=(0,a.VK)((()=>r.state),[r]);let v=S[t]||[];if(y){let e=v.map((e=>{const t=(0,u.Qm)({schema:f,property:e.property});return null==t?void 0:t.name}));e=n().filter(y,e).map((e=>{let{original:t}=e;return t})),v=v.filter((t=>{const o=f[t.property];return o&&o.name&&e.includes(o.name)}))}const h=v.filter((e=>Boolean(e.visible))),w=v.filter((e=>!Boolean(e.visible))),_=(0,a.VK)((()=>"timeline_table_properties"===t?"table":(0,E.WY)({collectionContextStore:o})),[o,t]),j=(0,a.VK)((()=>fe({formatKey:t,properties:h},p,d,o,m,i,r)),[t,h,p,d,o,m,i,r]),M=(0,a.VK)((()=>fe({formatKey:t,properties:w},p,d,o,m,i,r)),[t,w,p,d,o,m,i,r]);return 0===v.length?(0,te.jsx)(R.Z,{children:(0,te.jsx)(K.Z,{caption:(0,te.jsx)(x.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})}):(0,te.jsx)(A.Z,{type:A.i.Vertical,store:c,initialFocus:void 0,sections:b.oA([h.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,te.jsx)(R.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,te.jsx)(le,{viewType:_}),desktopTitleStyle:{height:19},right:!y&&g.canConfigureBlock&&(0,te.jsx)(I.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){C.wd({environment:t,collectionContextStore:o,action:"click_hide_all_properties"}),se({formatKey:e,visibility:!1},o,t)}(t,p,o),children:(0,te.jsx)(x.FormattedMessage,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})}),children:(0,te.jsx)(he,{collectionContextStore:o,inputStore:r,menuListStore:c,formatKey:t,visibleProperties:h,hiddenProperties:w,children:e.children})}),items:b.oA([...j,w.length>0&&{key:"group-header-hidden-property",render:e=>(0,te.jsx)(ve,{collectionContextStore:o,inputStore:r,props:e,formatKey:t,children:(0,te.jsx)(te.Fragment,{})}),action:()=>{}},...M])},0===h.length&&w.length>0&&{key:"hidden_properties",render:e=>(0,te.jsx)(ve,{collectionContextStore:o,inputStore:r,props:e,formatKey:t,children:(0,te.jsx)(he,{formatKey:t,visibleProperties:h,hiddenProperties:w,children:e.children,collectionContextStore:o,inputStore:r,menuListStore:c})}),items:M}])})}},69872:(e,t,o)=>{o.d(t,{L:()=>p,Z:()=>u});o(67294);var i=o(480),n=o(24405),r=o(12396),l=o(98519),a=o(65183),s=o(52275),c=o(28992),d=o(85893);let p=function(e){return e[e.Name=0]="Name",e[e.Type=1]="Type",e}({});const u=function(e){const{propertySchema:t,format:o,locked:u}=e,m=(0,n.Fg)(),g=(0,i.O7)(),{name:S,type:f,icon:y}=t,v=o===p.Name?S:a.SO[f];return u?(0,d.jsx)(c.Z,{title:v,icon:(0,d.jsx)(r.ZP,{icon:y,type:f,size:g.device.isMobile?18:16,theme:m,style:{fill:m.regularIconColor}}),...e}):(0,d.jsx)(s.Z,{title:v,icon:(0,d.jsx)(r.ZP,{icon:y,type:f,size:g.device.isMobile?18:16,theme:m,style:{fill:m.regularIconColor,marginLeft:6,marginRight:2}}),right:e.selected?(0,l.k)({width:14,height:14}):null,...e})}},66957:(e,t,o)=>{o.d(t,{Z:()=>p});var i=o(67294),n=o(480),r=o(86628),l=o(24405),a=o(60709),s=o(89728),c=o(85893);function d(e){let{tabs:t,selectedIndex:o,onChange:d,separatorIndexes:p,right:u,style:m,rightStyle:g,tabStyle:S,tabTitleStyle:f,tabBorderStyle:y,selectedTabStyle:v,readOnly:h,hideTabBorder:x}=e;const b=(0,i.useContext)(a.Xp),{device:w,WindowSizeStore:_}=(0,n.O7)(),{safePaddingLeft:C,safePaddingRight:j}=(0,r.VK)((()=>({safePaddingLeft:_.getSafePaddingLeftCSS(16),safePaddingRight:_.getSafePaddingRightCSS(16)})),[_]),M=(0,l.yK)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.mediumTextColor,...S},o=`inset 0 -1px 0 ${e.regularDividerColor}`,i=b.menuType===a.og.Popup,n={fontSize:16,paddingTop:2,paddingLeft:i?16:C,paddingRight:i?16:j,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:x?void 0:o,...w.isMobile?n:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...m},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},mobile:{},tab:t,selectedTab:{...t,position:"relative",color:e.regularTextColor,...v},border:{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:8,right:8,...y},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.mediumTextColor,...g}}}),[b.menuType,w.isMobile,g,C,j,v,m,y,S,x]);return(0,c.jsxs)("div",{className:"hide-scrollbar",style:M.container,children:[t.map(((e,t)=>{const n=t===o;return(0,c.jsxs)(i.Fragment,{children:[(0,c.jsxs)("div",{style:n?M.selectedTab:M.tab,children:[(0,c.jsx)(s.Z,{style:f,onClick:()=>d(t),disabled:h,mobileFeedback:w.isMobile,children:e}),n&&(0,c.jsx)("div",{style:M.border})]},`tabButton-${t}`),p&&p.includes(t)&&(0,c.jsx)("div",{style:M.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),u&&(0,c.jsx)("div",{style:M.rightContainer,children:u})]})}const p=i.memo(d)},36857:(e,t,o)=>{o.d(t,{Z:()=>r});var i=o(49085);class n extends i.default{getInitialState(){return{pageId:void 0}}}const r=new n},12589:(e,t,o)=>{o.d(t,{M:()=>r});o(67294);var i=o(45238),n=o(85893);const r=(0,i.IU)("bolt",{svg:(0,n.jsx)("path",{d:"M4.629 21.418l8.877-11.416c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H7.539l2.91-7.598C10.84.12 9.766-.428 9.131.412L.254 11.818c-.166.215-.254.41-.254.626 0 .38.293.663.703.663h5.518l-2.91 7.588c-.391 1.006.683 1.553 1.318.723zm.576-2.627l3.272-7.139H2.44l6.377-8.466-.273-.147-3.262 7.139h6.026l-6.377 8.467z"}),viewBox:"0 0 14 22"})},62208:(e,t,o)=>{o.d(t,{z:()=>r});o(67294);var i=o(45238),n=o(85893);const r=(0,i.IU)("loop",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M5.80371 3.12305C5.81006 3.50391 6.05762 3.74512 6.47656 3.74512H11.3643C11.9546 3.74512 12.2783 4.0498 12.2783 4.66553V11.2925L11.377 10.3149L10.8628 9.80078C10.5962 9.54688 10.2344 9.52783 9.96777 9.78809C9.71387 10.0483 9.72021 10.4229 9.98047 10.6831L12.145 12.8413C12.6211 13.311 13.167 13.311 13.6431 12.8413L15.8076 10.6831C16.0679 10.4229 16.0742 10.0483 15.8203 9.78809C15.5537 9.52783 15.1919 9.54688 14.9253 9.80078L14.4111 10.3149L13.5161 11.2861V4.56396C13.5161 3.20557 12.8052 2.50098 11.4341 2.50098H6.47656C6.05762 2.50098 5.79736 2.74219 5.80371 3.12305ZM0.186035 7.05859C0.446289 7.3252 0.808105 7.30615 1.07471 7.0459L1.59521 6.53809L2.48389 5.56689V12.2891C2.48389 13.6475 3.19482 14.3521 4.56592 14.3521H9.52344C9.94238 14.3521 10.2026 14.1108 10.1963 13.73C10.1899 13.3428 9.94238 13.1079 9.52344 13.1079H4.64209C4.05176 13.1079 3.72803 12.7969 3.72803 12.1812V5.5542L4.62305 6.53809L5.14355 7.0459C5.40381 7.30615 5.77197 7.3252 6.03223 7.05859C6.29248 6.79834 6.28613 6.43018 6.01953 6.16992L3.85498 4.01172C3.37891 3.53564 2.83936 3.53564 2.36328 4.01172L0.19873 6.16992C-0.0678711 6.43018 -0.0742188 6.79834 0.186035 7.05859Z"})})}}]);