"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2284],{62284:(e,t,n)=>{n.r(t);n(21703),n(57658);var o=n(36769),r=n(41432),a=n(28020),i=n(44534),s=n(63208),c=n(27724),l=n(9953),u=n(42858),d=n(993),m=n(13447);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;m.createAndCommit({userAction:"legacyTransclusionConsoleActions.createLegacyTransclusion",environment:e,perform:n=>{var o,p;const v=c.default.getCurrentRecordCache();if(!v)throw new Error("No in-memory record cache!");if(function(e){const{environment:t,transaction:n}=e,o=s.Z.state;if(!o.isActive)return!1;const{selection:r,simpleTableStore:a}=o,c=i.HM.insertRow({environment:t,index:r.end.row+1,simpleTableStore:a,transaction:n});return l.sW({store:c,data:{parent_id:a.getParentId(),parent_table:a.getParentTable()},transaction:n}),!0}({environment:e,transaction:n}))return;const h=null===(o=a.RM())||void 0===o?void 0:o.pointer.spaceId,g=(null===(p=a.RM())||void 0===p?void 0:p.useCrdt())??!1,b=l.j4({environment:e,type:r.Ti.text,inMemoryRecordCache:v,transaction:n,spaceId:h,useCrdt:g}),y=b.getTitleStore();y&&d.mM({environment:e,store:y,tokens:[['here is a legacy transclusion (a.k.a. "phantom synced block")']],index:0,transaction:n});const C=[];for(let a=0;a<t;a++){const t=l.j4({environment:e,type:r.Ti.numberedList,inMemoryRecordCache:v,transaction:n,spaceId:h,useCrdt:g}),o=t.getBlockTitleStore();d.mM({environment:e,store:o,tokens:[["this block has a legacy transclusion in it"]],index:0,transaction:n});const a=t.getContentStore();m.applyOperation({transaction:n,store:a,operation:{pointer:a.pointer,path:a.path,command:"set",args:[b.id]}}),C.push(t)}u.is({environment:e,blocks:[b,...C],selection:c.default.state.stores,transaction:n,replaceEmptyTextBlock:!1}),n.postSubmitCallbacks.push((e=>{e&&console.log("Submitting legacy transclusion transaction failed! You may need to run the server with the NOTION_DEBUG_DISABLE_LEGACY_TRANSCLUSION_VALIDATION environment variable set to a non-empty value.")}))}})}(0,o.exposeDebugEnvironmentValue)("createLegacyTransclusion",(e=>p.bind(null,e)))}}]);