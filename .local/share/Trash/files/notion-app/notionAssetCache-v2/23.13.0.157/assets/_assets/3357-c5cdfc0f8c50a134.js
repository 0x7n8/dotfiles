"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3357],{83357:(e,t,a)=>{a.d(t,{Hk:()=>f,NV:()=>h,OV:()=>d,h5:()=>p,hi:()=>l,li:()=>y,s8:()=>u,wh:()=>g,x7:()=>b});a(21703);var r=a(47025),o=a(2032),i=a(9291),n=a(53965),s=a(51592),c=a(16187);const l="Not implemented",g=(0,i.defineMessages)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateBy:{defaultMessage:"Aggregate by",id:"database.viewSettings.mainTab.axisChart.aggregateBy"},chartAggregateSection:{defaultMessage:"Aggregate",id:"database.viewSettings.mainTab.axisChart.chartAggregateSection"},chartDistinctSection:{defaultMessage:"Distinct count of",id:"database.viewSettings.mainTab.axisChart.chartDistinctSection"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"}}),d=(0,i.defineMessages)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartHideEmptyGroups:{defaultMessage:"Hide empty groups",id:"database.viewSettings.chartStyleTab.chartHideEmptyGroups"}}),u=(0,i.defineMessages)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),p=(0,i.defineMessages)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),y=(0,i.defineMessages)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),h=(0,i.defineMessages)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}});function f(e){let{aggregation:t,databaseType:a,intl:r}=e;const i=(0,n.kC)((0,s.sN)(a));if((0,o.HK)(t))return r.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:i});if("unique"===t.aggregator)return r.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const e=(0,o.OV)(t);return c.v6[e]}}function b(e){if("column"===e.type||"line"===e.type){const t=(0,r._z)(e.axisConfig);if(!t)return;return"record_count"===t.type?{aggregator:"count"}:{aggregator:t.aggregator,property:t.property}}if("donut"===e.type){const t=e.donutConfig.dataConfig.aggregation;if(!t)return;return"record_count"===t.type?{aggregator:"count"}:{aggregator:t.aggregator,property:t.property}}}},47025:(e,t,a)=>{a.d(t,{BU:()=>A,CT:()=>_,Co:()=>b,II:()=>w,LI:()=>M,PL:()=>T,QJ:()=>m,Ri:()=>l,Xg:()=>y,Xm:()=>h,_z:()=>B,b6:()=>g,fI:()=>v,h_:()=>C,hd:()=>p,iR:()=>d,kJ:()=>u,kT:()=>S,mk:()=>c.mk,qV:()=>x});var r=a(1898),o=a(2032),i=a(14714),n=a(80951),s=a(68626),c=a(7289);const l=["column","bar","line","donut"],g=["blue","yellow","green","purple","red"],d=["auto","colorful","gray"];function u(e,t){switch(e){case"auto":return;case"colorful":return["#2383E2","#DEA128","#4FAA79","#9065CC","#00A1C0","#E17634","#D25390","#D44C47"];case"gray":return[t.accentColors.gray[500],t.accentColors.gray[400],t.accentColors.gray[300],t.accentColors.gray[200],t.accentColors.gray[100]];case"blue":return[t.accentColors.uiBlue[600],t.accentColors.uiBlue[500],t.accentColors.uiBlue[400],t.accentColors.uiBlue[300],t.accentColors.uiBlue[200]];case"yellow":return[t.accentColors.yellow[300],t.accentColors.yellow[200],t.accentColors.yellow[100],t.accentColors.yellow[50],t.accentColors.yellow[30]];case"green":return[t.accentColors.green[500],t.accentColors.green[400],t.accentColors.green[300],t.accentColors.green[200],t.accentColors.green[100]];case"purple":return[t.accentColors.purple[500],t.accentColors.purple[400],t.accentColors.purple[300],t.accentColors.purple[200],t.accentColors.purple[100]];case"red":return[t.accentColors.red[500],t.accentColors.red[400],t.accentColors.red[300],t.accentColors.red[200],t.accentColors.red[100]];default:(0,r.t1)(e)}}let p=function(e){return e.manual="manual",e.yAscending="y-ascending",e.yDescending="y-descending",e.xAscending="x-ascending",e.xDescending="x-descending",e}({}),y=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),h=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({});const f=["date","created_time","last_edited_time","last_visited_time","relation","status","select","multi_select","number","title","text","url","email","phone_number","checkbox","person","created_by","last_edited_by"];function b(e){return f.includes(e)}function m(e){if(!e)return!1;return i.vu.includes(e)}function C(e){if(!e)return!1;return i.z8.includes(e)}function S(e){let{collectionSchema:t}=e;return Object.keys(t).filter((e=>{const a=(0,n.Qm)({schema:t,property:e});return!!a&&b(a.type)}))[0]}function v(e){let{property:t,collectionSchema:a}=e;const o=(0,n.Qm)({schema:a,property:t});if(o&&b(o.type))return(0,i.A1)(o.type)?{type:o.type,property:t,groupBy:"day",sort:{type:"ascending"}}:"relation"===o.type||"select"===o.type||"multi_select"===o.type?{type:o.type,property:t,sort:{type:"ascending"}}:"status"===o.type?{type:o.type,property:t,groupBy:"group",sort:{type:"ascending"}}:"number"===o.type?{type:o.type,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}:(0,i.HB)(o.type)||"checkbox"===o.type||(0,i.pd)(o.type)?{type:o.type,property:t,groupBy:{type:"unique"},sort:{type:"ascending"}}:void(0,r.t1)(o.type)}function x(e){let{property:t,propertySchema:a,groupByOption:r}=e;const o=a.type;if((0,c.mk)(o))if((0,i.A1)(o)){if(r&&C(r))return{type:o,property:t,groupBy:r,sort:{type:"ascending"}}}else{if((0,i.zb)(o)||"select"===o||"multi_select"===o)return{type:o,property:t,sort:{type:"ascending"}};if((0,i.H1)(o)){if(r&&m(r))return{type:o,property:t,groupBy:r,sort:{type:"ascending"}}}else{if("number"===o)return{type:o,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("person"===o)return{type:o,property:t,sort:{type:"manual"}}}}}function _(e){return"status"===e.type||"multi_select"===e.type||"select"===e.type||"relation"===e.type||"number"===e.type||"date"===e.type||"person"===e.type}function T(e){return(0,i.ib)(e)||(0,i.TD)(e)?e.groupBy:void 0}function w(e){let{collectionSchema:t,property:a}=e;const r=(0,n.Qm)({schema:t,property:a});if(!r)return[];const o=r.type;return(0,c.mk)(o)?"number"===o?[{aggregator:"count"},{aggregator:"sum",property:a},{aggregator:"average",property:a},{aggregator:"min",property:a},{aggregator:"max",property:a},{aggregator:"median",property:a}]:[{aggregator:"count"}]:[]}function M(e){let{collectionSchema:t,collectionViewFormat:a}=e;const r=(0,c.K0)({collectionSchema:t});if(!r)return{chartConfig:void 0,chartError:{type:"fixable",error:"no_valid_properties_in_schema"}};if(!a.chart_config)return{chartConfig:r,chartError:void 0};const{chartConfig:o,chartError:i}=function(e){let{chartConfig:t,collectionSchema:a}=e;if("placeholder"===t.type)return{chartConfig:t,chartError:void 0};if("column"===t.type||"line"===t.type){if(void 0===t.axisConfig)return{chartConfig:void 0,chartError:{type:"fixable",error:"dev_data_model_incorrect"}};const e=t.axisConfig.dataConfig.xAxis;if(!e)return{chartConfig:t,chartError:{type:"fixable",error:"no_xAxis_configured"}};const r=(0,n.Qm)({schema:a,property:e.groupBy.property});if(!r)return{chartConfig:t,chartError:{type:"fixable",error:"groupBy_property_deleted_from_schema"}};if(!(0,c.mk)(r.type))return{chartConfig:t,chartError:{type:"fixable",error:"groupBy_property_is_not_groupable"}};const o=w({collectionSchema:a,property:e.groupBy.property}).map((e=>e.aggregator)),i=B(t.axisConfig);return i?"record_count"!==i.type||o.includes("count")?{chartConfig:t,chartError:void 0}:{chartConfig:t,chartError:{type:"fixable",error:"invalid_aggregation"}}:{chartConfig:t,chartError:{type:"fixable",error:"no_yAxis_configured"}}}if("donut"===t.type){if(void 0===t.donutConfig)return{chartConfig:void 0,chartError:{type:"fixable",error:"dev_data_model_incorrect"}};const e=t.donutConfig.dataConfig.groupBy;if(!e)return{chartConfig:t,chartError:{type:"fixable",error:"no_slice_configured"}};const r=(0,n.Qm)({schema:a,property:e.property});if(!r)return{chartConfig:t,chartError:{type:"fixable",error:"groupBy_property_deleted_from_schema"}};if(!b(r.type))return{chartConfig:t,chartError:{type:"fixable",error:"groupBy_property_is_not_groupable"}};return t.donutConfig.dataConfig.aggregation||(t.donutConfig.dataConfig.aggregation=(0,c.kR)({})),{chartConfig:t,chartError:void 0}}return{chartConfig:void 0,chartError:{type:"fixable",error:"dev_data_model_incorrect"}}}({chartConfig:a.chart_config,collectionSchema:t});return i&&s.log({level:"error",from:"CollectionChartView",type:"ChartConfigError",error:{miscDataString:i.type}}),{chartConfig:o??r,chartError:i}}function B(e){const t=null==e?void 0:e.dataConfig.yAxis;if(t&&t[0])return t[0]}function A(e,t){if((0,o.HK)(t))return{type:"record_count",seriesFormat:{displayType:e.seriesFormat.displayType},stackOptions:e.stackOptions};if((0,o.nC)(t)||"unique"===t.aggregator){if("range"===t.aggregator)return;return{type:"property_aggregation",seriesFormat:{displayType:e.seriesFormat.displayType},stackOptions:e.stackOptions,aggregator:t.aggregator,property:t.property}}}}}]);