"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5645],{43328:(e,t,o)=>{o.r(t),o.d(t,{AutomationModal:()=>S});var n=o(67294),r=o(480),i=o(86628),a=o(24405),c=o(2647),l=o(9291),s=o(37810),u=o(68657),d=o(49394),p=o(63474),m=o(58454),f=o(6258),h=o(1743),g=o(50506),x=o(89728),C=o(58297),b=o(31278),y=o(65187),v=o(85893);const k=(0,l.defineMessages)({confirmationDialogAriaLabel:{defaultMessage:"Confirmation",id:"automations.ConfirmationDialog.ariaLabel"}});function S(){const e=(0,i.VK)((()=>m.Z.state),[]),t=(0,r.Fy)(),o=(0,i.VK)((()=>t.isPhone),[t]),l=(0,a.yK)((e=>({innerStyle:{padding:24,width:o?"calc(100% - 20px)":320}})),[o]),s=(0,p.D)(),u=(0,n.useCallback)((e=>{m.Z.setState({open:!1,result:e});const t=m.Z.state;(0,c.W5)(s,{automation_id:t.open&&t.recordStore instanceof f.Mz?t.recordStore.id:void 0,option:e})}),[s]),d=(0,n.useCallback)((()=>u("cancel")),[u]),h=function(){const e=(0,i.VK)((()=>m.Z.state),[]),[t,o]=(0,n.useReducer)(((e,t)=>e+1),1),r=(0,n.useRef)(void 0);return(0,n.useEffect)((()=>{e.open&&e.format!==r.current&&(o(void 0),r.current=e.format)}),[e,r]),t}();return(0,v.jsx)(g.Z,{open:e.open,keepFocus:!0,innerStyle:l.innerStyle,disableAnimation:!0,onDismiss:d,render:()=>e.open&&(0,v.jsx)(M,{id:`${h}`,modalState:e,onDismiss:u},`${h}`)})}function M(e){const{id:t,modalState:o,onDismiss:r}=e,{icon:i}=o.format,c=(0,l.useIntl)(),p=(0,n.useRef)(null);(0,n.useEffect)((()=>{null!==p.current&&p.current.focus()}),[]);const m=(0,a.yK)((e=>({wrap:{display:"flex",flexDirection:"column"},buttonWrap:{display:"flex",flexDirection:"column",gap:10,marginTop:10},textWrap:{whiteSpace:"pre-wrap",wordBreak:"break-word",textAlign:"center",fontWeight:s.Z.fontWeight.medium,marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",alignItems:"center"},icon:{marginBottom:10},cancelButton:{justifyContent:"center"}})),[]),{store:f}=(0,u.Cl)({initialValue:o.format.text,onChange:()=>{}}),g=[(0,v.jsx)(C.Z,{isLarge:!0,onClick:()=>r("continue"),ref:p,children:o.format.continueButtonText},"continue"),(0,v.jsx)(x.Z,{isLarge:!0,onClick:()=>r("cancel"),isLightGray:!0,style:m.cancelButton,children:o.format.cancelButtonText},"cancel")],S=`automation-modal-dialog-${t}`;return(0,v.jsx)(h.Z,{debugName:"AutomationModal",capture:!0,allowEsc:!0,children:(0,v.jsxs)("div",{"aria-modal":"true","aria-label":c.formatMessage(k.confirmationDialogAriaLabel),"aria-describedby":S,role:"dialog",style:m.wrap,children:[(0,v.jsxs)("div",{style:m.textWrap,children:[i&&(0,v.jsx)("div",{style:m.icon,children:(0,v.jsx)(b.Z,{size:50,icon:{icon:i,pointer:o.recordStore.pointer},disabled:!0,isEmptyPage:!1,bucket:"public",onChange:()=>{}})}),(0,v.jsx)("div",{id:S,children:(0,v.jsx)(y.Z,{disabled:!0,store:f,parentStore:o.recordStore,inPageFind:d.B3.none})})]}),(0,v.jsx)("div",{style:m.buttonWrap,children:g})]})})}},68657:(e,t,o)=>{o.d(t,{Cl:()=>p,NY:()=>m});var n=o(67294),r=o(480),i=o(86628),a=o(21202),c=(o(70203),o(53965)),l=o(7032),s=o(84398),u=o(77080),d=o(6258);function p(e){const{initialValue:t,onChange:o,source:u="title",parentCollection:p}=e,m=(0,r.O7)(),f=(0,s.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),h=function(e){const{initialValue:t,inMemoryRecordCache:o,source:i,parentCollection:c}=e,s=(0,r.O7)(),u=(0,n.useMemo)((()=>t),[]);return(0,n.useMemo)((()=>{const e={id:(0,l.ZP)(),table:a.iU};o.setRecord({pointer:e,userId:s.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==c?void 0:c.id)??l._6,parent_table:"block",properties:{[i]:u},space_id:(null==c?void 0:c.getSpaceId())??l._6,type:"page",version:0},role:"editor"});const t=new d.ST({environment:s,inMemoryRecordCache:o,path:["properties",i],pointer:e,userId:s.currentUser.id});return o.emitRecord(e,[]),t}),[s,o,u,c,i])}({initialValue:t,inMemoryRecordCache:f,source:u,parentCollection:p}),g=(0,n.useRef)(t),x=(0,n.useCallback)((e=>{const t=m.currentUser.id,o=h.getRecordStoreAtRootPath();if(o instanceof d.G){const n=o.getValue();n&&(f.setRecord({pointer:h.pointer,userId:t},{role:"editor",value:{...n,properties:{...null==n?void 0:n.properties,[u]:e}}}),f.emitRecord(h.pointer,[]))}}),[m.currentUser.id,h,f,u]);return(0,i.VK)((()=>{const e=h.getValue();c.Xy(g.current,e)||(g.current=e,null==o||o(e))}),[h,o]),{store:h,setValue:x}}function m(){return u.default.checkGate("formula_buttons")}},84398:(e,t,o)=>{o.d(t,{$:()=>a});var n=o(67294),r=o(26263),i=o(480);function a(e,t){const{cacheFallback:o,isMockTextStore:a,isTemporaryData:c,overrideDefaultRecordCache:l}=t??{},s=(0,i.O7)(),{inMemoryRecordCache:u}=s.defaultRecordCache,d=(0,n.useMemo)((()=>{const t=new r.Z({isTemporaryData:Boolean(c),name:e});return t.isMockTextStore=Boolean(a),o&&t.addCacheFallback(o),l&&u.addCacheOverride(t),t}),[o,u,a,c,e,l]);return(0,n.useEffect)((()=>function(){o&&d.removeCacheFallback(o),l&&u.removeCacheOverride(d)}),[o,u,d,l]),d}},58454:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{open:!1}}}const a=new i;(0,r.exposeDebugValue)("AutomationModalStore",a);const c=a}}]);