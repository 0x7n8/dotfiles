"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[167],{50167:(e,t,n)=>{n.r(t);n(57658),n(21703);var r=n(36769),o=n(86433),a=n(35102),i=n(42875),s=n(60310),c=n(24211),l=n(11799),d=n(73360),u=n(45953),p=n(606),g=n(98963),f=n(21202),v=n(6287),m=n(76462),y=n(75246),_=n(19889),h=n(92338),S=(n(53965),n(7032)),b=n(1898),C=n(54642),k=n(13447),w=n(37181),A=n(95477),I=n(74873),R=n(8627),P=n(18752),U=n(96820),M=n(80444),$=n(77080),x=n(88923),F=n(6258),T=n(27724),O=n(7339),B=n(42198),E=n(97638);const N=20;async function q(e,t){const n=(0,S.xP)(t)||t,{inMemoryRecordCache:r,persistedRecordCache:o}=e.defaultRecordCache;let a;for(const i of r.data)if(i.pointer.id===n){console.log(`Found a ${i.pointer.table} record in the in-memory record cache:`,i.model,i.model.__IM_SORRY__getValue());const e=r.checkRecordForTemporaryData(i);if(e&&console.log("The record has been augmented by temporary data:",e),o){const e=await o.get(i.pointer,i.userId);console.log("The record is also in the persisted record cache: ",e)}a=d.mk.fromModel(i.model)}return a||console.log("Alas, no records with the id were found in the in-memory record cache."),a}function j(e,t){return"string"==typeof e&&"string"==typeof t?Object.keys(m.OC).includes(e)?{table:e,id:(0,S.xP)(t)||t}:{table:t,id:(0,S.xP)(e)||e}:"string"!=typeof e||t?"object"==typeof e?e:t:{table:"block",id:(0,S.xP)(e)||e}}function D(e,t){if(t>N)return[];const n=[],r=(null==e?void 0:e.getAutomationStores())??[];n.push(...r.map((e=>K(e))).filter(b.$K));const o=(null==e?void 0:e.getTemplatePageStores())??[];for(const i of o){const e=i.getAutomationStore();if(e){const t=K(e);t&&n.push(t)}n.push(...V(i,t+1))}const a=e.getSchema();for(const i of Object.values(a))if("button"===(null==i?void 0:i.type)&&(0,b.$K)(i.automation_id)){const t=K(F.Mz.createChildStore(e,{id:i.automation_id,spaceId:e.getSpaceId(),table:g.cv}));t&&n.push(t)}return n}function V(e,t){if(t>N)return[];const n=[];{const r=e.getAutomationStore();if(r){const e=K(r);e&&n.push(e)}if(e.isCollectionView()){const r=e.getCollectionStore();r&&n.push(...D(r,t+1))}}const r=e.getContentStores();for(const o of r){const e=o.getAutomationStore();if(e){const t=K(e);t&&n.push(t)}if(o.isCollectionView()){const e=o.getCollectionStore();e&&n.push(...D(e,t+1))}n.push(...V(o,t+1))}return n}function K(e){if(!e)return;const t=(null==e?void 0:e.getActionStores())??[],n=null==e?void 0:e.getCreatedByPointer(),r=(null==n?void 0:n.table)===_.KJ&&(null==e?void 0:e.getRecordModel(n));return r?{automation:e,actions:t,createdBy:r,parent:e.getParentBlockStore()}:void 0}(0,r.exposeDebugEnvironmentValue)("debugging",(function(e){const t=(t,n)=>{var r;const o=j(t,n),a=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:o,userId:e.currentUser.id});if(void 0===(null==a?void 0:a.value))return`${o.table}: ${o.id}`;const i="type"in a.value?a.value.type:o.table;return"name"in(null==a?void 0:a.value)?`${i} ${a.value.id} ${a.value.name}`:"properties"in(null==a?void 0:a.value)&&(0,b.$K)(a.value.properties)&&"title"in a.value.properties&&(0,b.$K)(null==a?void 0:a.value.properties.title)?`${i} ${a.value.id} ${a.value.properties.title.join(" ").slice(0,30)}`:`${i} ${null==a||null===(r=a.value)||void 0===r?void 0:r.id}`},n=(t,n)=>{const r=j(t,n);return e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id})},r=(e,r)=>{const o=j(e,r),a=n(e,r),i={title:t(e,r),raw:null==a?void 0:a.value,parent:void 0,id:o,children:[]};if(void 0!==(null==a?void 0:a.value)&&"parent_table"in(null==a?void 0:a.value)&&"parent_id"in(null==a?void 0:a.value)&&a.value.parent_id){var s,c;const e=j(null===(s=a.value)||void 0===s?void 0:s.parent_id,null===(c=a.value)||void 0===c?void 0:c.parent_table);i.parent=e}if(null!=a&&a.value&&"content"in(null==a?void 0:a.value)){var l;const e=(null==a||null===(l=a.value)||void 0===l?void 0:l.content)||[];for(const r of e){const e=j(r,"block"),a=n(r,"block"),s={title:t(r,"block"),raw:null==a?void 0:a.value,parent:o,id:e,children:[]};i.children.push(s)}}return i},d=(e,t)=>`${A.default.adminUrl}/__admin/${e}/${t}`,S=(e,t)=>{window.open(d(e,t))},F=()=>x.default.state.open?(console.warn("Returning peek view page, if you want the underlying page, please close it and try again"),x.default.state.target):M.default.state.mainEditorCurrentBlockStore?M.default.state.mainEditorCurrentBlockStore:void console.error("No current mainEditorCurrentBlockStore"),N=function(t){var n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;const i="string"==typeof t?{query:{text:t,filters:(0,h.u4)(),sort:{field:"relevance"}},limit:20,debug:r}:t;return{environment:e,input:i,spaceId:null===(n=M.default.state.currentSpaceStore)||void 0===n?void 0:n.id,publicAccessPermissionAncestorBlockId:E.bC(e).publicAccessPermissionAncestorBlockId,searchExperimentOverrides:a,forcedClusterPattern:o,source:"debugging"}},D={id:"root0000-0000",table:"block"},K=t=>{const n=u.PF.create();for(const[r,o]of Object.entries(t)){if(!m.wb(r)||!Array.isArray(o))throw new Error(`Not a table: ${r}. Argument should be like { block: [id1, id2], collection: [...], ... }`);for(const t of o){const o={table:r,id:t},a=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:o,userId:e.currentUser.id});a&&n.setValueAndRole(o,a.value,a.role)}}return n};return{getRecordFromApi:async(t,n)=>{var r,o;const a=j(t,n),i=[];i.push({pointer:a,version:-1});const s=await C.syncRecordValues(e,{requests:i},null===(r=M.default.state.currentUserStore)||void 0===r?void 0:r.id);return"success"===s.type?null===(o=s.data.recordMap[a.table])||void 0===o?void 0:o[a.id]:void 0},getRecordFromCache:n,getAdminUrl:d,getSelectedBlocks:()=>T.default.state.stores,openInAdmin:S,openSelectedBlocksInAdmin:()=>{if(0!==T.default.state.stores.length)return T.default.state.stores.forEach((e=>{S(f.iU,e.id)}));console.error("No selected block")},openCurrentPageCreatorInAdmin:()=>{var e;const t=(()=>{var e,t;const r=null===(e=F())||void 0===e?void 0:e.getCreatedById(),o=null===(t=F())||void 0===t?void 0:t.getCreatedByTable();if(r&&o)return n(r,o);console.error("no created_by_id or created_by_table for this page")})(),r=null==t||null===(e=t.value)||void 0===e?void 0:e.id;r?S(_.KJ,r):console.error("no current page Creator, not opening")},getCurrentPage:F,openCurrentPageInAdmin:()=>{var e;const t=null===(e=F())||void 0===e?void 0:e.id;t?S(f.iU,t):console.error("Not opening")},openCurrentSpaceInAdmin:()=>{M.default.state.currentSpaceStore?S(y.bx,M.default.state.currentSpaceStore.id):console.error("No current space")},quickFind:function(e){const t=N(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0),n=E.MS(t);return n&&n.then((e=>"success"===e.type?e.data:e))},quickFindRequest:function(e){return N(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)},quickFindCollections:async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;const a="string"==typeof t?{query:{text:t,filters:(0,h.u4)(),sort:{field:"relevance"}},limit:20,debug:n}:t,i=M.default.state.currentSpaceStore,{query:s,limit:c}=a;if(!i)return;const l=C.search(e,{type:h.n8.CollectionsInSpace,query:s.text.trim(),spaceId:i.id,limit:c,filters:h.u4({excludeTemplates:!0,requireEditPermissions:!0}),sort:{field:"relevance"},debug:n,searchExperimentOverrides:o,forcedClusterPattern:r}),d=await l;return"success"===d.type?d.data:d},getCurrentPageDetail:()=>{var e;const t=null===(e=F())||void 0===e?void 0:e.id;if(t)return r(t,"block");console.error("Not opening")},getHomeBlockIdsForUser:()=>{var t;const n=null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.id,r=e.currentUser.id;if(n&&r)return(0,s.hH)({spaceId:n,userId:r})},getRecordDetail:r,getRecordTitle:t,getRecordTree:e=>{const r=new l.Z;e.map((e=>{const o=j(e.id,e.table),a=t(e.id,e.table),i=n(e.id,e.table),s={title:a,parent:(e=>{var t;if(void 0!==(null==e||null===(t=e.value)||void 0===t?void 0:t.parent_id))return j(e.value.parent_id,e.value.parent_table)})(i),id:o,raw:null==i?void 0:i.value,children:[]};r.set(o,s)}));const o={title:"root",parent:void 0,id:D,raw:void 0,children:[]};return e.map((e=>{const t=j(e.id,e.table),n=r.get(t);var a;void 0!==(null==n?void 0:n.parent)&&r.has(n.parent)?null===(a=r.get(n.parent))||void 0===a||a.children.push(n):void 0!==n?o.children.push(n):o.children.push({title:"Failed to load Record",parent:void 0,id:t,raw:void 0,children:[]})})),o},overrideStatsigLocalExperiment:(e,t)=>{const n="Failed to override Statsig local experiment";if(!$.default.isStatsigEnabled()||!O.C.isInitialized())return console.error(n),!1;try{return O.C.updateLocalOverrideConfig(e,t),!0}catch(r){return console.error(n),!1}},overrideStatsigLocalFeatureGate:(e,t)=>{const n="Failed to override Statsig local feature gate";if(!$.default.isStatsigEnabled()||!O.C.isInitialized())return console.error(n),!1;try{return O.C.updateLocalOverrideGate(e,t),!0}catch(r){return console.error(n),!1}},removeAllStatsigLocalOverrides:()=>{const e="Failed to remove all Statsig local overrides";if(!$.default.isStatsigEnabled()||!O.C.isInitialized())return console.error(e),!1;try{return O.C.removeAllLocalOverrides(),!0}catch(t){return console.error(e),!1}},getCurrentSpaceId:()=>{var e;return null===(e=F())||void 0===e?void 0:e.getSpaceId()},getCurrentUserId:()=>{var e;return null===(e=M.default.state.currentUserStore)||void 0===e?void 0:e.id},getAutomationsForSelectedBlocks:()=>T.default.state.stores.map((e=>V(e,0))).filter(b.$K),getAutomationsForCurrentPage:()=>{const e=F();if(e)return V(e,0)},debugCompileAutomation:(e,t)=>{const n=F();if(!n)return;const r=n.getRecordModel,s=n.loadRecordModel,l=r({id:e,spaceId:n.getSpaceId(),table:g.cv});if(!l)return;const d=l.getActionPointers().map((e=>r(e))).filter(b.$K);if(d.length!==l.getActionIds().length)return;const u={automationModel:l,actionModels:d,handleDataRequest:(0,a.yf)(r,s),intl:(0,c.vc)(),getRecordModel:r,loadRecordModel:s,userTimeZone:(0,i.r)()};let f;if("button_property"===t){const e=l.getParentPointer();if(e.table!==v.vF)return;f={...u,collectionPointer:p.dr.fromSpaceShardRecordId({id:e.id,spaceId:l.getSpaceId()},v.vF),contextType:t}}else if("button_block"===t){const e=n.getAssociatedCollectionStore();f={...u,collectionPointer:null==e?void 0:e.getSpaceShardedPointer(),contextType:t}}else"event"===t?f={...u,collectionPointer:p.dr.fromSpaceShardRecordId({id:l.getParentPointer().id,spaceId:l.getSpaceId()},v.vF),contextType:t}:"recurrence"===t||"assistant"===t?f={...u,contextType:t}:(0,b.t1)(t);return(0,o.rS)(f)},generateTutorialData:(e,t,n)=>void 0,setHomeTemplatesPersona:e=>{const t=[...I.az.map((e=>({personaValue:{type:"function",persona:e},key:`function - ${e}`}))),...I.ml.map((e=>({personaValue:{type:"space_intent",persona:e},key:`space_intent - ${e}`}))),...I.GK.map((e=>({personaValue:{type:"space_type",persona:e},key:`space_type - ${e}`})))],n=t.find((t=>t.key===e));n?P.Z.setState(n.personaValue):console.error("input must be one of the following values",t.map((e=>e.key)))},setHomeLearnUserType:e=>{const t={isMultiplayer:e.isMultiplayer??!1,isNewAccount:e.isNewAccount??!1,isAdmin:e.isAdmin??!1,persona:e.persona};R.Z.setState(t)},resetQnAOnboarding:()=>{const t=M.default.state.currentUserSettingsStore;t?k.createAndCommit({userAction:"debuggingHelpers.clearQnAOnboarding",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{ai_qna_intro_onboarding_phase:null,last_exposed_to_ai_qna_at:null,qna_reminders_shown_at:null,ai_qna_upsell_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},resetNotionCalendarOnboarding:()=>{const t=M.default.state.currentUserSettingsStore;t?k.createAndCommit({userAction:"debuggingHelpers.clearNotionCalendarOnboarding",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{notion_calendar_launch_modal_phase:null,notion_calendar_launch_modal_dismissed_at:null,seen_open_in_calendar_tooltip:null},transaction:e})}}):console.error("Could not find current user settings")},getAllUserSignals:()=>{var e,t;const n=null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId(),o=null===(t=M.default.state.currentUserStore)||void 0===t?void 0:t.userId;if(!n||!o)return;const a=B.default.getUserSignals({spaceId:n,userId:o});return a?Object.fromEntries(Object.entries(a).map((e=>{let[t,n]=e;return[t,n.map((e=>{let{pageId:t,...n}=e;return{...n,pageId:t,page:r(f.iU,t)}}))]}))):void 0},loadAllUserSignals:()=>{var t,n;const r=null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),o=null===(n=M.default.state.currentUserStore)||void 0===n?void 0:n.userId;r&&o&&B.default.initializeAndLoadAllUserSignals({spaceId:r,userId:o,environment:e})},getLocalSearchableCache:async()=>{const{currentSpaceStore:t,currentSpaceViewStore:n}=M.default.state;if(t){const r=await(0,U.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:n,excludeCurrentPage:!1}),o=new Map;return r.getAllBlocks().forEach((e=>{e.block.source.forEach((t=>{const n=o.get(t)||[];n?o.set(t,[...n,e.block]):o.set(t,[e.block])}))})),{...r,groupedPages:o}}},saveFileFromOpfs:async e=>{const t=await(await(await navigator.storage.getDirectory()).getFileHandle(e)).getFile(),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,n.click()},resetQnAUpsellNudge:()=>{const t=M.default.state.currentUserSettingsStore;t?k.createAndCommit({userAction:"debuggingHelpers.resetQnAUpsellNudge",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{ai_qna_upsell_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},resetNotionAiSidebarNewBadge:()=>{const t=M.default.state.currentUserSettingsStore;t?k.createAndCommit({userAction:"debuggingHelpers.resetNotionAiSidebarNewBadge",environment:e,userId:t.id,perform:e=>{w.d2({userSettingsStore:t,data:{ai_sidebar_item_new_badge_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},createRecordMapWithRole:K,createRecordMap:e=>K(e).toRecordMap(),findId:q.bind(null,e)}}))},74873:(e,t,n)=>{n.d(t,{GK:()=>c,Ju:()=>h,NZ:()=>l,az:()=>i,ml:()=>s});n(57658);var r=n(1898),o=n(80444);const a=10,i=["creative","internal_communication","eng","product_design","project_or_program_management","product","marketing","sales_or_success","support","finance","hr","it_admin","knowledge_management","operations","educator","student"],s=["life","work","school"],c=["singleplayer","multiplayer"];function l(e){let{userPersonaValue:t,userUseCases:n,spaceSurveyData:o}=e;const a=[f(t),...v({userUseCases:n}),...m({spaceSurveyData:o}),y({workspaceType:p()})].filter(r.$K);let i;for(const r of a)i=i?u(i,r):r;return void 0===i?{type:"space_type",persona:"singleplayer"}:i}const d={space_type:0,space_intent:1,function:2};function u(e,t){return d[e.type]>=d[t.type]?e:t}function p(){const{currentSpaceStore:e}=o.default.state,t=null==e?void 0:e.getModel(),n=null==e?void 0:e.getMemberCountFromPublicSpaceData();return t&&n?n<=1?"singleplayer":n<a?"multiplayer_small":"multiplayer":"singleplayer"}const g={student:{type:"function",persona:"student"},educator:{type:"function",persona:"educator"},creative:{type:"function",persona:"creative"},finance:{type:"function",persona:"finance"},internalCommunication:{type:"function",persona:"internal_communication"},projectProgramMgmt:{type:"function",persona:"project_or_program_management"},itAdmin:{type:"function",persona:"it_admin"},knowledgeManagement:{type:"function",persona:"knowledge_management"},marketing:{type:"function",persona:"marketing"},eng:{type:"function",persona:"eng"},programmer:{type:"function",persona:"eng"},hr:{type:"function",persona:"hr"},hr_recruiting:{type:"function",persona:"hr"},product:{type:"function",persona:"product"},product_manager:{type:"function",persona:"product"},productDesign:{type:"function",persona:"product_design"},designer:{type:"function",persona:"product_design"},marketing_sales:{type:"function",persona:"sales_or_success"},sales:{type:"function",persona:"sales_or_success"},support:{type:"function",persona:"support"},customer_support:{type:"function",persona:"support"},operations_hr:{type:"function",persona:"operations"},operations:{type:"function",persona:"operations"},personal:{type:"space_intent",persona:"life"},media:void 0,entrepreneur:void 0,freelancer:void 0,founderCeo:void 0,other:void 0,unfilled:void 0};function f(e){return e?g[e]:void 0}function v(e){let{userUseCases:t}=e;const n=[];for(const o of t??[])switch(o){case"personal_notes_to_dos":n.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":n.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"ai":case"other":continue;default:(0,r.t1)(o)}return n}function m(e){let{spaceSurveyData:t}=e;const n=[],o=function(e){var t;let{spaceSurveyData:n}=e;const o=null==n||null===(t=n.intent)||void 0===t?void 0:t.value;if(o)switch(o){case"personal":case"life":return"life";case"team":case"work":return"work";case"school":return"school";default:(0,r.t1)(o)}}({spaceSurveyData:t});if(o&&n.push({type:"space_intent",persona:o}),null!=t&&t.use_cases)for(const a of t.use_cases.value)switch(a){case"personal_notes_to_dos":n.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":n.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"ai":case"other":continue;default:(0,r.t1)(a)}return n}function y(e){let{workspaceType:t}=e;if(!t)return;return _({workspaceType:t})?{type:"space_type",persona:"multiplayer"}:{type:"space_type",persona:"singleplayer"}}function _(e){let{workspaceType:t}=e;switch(t){case"multiplayer":case"multiplayer_small":return!0;case"singleplayer":return!1;default:(0,r.t1)(t)}}function h(){return _({workspaceType:p()})}},8627:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(49085);class o extends r.default{getInitialState(){}}const a=new o},18752:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(49085);class o extends r.default{getInitialState(){}}const a=new o}}]);