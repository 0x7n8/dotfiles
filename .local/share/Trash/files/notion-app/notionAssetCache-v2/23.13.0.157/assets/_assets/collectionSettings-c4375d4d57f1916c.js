"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8799],{26797:(e,t,o)=>{o.d(t,{Fv:()=>k,JN:()=>b,QG:()=>T,cQ:()=>_,f$:()=>j,fX:()=>M,td:()=>w,xD:()=>V});o(57658);var n=o(30120),i=o(80951),r=o(40506),a=o(53877),s=o(42875),l=o(6287),c=o(53965),d=o(1898),u=o(10906),p=o(95802),g=o(15723),m=o(17746),S=o(6258),f=o(8406),y=o(54569),x=o(75134),h=o(19785),C=o(9953),v=o(993);function b(e){const{environment:t,droppedStores:o,duplicate:c,calendarBy:d,transaction:p,collectionContextStore:g}=e,m=n.ou.fromMillis(e.startOfDay);let S=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,u.Bm)({store:n,collectionContextStore:g});if(n.getParentTable()===l.vF||!t){S=!1;break}h.zw({childStore:n,parentStore:t,transaction:p})||(S=!1)}const x=y.Ab({environment:t,droppedStores:o,duplicate:c,duplicateUseCrdt:"same_as_store",transaction:p,collectionStore:e.collectionStore});for(const n of x){const o=e.collectionStore?e.collectionStore:(0,u.Bm)({store:n,collectionContextStore:g});if(!o)continue;const l=o.getMappedProperty(d),c=n.getPropertyStore(l),x=i.Gl(c.getValue())||a.Lg((0,s.r)()),h=a.c$(x,(0,s.r)()),C=m.toFormat(a.Iq);let v;if("date"===h.type||"datetime"===h.type)v={...h,start_date:C};else{const e=a.NK(h,(0,s.r)());if(!e.end)return;const t={...h,start_date:C},o=a.NK(t,(0,s.r)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(a.Iq);v={...h,start_date:C,end_date:n}}const b=a.c$(v,r.yw(x)||(0,s.r)());y.mp({environment:t,store:n,collectionStore:o,collectionContextStore:g,shouldCoerce:!0,groupsPointer:[],transaction:p,alreadyMovedToCollection:S}),V({environment:t,type:"dateValue",propertyId:l,store:n,transaction:p,dateValue:b}),f.rv({environment:t,collectionContextStore:g,block_id:n.id,property:l,property_type:"date",from:"calendar"})}}function j(e){const{calendarStore:t,direction:o,target:n}=e;t.setState({...t.state,isDragging:!0,target:n,direction:o,temporaryValue:void 0})}function w(e){const{calendarStore:t,x:o,y:l,calendarBy:d}=e,u=t.state;if(u.isDragging){const e=i.Gl(u.target.getPropertyStore(d).getValue());if(!e)return;const S=a.c$(e,(0,s.r)()),f=u.temporaryValue||e,y=a.c$(f,(0,s.r)()),x=[];u.dayStoreMap.forEach(((e,t)=>{x.push({store:e,timestamp:t})}));const h=x.find((e=>{let{store:t}=e;const n=p.C.getRectFromStore(t);return Boolean(n&&g.uh(n,o,l))}));let C;if(h){const e=n.ou.fromMillis(h.timestamp),t=e.endOf("day"),o=e.toFormat(a.Iq);if(S){const i=a.NK(S,(0,s.r)());if(u.direction===m.t.Left)if(n.Xp.fromDateTimes(e,t).contains(i.start))C=S;else{let e;e="datetimerange"===S.type||"daterange"===S.type?{...S,start_date:o,end_date:S.end_date}:"datetime"===S.type?{type:"datetimerange",start_date:o,start_time:S.start_time,end_date:S.start_date,end_time:S.start_time,time_zone:S.time_zone,reminder:S.reminder}:{type:"daterange",start_date:o,end_date:S.start_date,reminder:S.reminder};const t=a.NK(e,(0,s.r)());C=!i.end&&t.start>i.start||i.end&&t.start>i.end?y:e}else if(i.end?n.Xp.fromDateTimes(e,t).contains(i.end):n.Xp.fromDateTimes(e,t).contains(i.start))C=S;else{let e;e="date"===S.type?{...S,type:"daterange",end_date:o}:"datetime"===S.type?{...S,type:"datetimerange",end_date:o,end_time:"00:00"}:{...S,end_date:o};const t=a.NK(e,(0,s.r)());C=t.end&&t.end<t.start?y:e}}}if(C&&!c.Xy(y,C)){const e=a.c$(C,r.yw(f)||(0,s.r)());t.setState({...u,temporaryValue:e})}}}function M(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:i}=e,r=o.state;r.isDragging&&r.temporaryValue&&(V({type:"dateValue",environment:t,dateValue:r.temporaryValue,propertyId:n,store:r.target,transaction:i}),o.setState({...o.state,isDragging:!1}))}function _(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function k(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,u=l.dateRangeStart.state,p=(0,s.r)(),g=l.normalizedQueryStore.state;if(!g||!g.calendar_by)return;const m=(null==r?void 0:r.getMappedProperty(g.calendar_by))??g.calendar_by,S=a.gQ(u,c,p),f=S.startOf("month"),x=S.endOf("month"),h=n.ou.now().startOf("day");let v;return v=n.Xp.fromDateTimes(f,x).contains(h)?a.hT(h.valueOf(),p):a.hT(a.em(u,c,p).valueOf(),p),C.sW({store:o.getPropertiesStore(),data:{[m]:i.d7(v)},transaction:d}),y.mp({environment:t,store:o,collectionStore:r,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d}),o}function V(e){const{environment:t,store:o,propertyId:n,transaction:r}=e;let l;"timestamp"===e.type?l=a.hT(e.timestampMs.valueOf(),(0,s.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=o.getPropertyValue(n),u=i.d7(l);C.sW({store:o.getPropertiesStore(),data:{[n]:u},transaction:r}),x.H({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:u}})}function T(e){const{environment:t,collectionStore:o,calendarBy:n,store:i,insertStores:r,collectionContextStore:a,transaction:s}=e,l=i.getPropertyStore(n).getValue();for(const c of r)y.mp({environment:t,store:c,collectionStore:o,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),v.sO({environment:t,editorMode:"default",store:c.getNormalizedPropertyStore(n),value:l,transaction:s});return r.map((e=>S.G.createChildStore(o,e.pointer)))}},58188:(e,t,o)=>{o.d(t,{Lg:()=>p,N:()=>u,aG:()=>d});var n=o(13493),i=o(29369),r=o(13447),a=o(75330),s=(o(77907),o(30806)),l=o(44496),c=o(80444);o(72711);function d(e){const{environment:t,currentSpaceViewStore:o,...n}=e;if(!o.getModel())return;const i=!(0,l.q)(o)[e.feature];r.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{r.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:i}},transaction:t})}}),(0,s.cY)({environment:t,show:i,...n})}function u(e){let{environment:t,option:o,from:n,userAction:i}=e;const a=c.default.state.currentSpaceViewStore;if(!a)return!1;const l=a.getOnAppStartStore().getValue();return r.createAndCommit({userAction:i,environment:t,perform:e=>{r.applyOperation({store:a,operation:{pointer:a.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,s.BX)({environment:t,oldValue:l,newValue:o,from:n}),!0}function p(e){const{environment:t,selectedStore:o,currentSpaceViewStore:l,collectionContextStore:c}=e,d=c.collectionViewStore(),u=c.collectionStore(),p=c.collectionViewBlockStore();if(!(u&&d&&p&&l))return;const g=l.getTeamsStores(),m=o.table===i.e0?g.indexOf(o)+1:0,S=o.table===i.e0?o.id:void 0;r.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{r.applyOperation({store:d,operation:{pointer:{id:d.id,table:n.np},path:["format","collection_view_source","teamId"],command:"set",args:S},transaction:e}),a.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:d,collectionStore:u,collectionContextStore:c,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,s.Ay)({environment:t,teamId:S,index:m})}},36821:(e,t,o)=>{o.d(t,{KV:()=>E,Rh:()=>Y,U6:()=>G,Wu:()=>J,Xx:()=>H,YD:()=>Q,g9:()=>U,jc:()=>N,m8:()=>$,ys:()=>q,zX:()=>X});var n=o(30120),i=o(15145),r=o(92996),a=o(2647),s=o(99036),l=o(40506),c=o(53877),d=o(98963),u=o(18844),p=o(21202),g=o(6287),m=o(75246),S=o(29369),f=o(39927),y=o(94438),x=o(70203),h=o(7032),C=o(16732),v=o(40663),b=o(93174),j=o(75330),w=o(97978),M=o(33929),_=o(77907),k=o(80444),V=o(6258),T=o(8406),P=o(54642),F=o(26797),Z=o(16956),B=o(5149),I=o(96802),A=o(9953),K=o(21862),O=o(13447),D=o(39865),R=o(37181);const L="week";function H(e){var t;const{environment:o,transaction:n,tasksBlockStore:i,sprintsBlockStore:r}=e,a=null===(t=r.getFormat())||void 0===t?void 0:t.collection_pointer,s=i.getFormat().collection_pointer;a&&s&&z({environment:o,transaction:n,sprintCollectionStore:V.NW.createChildStore(r,a),taskCollectionStore:V.NW.createChildStore(i,s),sprintSettingsConfig:f.iZ})}function z(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:i,taskCollectionStore:r}=e,a=i.getSpaceId(),s=(0,h.ZP)(),l=(0,h.ZP)();A.ae({environment:t,table:d.cv,inMemoryRecordCache:i.inMemoryRecordCache,value:{id:s,parent_id:i.id,parent_table:i.table,alive:!0,space_id:a,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:(0,h.ZP)(),type:"recurrence",recurrence:te(o)},action_ids:[l]},transaction:n}),I.FH({stores:[i],update:{automation_ids:[...i.getFormat().automation_ids??[],s]},transaction:n}),A.ae({environment:t,table:u.Xj,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,value:{id:l,parent_id:s,parent_table:d.cv,type:"complete_sprint",alive:!0,space_id:a,config:{sprint_collection:i.getSpaceShardedPointer(),task_collection:r.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function E(e){const{environment:t,automationStore:o,transaction:n,newDuration:i,currentSprintBlockStore:r}=e;A.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:i},transaction:n}),W({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function U(e){const{environment:t,automationStore:o,transaction:n,newWeekday:i,currentSprintBlockStore:r}=e;A.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[i]},transaction:n}),W({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function N(e){const{environment:t,automationStore:o,transaction:n,newAutocompleteStatus:i,currentSprintBlockStore:r}=e;A.sW({store:o,data:{status:i?"active":"disabled"},transaction:n}),W({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r});const s=o.getParentPointer();if(!s||s.table!==g.vF)return;const l=(0,w.mc)(t),c={automation_id:o.id,automation_actions:[{type:"complete_sprint"}],automation_triggers:[{type:"recurrence"}],collection_id:s.id};i?(0,a.Rt)(l,c):(0,a.ai)(l,c)}function W(e){const{automationStore:t,currentSprintBlockStore:o,transaction:i,environment:a}=e;if(!t.isActive())return;const s=t.getRecurrence();if(!s)return;const c=(0,y.Su)(s);if(!c)return;const d=o.getPropertyValue(r.b0.Dates);if(!d)return;const u=(0,x.nai)(d)[0];if(!u||"daterange"!==u.type)return;const p=u.start_date,{start_date:g,end_date:m}=(0,y.DW)({currentSprintStartDate:p,sprintSchedule:c});A.sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,l.Io)(n.ou.fromISO(g).plus({minutes:1}).toJSDate())},transaction:i}),F.xD({store:o,propertyId:r.b0.Dates,transaction:i,environment:a,type:"dateValue",dateValue:{type:"daterange",start_date:p,end_date:m}})}function G(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;A.sW({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function q(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:a}=await _.deps.AppTemplates.loader(),{environment:s,collectionContextStore:l}=e,{currentSpaceViewStore:c}=k.default.state,d=l.collectionStore(),u=null==d?void 0:d.getParentBlockStore(),g=null==u?void 0:u.getParentStore(),f=null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri,y=f&&(0,v.YB)(a(),f);if(!d||!u||!g||!c||g.table!==m.bx&&g.table!==p.iU&&g.table!==S.e0||!y)return;const x=u.getFormat().app_id,h=x?await P.getCollectionViewBlocksByAppId(s,{spaceId:u.getSpaceId(),appId:x}):void 0,b="success"===(null==h?void 0:h.type)&&h.data.result.length?h.data.result.map((e=>V.G.createChildStore(g,{table:p.iU,id:e.blockId,spaceId:u.getSpaceId()}))):[u];await ee({environment:s,taskCollectionStore:d,executeFn:()=>{O.createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:s,perform:e=>{const t=(0,C.eu)(),a=o.applyFeatures({environment:s,spaceViewStore:c,appParentStore:g,appUri:y.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:b}),d=n.createSprintPage({environment:s,spaceViewStore:c,appParentStore:g,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_settings"}});B.E3({collectionSettingsStore:l.settingsStore}),d&&(K.r({environment:s,store:d,pageVisitSource:i.tY.Create}),T._H({environment:s,collectionContextStore:l,from:"view_settings",property:r.Es.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0}))}})}})}async function $(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:a}=e,{sprintCollectionStore:s,automationContext:l,currentCollectionViewBlockStore:c,sprintCollectionViewBlockStore:d,taskCollectionStore:u,taskCollectionViewBlockStore:g}=n;if(!s||!d||!l)return;const m=g.getSpaceId(),S=[d,...a.map((e=>new V.G(t,{id:e,table:p.iU,spaceId:m})))];c.id===g.id?B.E3({collectionSettingsStore:o.settingsStore}):K.r({environment:t,store:g,pageVisitSource:i.tY.LeaveOrRemove});const{automationActions:f}=await b._1.loader(),{automationStore:y}=l;await ee({environment:t,taskCollectionStore:u,executeFn:()=>{O.createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,perform:e=>{!function(e){const{transaction:t,blocksToDelete:o,environment:n,taskCollectionStore:i,sprintCollectionStore:a}=e;A.sW({store:a,transaction:t,data:{alive:!1}}),Z.E2({environment:n,collectionStore:i,schema:i.getSchema(),property:r.Es.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),D.y8({environment:n,blocks:o,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,blocksToDelete:S,sprintCollectionStore:s,taskCollectionStore:u}),f.disableAutomation({automationStore:y,environment:t,transaction:e}),f.deleteAutomation({automationStore:y,environment:t,transaction:e})}}),T.y9({environment:t,collectionContextStore:o,property_type:"relation",from:"view_settings",property:r.Es.TaskToSprintRelation})}})}function X(e){const{environment:t,userSettingsStore:o}=e;O.createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,perform:e=>{R.d2({userSettingsStore:o,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function Y(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function Q(e){const{environment:t,collectionContextStore:o,currentViewBlockStore:n,taskCollectionViewBlockStore:i}=e,a=o.collectionViewStore();if(!a)return;const s=a.getFormat(),l=a.getRawQuery();O.createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,perform:e=>{if(j.iG({collectionViewStore:a,transaction:e,update:{name:M.default.formatMessage(C.sY.tasksCurrentSprintV2ViewName),query2:{...l,filter:void 0},format:{...s,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:C.Jt,app_config_uri:r.g3,hide_linked_collection_name:!0}}}),n.id===i.id){var t;const o=(null===(t=n.getFormat())||void 0===t?void 0:t.app_uri_map)??{},l=s.app_config_uri;l&&delete o[l],I.FH({stores:[i],update:{app_uri_map:{...o,[r.g3]:a.id}},transaction:e})}}})}function J(e){const{environment:t,sprintSettingsContext:o}=e;if(!o)return;const n=o.sprintCollectionStore;n&&!o.automationContext&&O.createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,perform:e=>{z({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:f.iZ})}})}async function ee(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,i=n.getFormat().app_uri_map,a=r.Es.TaskToSprintRelation,l=n.getSchema(),c=(null==i?void 0:i[a])??a,d=l[c];if(!d||!(0,s.p_)(d))return;const u=null===(t=(0,s.j0)(d))||void 0===t?void 0:t.id;if(!u)return;const p=new Set([c]);Object.entries(l).forEach((e=>{var t;let[o,n]=e;n&&(0,s.p_)(n)&&(null===(t=(0,s.j0)(n))||void 0===t?void 0:t.id)===u&&p.add(o)}));const{serverCommitResult:g}=O.createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,perform:e=>{for(const t of p)Z.E2({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:l,property:t});null==i||delete i[a],i&&I.FH({stores:[n],transaction:e,update:{app_uri_map:i}})}});await g}({environment:o,taskCollectionStore:n}),t()}function te(e){return{frequency:L,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:n.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,c.Sv)(),hour:0,minute:0}}},97877:(e,t,o)=>{o.r(t),o.d(t,{ChartSettingsMain:()=>ns,CollectionSettings:()=>$u,CollectionSettingsButtonOptions:()=>Fp});var n=o(67294),i=o(83355),r=o(480),a=o(86628),s=o(9291),l=o(7032),c=o(36610),d=o(5149),u=o(96802),p=o(13447),g=o(74194),m=o(3386),S=(o(57658),o(30120)),f=o(24405),y=o(41892),x=o(59054),h=o(5336),C=o(69651),v=o(45238),b=o(85893);const j=(0,v.IU)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})});var w=o(37694);const M=(0,v.IU)("database",{viewBox:"0 0 20 20",svg:(0,b.jsx)("path",{d:"M16.25 5v1.25c0 1.381-2.797 2.5-6.25 2.5s-6.25-1.119-6.25-2.5V5c0-1.381 2.797-2.5 6.25-2.5s6.25 1.119 6.25 2.5zM10 14.375c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753V15c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753-1.22.806-3.179 1.378-5.963 1.378zM10 10c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753v1.25c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753C14.742 9.428 12.784 10 10 10z"})});var _=o(84169),k=o(53523);const V=(0,v.IU)("rightArrowEmpty",{viewBox:"0 0 22 18",svg:(0,b.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var T=o(33507),P=o(37612),F=o(37810),Z=o(47307),B=o(95193),I=o(97372),A=o(94166),K=o(64275),O=o(64921);function D(e){const{title:t,icon:o,style:n,children:i,right:r,showCloseButton:a,onClose:s}=e,l=(0,f.Fg)(),c=(0,b.jsx)(O.Z,{onClick:s,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,K.D)({width:14,fill:l.mediumTextColor})});return(0,b.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:l.accentColors.orange[50],borderRadius:6,...n},children:[t&&(0,b.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,b.jsx)("div",{style:{fontWeight:F.Z.fontWeight.medium,flexGrow:1,...F.Z.textOverflowStyle},children:t}),a?c:r]}),i]})}var R=o(92996),L=o(96367),H=o(21202),z=o(39927),E=o(70203),U=o(40470),N=o(1898),W=o(68305),G=o(36821),q=o(6258);function $(e){var t;const{collectionContextStore:o}=e,i=(0,r.O7)(),s=(0,a.VK)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),l=(0,a.VK)((()=>null==s?void 0:s.permissionsContext),[s]),c=(0,a.VK)((()=>{var e;return Boolean(null==s||null===(e=s.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==s||null===(t=s.automationContext)||void 0===t?void 0:t.automationStore]),d=(0,a.VK)((()=>{var e;return o.collectionStore()===(null==s?void 0:s.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==R.g3}),[o,null==s?void 0:s.taskCollectionStore]),[u,g]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(g(void 0),!s)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=s;if(!e||!t)return;const o=t.getSchema(),n=L.qB[R.p$].current.reducer,r=await W.tA(i,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});U.x.isFail(r)||g(r.value.blockIds[0])}()}),[i,s]);const m=(0,a.VK)((()=>{const e=null==s?void 0:s.sprintCollectionViewBlockStore;if(e&&u)return q.G.createChildStore(e,{id:u,table:H.iU,spaceId:e.getSpaceId()})}),[u,null==s?void 0:s.sprintCollectionViewBlockStore]),S=(0,a.VK)((()=>{if(!m)return;const e=m.getPropertyValue(R.b0.Dates);if(!e)return;const t=(0,E.nai)(e)[0];return t&&"daterange"===t.type?t:void 0}),[m]),f=(0,a.VK)((()=>{var e,t,o;if(!s)return;const n=(null===(e=s.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??z.iZ.actionConfig.complete_sprint_action,i=Boolean(null===(t=s.automationContext)||void 0===t?void 0:t.automationStore.isActive()),r=null===(o=s.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??z.iZ.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??z.iZ.recurrenceConfig.weekdays}}}),[s]),y=(0,a.VK)((()=>(0,N.$K)(m)&&(0,N.$K)(f)),[m,f]),x=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.KV({environment:i,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:m,newDuration:e})}})}),[y,m,i,s]),h=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.g9({environment:i,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:m,newWeekday:e})}})}),[y,m,i,s]),C=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&m&&G.jc({environment:i,transaction:t,automationStore:s.automationContext.automationStore,actionStore:s.automationContext.automationActionStore,currentSprintBlockStore:m,newAutocompleteStatus:e})}})}),[y,m,i,s]),v=n.useCallback((e=>{y&&p.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&G.U6({transaction:t,actionStore:s.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[y,i,s]),b=n.useCallback((async()=>{await G.ys({environment:i,collectionContextStore:o})}),[o,i]),j=n.useCallback((async e=>{s&&await G.m8({environment:i,collectionContextStore:o,sprintSettingsContext:s,sprintBoardViewBlockIds:e})}),[o,i,s]),w=n.useCallback((()=>{s&&G.YD({environment:i,collectionContextStore:o,currentViewBlockStore:s.currentCollectionViewBlockStore,taskCollectionViewBlockStore:s.taskCollectionViewBlockStore})}),[o,i,s]);return{sprintSettingsConfig:f,sprintSettingsPermissionsContext:l,turnOnSprints:b,turnOffSprints:j,automaticSprintCompletionEnabled:c,canManageSprintFromThisView:d,currentSprintDateRange:S,manageSprintFromThisView:w,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:y,handleSprintDurationChange:x,handleSprintStartWeekdayChange:h,handleSprintAutoCompleteChange:C,handleSprintRemainingTasksBehaviorChange:v}}}var X=o(52275),Y=o(31945),Q=o(16354),J=o(78140),ee=o(32163),te=o(53437),oe=o(58297),ne=o(72495),ie=o(86825),re=o(75246),ae=o(29369),se=o(54642),le=o(40663),ce=o(77907);const de="https://www.notion.so/help/sprints",ue=[1,2,3,4,5,6,7,8],pe={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},ge={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},me=(0,s.defineMessages)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),Se={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:me.completeSprintNextSprintActionMenuOptionText,selectedText:me.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:me.completeSprintBacklogActionMenuOptionText,selectedText:me.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:me.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:me.completeSprintKeepInCurrentSprintActionSelectedText}};function fe(e){return(0,b.jsx)(s.FormattedMessage,{...Se[e.completeSprintAction].menuOptionText})}function ye(e){return(0,b.jsx)(s.FormattedMessage,{...Se[e.completeSprintAction].selectedText})}function xe(e){const{weekday:t}=e;return(0,b.jsx)(s.FormattedMessage,{...me.weekdayOption,values:{weekdayName:ge[t]}})}function he(e){return pe[e]}function Ce(e){const{sprintDurationValue:t}=e;return(0,b.jsx)(s.FormattedMessage,{...me.durationMenuOptionText,values:{durationValue:pe[t].value}})}function ve(e){const{numOfSprintBoards:t}=e;return t>0?(0,b.jsx)(s.FormattedMessage,{...me.turnOffSprintsModalWithSprintBoardsDescription}):(0,b.jsx)(s.FormattedMessage,{...me.turnOffSprintsModalNoSprintBoardsDescription})}function be(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,b.jsx)(s.FormattedMessage,{...me.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,b.jsx)(s.FormattedMessage,{...me.manageSprintFromThisViewModalManualSprintCompletionDescription})}function je(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,{sprintSettingsConfig:n,currentSprintDateRange:i,sprintSettingsPermissionsContext:r,sprintSettingsConfigUpdater:a,turnOffSprints:s,turnOnSprints:l,automaticSprintCompletionEnabled:c,canManageSprintFromThisView:d,manageSprintFromThisView:u}=$({collectionContextStore:t,collectionSettingsStore:o});if(!r||!r.canEdit||!n)return null;let p;return p=r.sprintsEnabled?(0,b.jsx)(we,{...e,updateSprintSettingsConfig:a,onTurnOffSprints:s,automaticSprintCompletionEnabled:c,currentSprintDateRange:i,canManageSprintFromThisView:d,onManageSprintFromThisView:u,sprintSettingsConfig:n}):(0,b.jsx)(Me,{...e,onTurnOnSprints:l}),p}function we(e){const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:n,canManageSprintFromThisView:i,updateSprintSettingsConfig:r,collectionContextStore:a,onTurnOffSprints:l,onManageSprintFromThisView:c}=e,d=Re(),u=[];return u.push((0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.Z,{topBorder:!0,disableMobileBorders:!0,children:[i&&(0,b.jsx)(Ze,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:c}),(0,b.jsx)(Fe,{turnOffSprints:l,collectionContextStore:a})]},"turn-off-sprints-section"),(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(Q.Z,{href:de,external:!0,children:(0,b.jsx)(A.Z,{icon:_.m,iconStyle:d.icon,title:(0,b.jsx)(s.FormattedMessage,{...me.learnSprintsTitle}),isGray:!0})})})]})),(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...me.sprintsMenuTitle}),footer:u,children:[(0,b.jsx)(_e,{automaticSprintCompletionEnabled:o,currentSprintDateRange:n}),(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(Ie,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,b.jsx)(Ae,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,b.jsx)(Ke,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(Be,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function Me(e){const{onTurnOnSprints:t}=e,o=Re(),n=[];return n.push((0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:o.buttonWrap,children:(0,b.jsx)(oe.Z,{style:o.button,onClick:async()=>{await t()},isLarge:!0,children:(0,b.jsx)(s.FormattedMessage,{...me.turnOnSprints})})})},"turn-on-sprints-section")),(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...me.setupSprintsTitle}),footer:n,children:(0,b.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,b.jsx)(ke,{}),(0,b.jsx)(Ve,{}),(0,b.jsx)(Te,{})]})})}function _e(e){const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,n=Re();if(!o)return null;const i=S.ou.fromISO(o.end_date).plus({days:1});return(0,b.jsx)(D,{style:n.sprintStartDateHeader,children:(0,b.jsxs)("div",{style:n.sprintStartDateHeaderWrap,children:[V(n.sprintStartDateHeaderIcon),(0,b.jsx)(De,{nextSprintStartDate:i,automaticSprintCompletionEnabled:t})]})})}function ke(){const e=Re();return(0,b.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,b.jsx)(s.FormattedMessage,{...me.setupSprintsCaption})})}function Ve(){const e=Re();return(0,b.jsx)("div",{style:e.mediaWrap,children:(0,b.jsx)("img",{src:y.Z.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function Te(){const e=Re(),t=t=>(0,b.jsx)("span",{style:e.boldText,children:t});return(0,b.jsxs)("div",{style:e.disclaimerWrap,children:[(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.setupSprintsTeamspaceStatement})}),(0,b.jsx)(Pe,{text:(0,b.jsx)(s.FormattedMessage,{...me.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:T.L}),(0,b.jsx)(Pe,{text:(0,b.jsx)(s.FormattedMessage,{...me.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:M})]})}function Pe(e){const{text:t,icon:o}=e,n=Re();return(0,b.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,b.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,b.jsx)("div",{children:t})]})}function Fe(e){const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,r.O7)(),i=(0,a.VK)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:l}]=(0,x.r5)((async()=>{if(null==i||!i.taskCollectionStore||null==i||!i.taskCollectionViewBlockStore)return;const e=await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await ce.deps.AppTemplates.loader(),a=i.getSpaceId(),s=i.getParentStore(),l=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=l&&(0,le.YB)(r(),l);if(!s||s.table!==re.bx&&s.table!==H.iU&&s.table!==ae.e0||!c)return;const d=await se.getSprintBoardViewBlocks(o,{spaceId:a,taskCollectionId:n.id,parentId:s.id,parentTable:s.table});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:i.taskCollectionStore,collectionViewBlockStore:i.taskCollectionViewBlockStore});return e}),[n,null==i?void 0:i.taskCollectionStore,null==i?void 0:i.taskCollectionViewBlockStore]),c=Re();return(0,b.jsx)(A.Z,{icon:P.y,title:(0,b.jsx)(s.FormattedMessage,{...me.turnOffSprints}),isRed:!0,iconStyle:c.icon,onClick:()=>{Z.showDialog({description:(0,b.jsx)(ve,{numOfSprintBoards:l?l.length:0}),message:(0,b.jsx)("div",{style:c.modalTitle,children:(0,b.jsx)(s.FormattedMessage,{...me.turnOffSprintsModalTitle})}),innerStyle:c.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,b.jsx)(s.FormattedMessage,{...me.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(l??[])}}]})}})}function Ze(e){const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=Re();return(0,b.jsx)(A.Z,{icon:w.u,title:(0,b.jsx)(s.FormattedMessage,{...me.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{Z.showDialog({description:(0,b.jsx)(be,{automaticSprintCompletionEnabled:t}),message:(0,b.jsx)("div",{style:n.modalTitle,children:(0,b.jsx)(s.FormattedMessage,{...me.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,b.jsx)(s.FormattedMessage,{...me.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function Be(e){const{onChange:t,sprintSettingsConfig:o}=e,n=Re();return(0,b.jsx)(ie.Z,{title:(0,b.jsx)(s.FormattedMessage,{...me.automatedSprintsToggleTitle}),caption:(0,b.jsx)(s.FormattedMessage,{...me.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,k.N)(n.icon),shouldWrapCaption:!0})}function Ie(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=he(o.recurrenceConfig.interval),r=ue.map((e=>he(e)));return(0,b.jsx)(Oe,{title:(0,b.jsx)(s.FormattedMessage,{...me.duration}),right:(0,b.jsx)(Ce,{sprintDurationValue:i.value}),icon:h.r,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,b.jsx)(X.Z,{...e,disabled:n,title:(0,b.jsx)(Ce,{sprintDurationValue:o.value}),checkState:o.key===i.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function Ae(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,b.jsx)(Oe,{title:(0,b.jsx)(s.FormattedMessage,{...me.startOn}),icon:C.C,right:(0,b.jsx)(xe,{weekday:i}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,b.jsx)(X.Z,{...e,disabled:n,title:(0,b.jsx)(xe,{weekday:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Ke(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,b.jsx)(Oe,{title:(0,b.jsx)(s.FormattedMessage,{...me.incompleteTasks}),right:(0,b.jsx)(ye,{completeSprintAction:i}),icon:j,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,b.jsx)(X.Z,{...e,disabled:n,title:(0,b.jsx)(fe,{completeSprintAction:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Oe(e){const{getMenuItems:t}=e,o=(0,r.Fy)(),n=Re(),i=(0,B.F)({width:250});return(0,b.jsx)(Y.ZP,{popupType:o.isMobile?te.kQ.SlideUp:te.kQ.Popup,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,renderOrigin:t=>(0,b.jsx)(A.Z,{...e,iconStyle:n.icon,...t}),render:e=>(0,b.jsx)(J.Z,{...i,children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,sections:[{key:0,render:e=>(0,b.jsx)(ne.Z,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function De(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,n=S.ou.local().startOf("day"),i=t.diff(n,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),a=e=>(0,b.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===i?(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.sprintStartDateToday,values:{time:a}})}):(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.sprintStartDateFuture,values:{time:a,days:i,formattedDate:r}})}):i<0?(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.sprintStartDateShouldStartPast,values:{time:a,days:Math.abs(i),formattedDate:r}})}):0===i?(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.sprintStartDateShouldStartToday,values:{time:a}})}):(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...me.sprintStartDateShouldStartFuture,values:{time:a,days:i,formattedDate:r}})})}function Re(){const e=(0,r.Fy)();return(0,f.yK)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:t.mediumTextColor,fontWeight:F.Z.fontWeight.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop,color:t.mediumTextColor,fontWeight:F.Z.fontWeight.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.lightIconColor,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:F.Z.fontWeight.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",height:116,border:`1px solid ${t.accentColors.washGlass[0]}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:F.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:F.Z.fontWeight.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.mediumTextColor},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var Le=o(68785);const He=ce.deps.databaseAutomations,ze=(0,ce.lazyComponent)(He,(e=>e.CollectionSettingsCreateAutomationView)),Ee=(0,ce.lazyComponent)(He,(e=>e.CollectionSettingsEditAutomationView));function Ue(e){return(0,b.jsx)(ze,{...e,renderLoading:t=>(0,b.jsx)(I.ZP,{collectionSettingsStore:e.collectionSettingsStore,fullHeight:!0,children:t&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,b.jsx)(Le.Z,{})})})})}function Ne(e){return(0,b.jsx)(Ee,{...e,renderLoading:t=>(0,b.jsx)(I.ZP,{collectionSettingsStore:e.collectionSettingsStore,fullHeight:!0,children:t&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,b.jsx)(Le.Z,{})})})})}const We=ce.deps.databaseAutomations,Ge=(0,ce.lazyComponent)(We,(e=>e.CollectionSettingsAutomationsView));var qe=o(24039),$e=o(12534),Xe=o(34859),Ye=o(58421),Qe=o(77080),Je=o(36857),et=(o(52262),o(24506),o(1302)),tt=o(39132),ot=o(61061),nt=o(44495),it=o(95371),rt=o(16956),at=o(30188),st=o(51592),lt=o(10906),ct=o(61519),dt=o(64369),ut=o(66890),pt=o(97978),gt=o(97004);var mt=o(77181),St=o(81166),ft=o(29376),yt=o(5971),xt=o(61766),ht=o(18533),Ct=o(84242),vt=o(8505),bt=o(5210);function jt(e){const{propertyName:t,newDesign:o,subitemsDisplayMode:n,inversePropertyName:i}=e,r=(0,f.yK)((e=>({togglePreviewParentIcon:{color:e.regularIconColor},togglePreviewChildIcon:{color:e.mediumIconColor,marginLeft:"24px"},togglePreviewRowWithDivider:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`},togglePreviewRow:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center"},togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",...o?{fontWeight:F.Z.fontWeight.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}:{}},parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.lightTextColor,fontWeight:F.Z.fontWeight.medium,fontSize:F.Z.fontSize.UISmall.desktop,whiteSpace:"nowrap"},subItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},subItemWrapper:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},numSubitemsSpan:{color:e.lightTextColor,fontWeight:F.Z.fontWeight.medium,fontSize:F.Z.fontSize.UISmall.desktop}})),[o]),a=(0,b.jsx)("span",{children:"🐔"}),s=(0,b.jsx)("span",{children:"🐣"}),l={show:[a,s,s],hidden:[a,(0,b.jsx)("span",{children:"🐮"}),(0,b.jsx)("span",{children:"🐷"})],flattened:[a,s,s]},c={show:[i,t,t],hidden:[i,i,i],flattened:[i,t,t]};function d(e){return(0,b.jsxs)("span",{style:r.subItemWrapper,children:[(0,vt.S)(r.subItemIcon),(0,b.jsx)("span",{style:r.numSubitemsSpan,children:e})]})}function u(){return(0,b.jsxs)("span",{style:r.parentWrapper,children:[(0,Ct.v)(r.parentItemIcon),(0,b.jsx)("span",{style:r.parentTitle,children:i})]})}function p(e,t,o){return(0,b.jsxs)("div",{style:2===t?{...r.togglePreviewRow}:{...r.togglePreviewRowWithDivider},children:["show"===e&&(0,b.jsx)(bt.Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:0===t?r.togglePreviewParentIcon:r.togglePreviewChildIcon,disabled:!0}),(n=c[e][t],i=l[e][t],(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("span",{style:{marginRight:"5px"},children:[" ",i]}),n]})),o]});var n,i}function g(e){return"flattened"===e?(0,b.jsxs)(b.Fragment,{children:[p(e,0),p(e,1,u()),p(e,2,u())]}):"hidden"===e?(0,b.jsxs)(b.Fragment,{children:[p(e,0,d(2)),p(e,1),p(e,2,d(1))]}):(0,b.jsxs)(b.Fragment,{children:[p("show",0),p("show",1),p("show",2)]})}return m=n,(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:r.togglePreviewOutsideBorder,children:g(m)})})});var m}var wt=o(22491),Mt=o(53965),_t=o(4430),kt=o(43350);o(21703);class Vt{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>Vt.timestep?(t-=Vt.timestep,e=Vt.timestep):(e=t,t=0);const[o,n]=this.rk4(this.currentValue,this.velocity,e);this.velocity=n,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){var n=e,i=t,r=this.computeAccel(n,i,0),a=e+.5*i*o,s=t+.5*r*o,l=this.computeAccel(a,s,o/2),c=e+.5*s*o,d=t+.5*l*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(i+2*s+2*d+g),t+o/6*(r+2*l+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*Vt.stiffnessMultiplier*(this.endValue-e)-this.damping*Vt.dampingMultiplier*t}}Vt.stiffnessMultiplier=1e-5,Vt.dampingMultiplier=.005,Vt.timestep=1e3/60;const Tt=Vt;function*Pt(e,t){const o=new Tt;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*Ft(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*Zt(e){for(const[t,o]of Mt.$R(e,e.slice(1)))(0,N.$K)(t)&&(0,N.$K)(o)&&(yield*Pt(t,o))}function*Bt(e,t){let o=0;for(;!(0,N.$K)(t)||o<t;){o+=(yield e)}}function*It(e){let t=0;for(;;){const o={};for(const n of(0,N.Yd)(e)){const i=e[n].next(t);if(i.done)return;o[n]=i.value}t=yield o}}var At=o(28267);const Kt="inactive-task-filter",Ot="active-task-filter",Dt="mouse-cursor-filter",Rt=80,Lt=24,Ht=8,zt=10,Et=264,Ut=110,Nt=Rt/2;function*Wt(e){yield*It({x:e,opacity:Bt(1)})}function Gt(e){const{mode:t}=e,o=(0,f.yK)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:Ut+2}})),[1]),i=(0,n.useRef)(null),r=(0,At.X)(i),a=r?r.width-2:Et;return(0,b.jsx)("div",{style:o.wrap,ref:i,children:(0,b.jsx)(qt,{mode:t,sceneWidth:a})})}function qt(e){const{mode:t,sceneWidth:o}=e,i=(0,f.yK)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:_t.lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),r=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*Wt(Zt([o/2,o/2+Rt/2+Rt/4,o/2-Rt/2-Rt/4,o/2]))},preserve_gap:function*(){for(;;)yield*Wt(Zt([o/2,o/2+Rt/2,o/2-Rt/2,o/2]))},consume_gap:function*(){for(;;){yield*Wt(Zt([o/2,o/2-Rt/2,o/2+Rt/2,o/2+Rt]));const e=500;yield*It({x:Bt(o/2+Rt),opacity:Ft(1,0,e)}),yield*It({x:Bt(o/2),opacity:Ft(0,1,e)})}}})),[o]),{x:a,opacity:s}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),a=r-o;o=r;const s=t.next(a);s.done||i(s.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(r[t??"none"]),l={x:o/2-2*Rt,y:zt},c={x:a-Rt/2,y:zt+Lt+Ht},d={x:o/2+Rt,y:zt+2*(Lt+Ht)},u={x:c.x+Rt/2,y:c.y+Lt/2};return(0,N.$K)(t)&&("consume_gap"===t?(l.x=Math.min(l.x,c.x-Rt),d.x=Math.max(d.x,c.x+Rt)):"preserve_gap"===t?(l.x=l.x+a-o/2,d.x=d.x+a-o/2):(0,N.t1)(t)),(0,b.jsxs)("svg",{style:i.svgContainer,children:[Mt.w6(o/2-2*Rt,o,Nt).map(((e,t)=>(0,b.jsx)(Xt,{startPoint:{x:e,y:0},endPoint:{x:e,y:Ut}},t))),(0,b.jsx)(kt.Z,{startPoint:{x:c.x+Rt,y:c.y+Lt/2},endPoint:{x:d.x-2,y:d.y+Lt/2},...(0,wt.iv)(i.svgArrowTheme,c.x+Rt>d.x?i.invalidArrow:void 0,{opacity:s}),showArrowHead:!0}),(0,b.jsx)(kt.Z,{startPoint:{x:l.x+Rt,y:l.y+Lt/2},endPoint:{x:c.x-2,y:c.y+Lt/2},...(0,wt.iv)(i.svgArrowTheme,c.x<l.x+Rt?i.invalidArrow:void 0,{opacity:s}),showArrowHead:!0}),(0,b.jsx)($t,{point:l,opacity:s}),(0,b.jsx)($t,{point:c,active:!0,opacity:s}),(0,b.jsx)($t,{point:d,opacity:s}),(0,b.jsx)(Yt,{point:u,opacity:s}),(0,b.jsx)(Qt,{})]})}function $t(e){const{point:t,active:o,opacity:n}=e,i=(0,f.Fg)(),r=o?"dark"===i.mode?"#28456C":"#E7F3F8":i.buttonBackground;return(0,b.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,b.jsx)("rect",{filter:`url(#${o?Ot:Kt})`,width:Rt,height:Lt,x:"4",y:"2",fill:r,rx:"3"})})}function Xt(e){const{startPoint:t,endPoint:o}=e,n=(0,f.Fg)(),i="dark"===n.mode?n.accentColors.gray[300]:"#E3E2E0";return(0,b.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:i,strokeDasharray:"3 4"})}function Yt(e){const{point:t,opacity:o}=e;return(0,b.jsxs)("g",{filter:`url(#${Dt})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,b.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,b.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function Qt(){return(0,b.jsxs)("defs",{children:[(0,b.jsxs)("filter",{id:Kt,width:Rt+8,height:Lt+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,b.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,b.jsx)("feOffset",{}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feOffset",{dy:"2"}),(0,b.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,b.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,b.jsxs)("filter",{id:Ot,width:Rt+8,height:Lt+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,b.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,b.jsx)("feOffset",{}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,b.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feOffset",{dy:"2"}),(0,b.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,b.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,b.jsxs)("filter",{id:Dt,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,b.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feOffset",{dy:"2"}),(0,b.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,b.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,b.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}var Jt=o(99036),eo=o(52936),to=o(18442),oo=o(15828),no=o(8406),io=o(9953),ro=o(75330),ao=o(92607),so=o(60709),lo=o(43261),co=o.n(lo),uo=o(6695),po=o(56666),go=o(73657),mo=o(68894),So=o(69872),fo=o(65183),yo=o(33929),xo=o(29798);const ho=2,Co=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function vo(e){const{currentProperty:t,getGroupedProperties:o,onAccept:i,renderProperty:l,inputPlaceholder:c,schema:d,format:u,defaultShowPropertyGroupCount:p}=e,g=(0,r.Fy)(),m=(0,a.qz)(void 0,xo.Z),S=(0,a.VK)((()=>o()),[o]),[y,x]=(0,n.useState)(!1),[h,C]=(0,n.useState)(""),v=(0,uo.iB)(u,d,void 0,uo.j5.Page).collection_page_properties||[],j=(0,n.useCallback)((e=>{C(e.target.value),m.setState({...m.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),x(!1)}),[m]),w=(0,f.yK)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),M=Mt.MR(S,(e=>Math.min(...e.map((e=>v.findIndex((t=>t.property===e))))))),_=[{key:"input",comp:(0,b.jsx)(ne.Z,{children:(0,b.jsx)(mo.ZP,{focusInitial:!g.isMobile||void 0,focus:!g.isMobile||void 0,value:h,onChange:j,placeholder:c||yo.default.formatMessage(Co.inputPlaceholder)})})}];if(h){const e=M.map((e=>e.filter((e=>{const t=d[e],o=t?`${t.name} ${fo.SO[t.type]}`:"";return Boolean(co().match(h,o))})))).filter((e=>e.length>0));if(0===e.length)_.push({key:"noResults",comp:(0,b.jsx)(go.Z,{caption:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,b.jsx)(ne.Z,{...e}),items:e.flat().map((e=>jo({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:l}))).filter(N.$K)}];_.push(bo({sections:o,menuListStore:m}))}}else{const e=p||ho;let o,n;if(!y&&M.length>e){o=M.slice(0,e);const t=Mt.Sm(M.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,b.jsx)(X.Z,{...e,icon:(0,po.o)(w.dotsIcon),style:w.showMoreButton,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{x(!0)}}}else o=M;const r=o.map(((e,r)=>({key:e.join("-"),render:e=>(0,b.jsx)(ne.Z,{...e,topBorder:0!==r}),items:e.map((e=>jo({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:l}))).concat(r===o.length-1?[n]:[]).filter(N.$K)})));_.push(bo({sections:r,menuListStore:m}))}return(0,b.jsx)(b.Fragment,{children:_.map((e=>{let{key:t,comp:o}=e;return(0,b.jsx)(n.Fragment,{children:o},t)}))})}function bo(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:o,store:t})}}function jo(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,a=t[r];if(!a)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,a):(0,b.jsx)(So.Z,{...e,propertySchema:a,format:So.L.Name,checkState:t})},action:()=>{n(r)}}}var wo=o(57410),Mo=o(98519);function _o(e){const{menuProps:t,property:o,defaultProperty:n,checkState:i,propertySchema:s,collectionContextStore:l,handleDefaultPropertySelect:c,handlePropertySelect:d,...u}=e,p=((0,r.MO)(),(0,a.VK)((()=>l.permissionScopes.state),[l]));return(0,b.jsx)(So.Z,{...t,disabled:!p.canConfigureBlock,propertySchema:s,format:So.L.Name,onClick:()=>c(o),right:(0,b.jsx)(ko,{property:o,checkState:o===n,collectionContextStore:l,defaultProperty:void 0})})}function ko(e){const{property:t,defaultProperty:o,checkState:n,collectionContextStore:i}=e,l=(0,r.MO)(),c=(0,a.VK)((()=>{var e;return null===(e=i.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[i]),d=(0,f.yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,b.jsx)("div",{style:{...d.defaultText},children:t===o&&(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:c}})}),n&&(0,b.jsx)("div",{style:{...l?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:l?16:14,flexShrink:0},children:(0,Mo.k)()})]})}var Vo=o(31869),To=o(29657);function Po(e){const{collectionContextStore:t,feature:o}=e,n=(0,s.useIntl)();return{initialPropertyName:(0,a.VK)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return ft.m8(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function Fo(e){const{feature:t,collectionContextStore:o,onPropertySelect:i}=e,l=(0,r.O7)(),c=(0,s.useIntl)(),{initialPropertyName:d}=Po({collectionContextStore:o,feature:t}),g=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"timeline_arrows_by"===t&&To.tF({collectionViewStore:o,newProperty:n,transaction:i})}),[t]),m=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),S=(0,n.useCallback)((()=>ft.ND(o,m)),[o,m]),f=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?at.km({environment:l,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?To._p({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,N.t1)(t)}),[o,l,t]),y=(0,n.useCallback)((e=>{const{featureType:t}=e,n=o.collectionStore(),i=n,r=o.collectionViewStore();n&&i&&(p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:l,perform:a=>{const s=rt.G3({environment:l,collectionStore:n,collectionViewArgs:r?{collectionViewStore:r,format:r.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:a});return Vo.n7({environment:l,collectionContextStore:o,collectionStore:n,property:s,propertyName:d,targetCollectionStore:i,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:c,transaction:a,from:t}),r&&(g({collectionViewStore:r,newProperty:s,transaction:a}),f({relationPropertyId:s,transaction:a})),"timeline_arrows_by"===t&&Go({environment:l,intl:c,collectionStore:n,transaction:a,newConfig:e.dateShiftingConfig}),s}}),no._H({environment:l,collectionContextStore:o,from:t,property_type:"relation"}))}),[o,l,d,c,f,g]),x=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let r;p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:l,perform:t=>{g({collectionViewStore:n,newProperty:e,transaction:t}),f({relationPropertyId:e,transaction:t})}}),i(e),"subitem"===t?r="update_default_subitem":"timeline_arrows_by"===t?r="update_default_timeline_arrows_by":(0,N.t1)(t),no.wd({action:r,original_view_type:void 0,property_type:e?"relation":void 0,environment:l,collectionContextStore:o})}),[o,l,i,t,g,f]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let r;p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:l,perform:t=>{g({collectionViewStore:n,newProperty:e,transaction:t})}}),i(e),"subitem"===t?r="update_subitem":"timeline_arrows_by"===t?r="update_timeline_arrows_by":(0,N.t1)(t),no.wd({action:r,original_view_type:void 0,property_type:e?"relation":void 0,environment:l,collectionContextStore:o})}),[o,l,i,t,g]),handleDefaultPropertySelect:x,handleAddRelation:y,getProperties:S,clearCollectionViewSubitemDisplayMode:(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&p.createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:l,perform:t=>{u.FH({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,l])}}function Zo(e){const{feature:t,collectionContextStore:o}=e;let n,i;var r,a;if("subitem"===t)i=null===(r=o.collectionStore())||void 0===r?void 0:r.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(a=o.collectionViewStore())||void 0===a?void 0:a.getFormat().subitem_display_mode)?void 0:i;else if("timeline_arrows_by"===t){var s;n=o.currentArrowsByFormatStore.state,i=null===(s=o.collectionStore())||void 0===s?void 0:s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,N.t1)(t);const l=o.normalizedSchemaStore.state,c=ft.NA(o,l);(0,N.$K)(n)&&!c.includes(n)&&(n=void 0),(0,N.$K)(i)&&!c.includes(i)&&(i=void 0);const d=n??i;if(d){var u;const e=Boolean(n),r=Qe.default.checkGate("collection_subitem_new_show_hide_options"),a="hidden"!==(null===(u=o.collectionViewStore())||void 0===u?void 0:u.getFormat().subitem_display_mode),s="subitem"===t?!e:e;return{property:d,isDefault:d===i,enabledOnView:e,enabledOnCollection:Boolean(i),supportedInView:qo({feature:t,viewType:o.getViewType()}),isVisibleInView:r&&"subitem"===t?a:s}}}function Bo(e){const{feature:t,collectionContextStore:o}=e;return(0,a.VK)((()=>Zo({feature:t,collectionContextStore:o})),[o,t])}function Io(e){const{currentPropertyId:t,feature:o,collectionContextStore:n,permissionScopes:i,onPropertySelect:r,buttonPopupStore:l,disabled:c}=e,d=(0,s.useIntl)(),u=(0,a.VK)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,N.t1)(o)}),[o,n]),p=(0,a.VK)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:g,handlePropertySelect:m,getProperties:S}=Fo({collectionContextStore:n,feature:o,onPropertySelect:r}),f=(0,St.g3)({feature:o,databaseType:p});return(0,b.jsx)(Ko,{intl:d,icon:ao.v,caption:(0,b.jsx)(s.FormattedMessage,{...f}),collectionContextStore:n,buttonPopupStore:l,shouldGroupProperties:!0,getGroupedProperties:S,currentProperty:t,disabled:c,onAccept:i.canConfigureBlock&&i.canConfigureCollection?m:()=>{},renderProperty:(e,t,i,r)=>(0,b.jsx)(_o,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:u,checkState:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:g,handlePropertySelect:m})})}function Ao(e){const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:r,title:l}=e,c=(0,s.useIntl)(),d=(0,a.qz)(void 0,xt.Z),u=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),p=(0,n.useCallback)((()=>Object.keys(u).filter((e=>{const t=u[e];return"date"===(null==t?void 0:t.type)})).filter(N.$K)),[u]);return(0,b.jsx)(Ko,{intl:c,buttonPopupStore:d,title:l,collectionContextStore:o,shouldGroupProperties:!1,getProperties:p,currentProperty:t,disabled:r,onAccept:e=>{e&&i(e),d.setState({open:!1})}})}function Ko(e){const{currentProperty:t,icon:o,caption:n,buttonPopupStore:i,collectionContextStore:l,disabled:c,title:d,shouldGroupProperties:u}=e,p=(0,r.Fy)(),g=(0,a.VK)((()=>{var e;return(null===(e=l.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[l]),m=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),S=(0,f.yK)((e=>({caption:{fontSize:p.isMobile?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[p]),y=(0,a.VK)((()=>i.state.open),[i]),x=(0,a.VK)((()=>p.isPhone?{menuType:so.og.ActionSheet}:{menuType:so.og.Popup,width:300}),[p.isPhone]);return(0,b.jsxs)(b.Fragment,{children:[n&&(0,b.jsx)("div",{style:S.caption,children:n}),(0,b.jsx)(Y.ZP,{popupType:p.isPhone?te.kQ.SlideUp:te.kQ.Popup,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,disabled:c,originGap:0,renderOrigin:e=>{var n;return(0,b.jsx)(A.Z,{title:d??(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:null===(n=m[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:y,disabled:c,icon:o,...e})},render:t=>(0,b.jsx)(J.Z,{...x,children:u?(0,b.jsx)(vo,{...e,getGroupedProperties:e.getGroupedProperties,format:g,schema:m}):(0,b.jsx)(wo.Z,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:g,schema:m})}),buttonPopupStore:i})]})}const Oo="consume_gap",Do=!0;function Ro(e){var t;const{currentConfig:o,onConfigChange:i,disabled:l,collectionContextStore:c}=e,d=(0,a.VK)((()=>c.databaseType),[c]),u=(0,r.O7)(),p=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[g,m]=(0,n.useState)((0,N.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):Do),S=(0,N.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):g;(0,n.useEffect)((()=>{if((0,N.$K)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==g&&m(e)}}),[o,g]);const y=(0,f.yK)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),x=(0,n.useCallback)((e=>{(0,N.$K)(o.configWithoutDates)&&(i({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),no.wd({environment:u,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,u,i]),h=(0,n.useCallback)((e=>{(0,N.$K)(e)?i({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:g}}):i({...o,configWithoutDates:void 0}),no.wd({environment:u,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,u,g,i]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{...St.dH.dateShiftingSectionCaption}),disableMobileBorders:!0,style:y.previewContainer,desktopTitleStyle:y.previewTitle,children:(0,b.jsx)(Gt,{mode:p})}),(0,b.jsx)(ne.Z,{disableMobileBorders:!0,style:y.dateShiftContainer,children:(0,b.jsx)(No,{currentMode:p,onModeChange:h,databaseType:d,disabled:l})}),(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(Uo,{currentValue:S,databaseType:d,onChange:x,disabled:l||!(0,N.$K)(o.configWithoutDates)}),(0,b.jsx)(Lo,{...e})]})]})}function Lo(e){const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:r}=e,l=(0,a.VK)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,Jt.Lt)(o)}))}),[t]),c=l.length,d=o.datePropertyId?l.find((e=>e!==o.datePropertyId)):void 0,u="string"==typeof o.datePropertyId&&(0,N.$K)(o.endDatePropertyId),p=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(u&&(0,N.$K)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=l.find((e=>e!==t)))}i({...o,...n})}),[o,l,i,u]);return!(0,N.$K)(o.configWithoutDates)||c<=1?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ao,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:u?(0,b.jsx)(s.FormattedMessage,{...St.dH.startDate}):(0,b.jsx)(s.FormattedMessage,{...St.dH.datePropertyPickerTitle}),onPropertyChanged:e=>p("datePropertyId",e),disabled:r}),(0,N.$K)(d)&&"string"==typeof o.datePropertyId&&(0,b.jsxs)(b.Fragment,{children:[(0,N.$K)(o.endDatePropertyId)&&(0,b.jsx)(Ao,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,b.jsx)(s.FormattedMessage,{...St.dH.endDate}),onPropertyChanged:e=>p("endDatePropertyId",e),disabled:r}),(0,b.jsx)(ie.Z,{title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:u,disabled:r,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:u?void 0:d})}})]})]})}function Ho(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,b.jsx)(A.Z,{icon:to.H,showChevron:!0,disabled:i,title:(0,b.jsx)(s.FormattedMessage,{...St.dH.advancedSettings}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function zo(e){const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,f.yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const a=(0,St.Tq)({feature:t,databaseType:n});return(0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:r.buttonWrap,children:(0,b.jsx)(oe.Z,{style:r.button,onClick:o,isLarge:!0,children:(0,b.jsx)(s.FormattedMessage,{...a})})})})}function Eo(e){const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:i,inversePropertyName:l,collectionContextStore:c,collectionSettingsStore:u,handleDefaultPropertySelect:g,databaseType:m,clearCollectionViewSubitemDisplayMode:S}=e,y=(0,r.O7)(),x=(0,f.yK)((e=>({modalTitle:{fontWeight:F.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalPropertyName:{color:e.darkTextColor,fontWeight:F.Z.fontWeight.semibold}})),[]),h=(0,a.VK)((()=>c.currentSubitemFormatStoreForCollection.state),[c]),C=(0,a.VK)((()=>(0,_t._e)(c)),[c]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&l))return null;const v=(0,St.nB)({feature:t,databaseType:m}),j=(0,St.OH)({feature:t,databaseType:m}),w=(null==h?void 0:h.inverse)===i||(null==h?void 0:h.property)===i,M=(null==C?void 0:C.inverse)===i||(null==C?void 0:C.property)===i,_=w&&M,k={label:(0,b.jsx)(s.FormattedMessage,{...St.dH.turnOffAndDelete}),color:"red",onAccept:async()=>{i&&(await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,a=o.collectionStore();if(!a)return;await p.createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>rt.yV({environment:t,collectionStore:a,schema:r,property:n,transaction:e})});const s=r[n];s&&no.y9({environment:t,collectionContextStore:o,property_type:s.type,from:i,property:n})}({environment:y,propertyId:i,collectionContextStore:c,feature:t}),g(void 0),null==S||S(),d.wl({collectionSettingsStore:u,item:{type:"main"}}))}},V={label:(0,b.jsx)(s.FormattedMessage,{...St.dH.turnOffFeature}),color:"red",onAccept:()=>{i&&(g(void 0),null==S||S(),d.wl({collectionSettingsStore:u,item:{type:"main"}}))}};return(0,b.jsx)(A.Z,{icon:P.y,title:(0,b.jsx)(s.FormattedMessage,{...v}),isRed:!0,onClick:()=>{Z.showDialog({description:(0,b.jsx)(s.FormattedMessage,{...St.dH.turnOffFeatureDeletedProperties,values:{span:e=>(0,b.jsx)("span",{style:x.modalPropertyName,children:e}),propertyName:n,inversePropertyName:l}}),message:(0,b.jsx)("div",{style:x.modalTitle,children:(0,b.jsx)(s.FormattedMessage,{...j})}),innerStyle:x.modalInnerStyle,showCancel:!0,keepFocus:!0,items:_?[k,V]:[k]})}})}function Uo(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,b.jsx)(ie.Z,{title:(0,b.jsx)(s.FormattedMessage,{...St.dH.avoidWeekendsSwitcherTitle}),caption:(0,b.jsx)(s.FormattedMessage,{...(0,St.Bq)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function No(e){const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,f.yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,b.jsx)("div",{style:r.wrap,children:[...eo.Bp,void 0].map((e=>(0,b.jsx)(Wo,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function Wo(e){const{dateShiftingMode:t,onClick:o,active:n,disabled:i,databaseType:a}=e,l=(0,r.Fy)(),c=(0,f.yK)((e=>({buttonStyles:{fontSize:l.isMobile?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,fontWeight:F.Z.fontWeight.medium,borderRadius:4,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...i&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,l,i]),d=(0,St.W3)({dateShiftingMode:t,databaseType:a}),u=(0,St.l7)(t);return(0,b.jsx)(O.Z,{style:c.buttonStyles,onClick:o,disabled:i,children:(0,b.jsxs)("div",{style:c.buttonContentWrap,children:[(0,b.jsx)("div",{children:u(c.icon)}),(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{...d})})]})})}function Go(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let a;if((0,N.$K)(o.configWithoutDates))if(o.datePropertyId)a={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,oo.ZP)(),s={name:r.formatMessage(St.dH.newDateProperty),type:"date"};ro.xO({environment:t,collectionStore:n,update:{[e]:s},transaction:i}),a={...o.configWithoutDates,date_property:e,end_date_property:void 0}}io.sW({store:n.getFormatStore(),data:{dependency_date_shifting_config:a??null},transaction:i})}function qo(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,N.t1)(o)}function $o(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:i}=e,l=(0,s.useIntl)(),c=(0,r.Fy)(),u=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,a.VK)((()=>t.databaseType),[t]),g=(0,a.VK)((()=>t.collectionStore()),[t]),m=Bo({collectionContextStore:t,feature:i}),S=null==m?void 0:m.property,y=(0,n.useMemo)((()=>lt.HI(u)),[u]),x=(0,a.VK)((()=>t.permissionScopes.state),[t]),h=(0,a.VK)((()=>{var e;return S&&(null===(e=u[S])||void 0===e?void 0:e.name)}),[u,S]),C=(0,a.VK)((()=>t.collectionViewStore()),[t]),v=(0,a.VK)((()=>null==C?void 0:C.getFormat()),[C]),j=(null==v?void 0:v.subitem_display_mode)??"show",w=(0,a.VK)((()=>{const e=S&&u[S];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=u[o])||void 0===t?void 0:t.name:void 0}}),[S,u]),M=(0,a.VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?ft.aI(l,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):l.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,l,i]),_=(0,a.VK)((()=>Boolean(g&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,N.$K)(i)||i===n}({collectionContextStore:t,collectionStore:g}))),[t,g]),k=(0,a.qz)(void 0,xt.Z),V=(0,n.useCallback)((e=>{e&&k.setState({open:!1})}),[k]),{initialPropertyName:T}=Po({collectionContextStore:t,feature:i}),P=Fo({collectionContextStore:t,onPropertySelect:V,feature:i}),{handleAddRelation:Z,handleDefaultPropertySelect:B,clearCollectionViewSubitemDisplayMode:A}=P,K=(0,f.yK)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:c.isMobile?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:F.Z.fontWeight.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[c]);if(!g)return null;let O;if("subitem"===i)if(m)O=(0,b.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,b.jsx)("div",{style:K.subitemsPreviewContainer,children:(0,b.jsx)(jt,{propertyName:h||T,inversePropertyName:w||M,newDesign:!0,subitemsDisplayMode:j})}),(0,b.jsx)(nn,{databaseType:p,permissionScopes:x}),(0,b.jsx)(ct.Z,{size:12,style:{marginTop:4,marginBottom:4}}),(0,b.jsx)(Ho,{collectionSettingsStore:o,feature:i,permissionScopes:x}),(0,b.jsx)(Eo,{feature:i,databaseType:p,permissionScopes:x,propertyName:h,relationPropertyId:S,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:B,inversePropertyName:w,clearCollectionViewSubitemDisplayMode:A})]});else{const e=()=>{Z({featureType:"subitem"}),d.z$({collectionSettingsStore:o}),et.default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,it.DY)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,mt.Af)(e);at.rT({collectionContextStore:t,pathKey:o})}}))};O=(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(jt,{propertyName:h||T,inversePropertyName:w||M,newDesign:!0,subitemsDisplayMode:j}),(0,b.jsx)(zo,{feature:i,permissionScopes:x,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===i?O=m?(0,b.jsxs)(b.Fragment,{children:[_?(0,b.jsx)(Yo,{collectionContextStore:t,firstDatePropertyId:y,permissionScopes:x}):(0,b.jsx)(Xo,{collectionContextStore:t,databaseType:p}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(Ho,{collectionSettingsStore:o,feature:i,permissionScopes:x}),(0,b.jsx)(Jo,{feature:i,databaseType:p,featuredRelationProperty:m,actions:P,permissionScopes:x}),(0,b.jsx)(Eo,{feature:i,databaseType:p,permissionScopes:x,relationPropertyId:S,propertyName:h,inversePropertyName:w,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:B})]})]}):(0,b.jsx)(Qo,{databaseType:p,collectionContextStore:t,firstDatePropertyId:y,handleAddRelation:Z,permissionScopes:x}):(0,N.t1)(i);const D=(0,St.Gt)({feature:i,databaseType:p}),R=(0,St.qi)({feature:i,databaseType:p});return(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...D}),children:[(0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:{...K.container,...K.captionText},children:(0,b.jsx)(s.FormattedMessage,{...R})})}),O]})}function Xo(e){const{collectionContextStore:t,databaseType:o}=e,n=(0,r.MO)(),i=(0,f.yK)((e=>({wrap:{boxShadow:e.plainButtonBoxShadow,...n?{backgroundColor:e.sidebarBackground,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[n]),l=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),c=(0,St.uM)({currentDateShiftConfig:l,databaseType:o});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{...St.dH.dateShiftingSectionCaption}),children:(0,b.jsx)(Gt,{mode:null==l?void 0:l.mode})}),(0,b.jsx)(D,{style:i.wrap,showCloseButton:!1,children:(0,b.jsxs)("div",{style:i.iconWithMessage,children:[(0,nt.D)(i.icon),(0,b.jsx)(dt.Z,{isSmall:!0,isMultiline:!0,children:(0,b.jsx)(s.FormattedMessage,{...c})})]})})]})}function Yo(e){const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:i}=e,l=(0,r.O7)(),c=(0,s.useIntl)(),d=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),u=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&p.createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:l,perform:t=>{Go({collectionStore:o,environment:l,intl:c,newConfig:e,transaction:t})}})}),[t,l,c]),g=(0,n.useMemo)((()=>({configWithoutDates:d,...d?{datePropertyId:d.date_property,endDatePropertyId:d.end_date_property}:{datePropertyId:o}})),[d,o]);return(0,b.jsx)(Ro,{collectionContextStore:t,currentConfig:g,disabled:!i.canConfigureBlock||!i.canConfigureCollection,onConfigChange:u})}function Qo(e){const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:r,databaseType:s}=e,[l,c]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:Oo,avoid_weekends:Do}}),u=(0,a.VK)((()=>t.settingsStore),[t]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ro,{collectionContextStore:t,currentConfig:l,disabled:!r.canConfigureBlock||!r.canConfigureCollection,onConfigChange:c}),(0,b.jsx)(zo,{feature:"timeline_arrows_by",permissionScopes:r,databaseType:s,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:l}),d.z$({collectionSettingsStore:u})}})]})}function Jo(e){const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:i,databaseType:a}=e,l=(0,r.Fy)(),c=(0,f.yK)((()=>({eyeHideIcon:{width:20,height:l.isMobile?24:12,marginLeft:3}})),[l]);if(!o.supportedInView)return null;const d=o.enabledOnView,u=o.isVisibleInView,p=u?{icon:ot.B,iconStyle:c.eyeHideIcon}:{icon:tt.c};return(0,b.jsx)(A.Z,{...p,onClick:()=>{n.handlePropertySelect(d?void 0:o.property)},title:(0,b.jsx)(s.FormattedMessage,{...(0,St.cn)({feature:t,isOn:u,databaseType:a})}),disabled:!i.canConfigureBlock})}function en(e){const{subitemDisplayMode:t,collectionViewType:o,intl:n,databaseType:i}=e;if("show"===t)switch(o){case"board":case"calendar":case"gallery":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"Card property"});case"table":case"list":case"timeline":case"page":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"})}else{if("hidden"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Parents only"},{items:(0,st.Q_)(i,!0)});if("flattened"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});(0,N.t1)(t)}}const tn=["show","hidden","flattened"];function on(e){const{intl:t,collectionViewType:o,databaseType:n}=e;return tn.map((e=>({key:e,title:en({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:n})})))}function nn(e){const{databaseType:t,permissionScopes:o}=e,i=(0,yt.E)("collection_subitem_new_show_hide_options"),l=(0,s.useIntl)(),c=(0,ut.Y$)(),d=(0,a.VK)((()=>c.collectionViewStore()),[c]),g=(0,a.VK)((()=>null==d?void 0:d.getFormat()),[d]),m=(null==g?void 0:g.subitem_display_mode)??"show",S="show"===m,y=(0,r.Fy)(),x=(0,r.O7)(),h=(0,f.yK)((()=>({eyeHideIcon:{width:20,height:y.isMobile?24:12,marginLeft:3}})),[y]),C=n.useCallback((()=>{d&&p.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:x,perform:e=>{u.FH({stores:[d],update:{subitem_display_mode:S?"flattened":"show"},transaction:e})}})}),[S,d,x]),v=n.useCallback((e=>{const t=c.getPropertyFormatKey(),o=(0,mt.wf)(c),n=null==o?void 0:o.property,i=null==o?void 0:o.inverse;d&&t&&n&&i&&e&&e!==m&&p.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:x,perform:o=>{const r=d.getType(),a="board"===r||"gallery"===r||"calendar"===r;if(rt.er({formatStore:d,formatKey:t,property:n,update:{visible:a&&"show"===e},transaction:o}),"hidden"===m){var s;const e=null==g||null===(s=g.property_filters)||void 0===s?void 0:s.filter((e=>e.id!==gt.OC));u.FH({stores:[d],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:i,filter:{operator:"is_empty"}},t=(null==g?void 0:g.property_filters)||[];u.FH({stores:[d],update:{property_filters:[...t,{id:gt.OC,filter:e}]},transaction:o})}u.FH({stores:[d],update:{subitem_display_mode:e},transaction:o})}})}),[c,d,x,g,m]);(0,n.useEffect)((()=>{pt.j(x,"configure_subitem_display_mode",{userAction:S?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[S,x]);const j=S?{icon:tt.c}:{icon:ot.B,iconStyle:h.eyeHideIcon},w=(0,a.VK)((()=>(null==d?void 0:d.getType())??"table"),[d]);return"chart"===w?(0,b.jsx)(b.Fragment,{}):i?(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Show as",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:c,selectedKey:m,options:on({collectionViewType:w,intl:l,databaseType:t}),onChange:e=>v(e),disabled:!o.canConfigureBlock}):(0,b.jsx)(A.Z,{...j,onClick:C,title:(0,b.jsx)(s.FormattedMessage,{...(0,St.cn)({feature:"subitem",isOn:S,databaseType:t})}),disabled:!o.canConfigureBlock})}var rn=o(91),an=o(80402),sn=o(24006),ln=o(26388),cn=o(60442);function dn(e){const{render:t,showImage:o,caption:i,tooltipImage:r}=e,a=e.tooltipImageScale||1,[s,l]=n.useState(!1),[c,d]=n.useState({width:0,height:0});return n.useEffect((()=>{if(r){const e=new Image;e.src=r,e.onload=()=>{d({width:e.width*a,height:e.height*a}),l(!0)}}}),[r,a]),(0,b.jsx)(ln.ZP,{placement:ln.ug.Left,disableTooltip:void 0===i,style:{whiteSpace:"break-spaces"},render:t,renderTooltip:()=>r&&s&&o?(0,b.jsx)(cn.Z,{caption:i,imageURL:r,imageWidth:c.width,imageHeight:c.height}):(0,b.jsx)("div",{children:i})})}const un="box1-filter",pn="box2-filter";function gn(e){const{propertyName:t,inversePropertyName:o}=e,n=(0,f.Fg)(),i=(0,f.yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:i.svgWrap,children:(0,b.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,b.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,b.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,b.jsx)("path",{fill:n.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,b.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,b.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,b.jsxs)("g",{filter:`url(#${un})`,children:[(0,b.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,b.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,b.jsxs)("g",{filter:`url(#${pn})`,children:[(0,b.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,b.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,b.jsx)(mn,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.regularTextColor},children:t}),(0,b.jsx)(mn,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,b.jsxs)("defs",{children:[(0,b.jsxs)("filter",{id:un,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,b.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,b.jsx)("feOffset",{}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feOffset",{dy:"2"}),(0,b.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,b.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,b.jsxs)("filter",{id:pn,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,b.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,b.jsx)("feOffset",{}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,b.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,b.jsx)("feOffset",{dy:"2"}),(0,b.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,b.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,b.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,b.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,b.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function mn(e){const{children:t,textStyles:o,...n}=e;return(0,b.jsx)("foreignObject",{...n,children:(0,b.jsx)("div",{style:{...F.Z.textOverflowStyle,...n.width?{width:Number(n.width)}:{},...o},children:t})})}function Sn(e){var t;const{collectionContextStore:o,feature:i}=e,r=(0,s.useIntl)(),l=(0,a.VK)((()=>o.collectionStore()),[o]),c=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),d=(0,a.VK)((()=>o.permissionScopes.state),[o]),u=null===(t=Bo({collectionContextStore:o,feature:i}))||void 0===t?void 0:t.property,p=(0,a.VK)((()=>{var e;return u&&(null===(e=c[u])||void 0===e?void 0:e.name)}),[u,c]),g=(0,a.VK)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),m=(0,a.VK)((()=>{const e=u&&c[u];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=c[o])||void 0===t?void 0:t.name:void 0}}),[u,c]),S=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?ft.aI(r,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):r.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,r,i]),y=(0,a.qz)(void 0,xt.Z),{initialPropertyName:x}=Po({collectionContextStore:o,feature:i}),h=(0,n.useCallback)((e=>{e&&y.setState({open:!1})}),[y]),C=(0,f.yK)((()=>({previewContainer:{marginLeft:2}})),[]);if(!l)return null;let v;return"subitem"===i?v=(0,b.jsx)(jt,{propertyName:p||x,inversePropertyName:m||S,newDesign:!0,subitemsDisplayMode:"show"}):"timeline_arrows_by"===i?v=(0,b.jsx)(gn,{propertyName:p||x,inversePropertyName:m||S}):(0,N.t1)(i),(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...St.dH.advancedSettings}),children:[(0,b.jsx)("div",{style:C.previewContainer,children:v}),(0,b.jsxs)(ne.Z,{disableMobileBorders:!0,children:[(0,b.jsx)(Io,{currentPropertyId:u,feature:i,onPropertySelect:h,buttonPopupStore:y,collectionContextStore:o,permissionScopes:d,disabled:!d.canConfigureCollection}),"subitem"===i&&g&&(0,b.jsx)(fn,{collectionContextStore:o,permissionScopes:d})]})]})}function fn(e){const{collectionContextStore:t,permissionScopes:o}=e,i=(0,s.useIntl)(),l=(0,r.O7)(),c=(0,a.VK)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),d=!o.canConfigureBlock,u=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(an.d1({environment:l,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),no.wd({environment:l,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,l]);return(0,b.jsx)(dn,{showImage:o.canConfigureBlock,caption:i.formatMessage(St.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,b.jsx)(A.Z,{...e,icon:e=>(0,rn.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),onClick:u,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,b.jsx)(sn.Z,{disallowTabbing:!0,on:c,disabled:d,onClick:u}),disabled:d})})}var yn=o(47025),xn=o(49089);const hn=(0,v.IU)("chartAxisName",{viewBox:"0 0 20 20",svg:(0,b.jsx)("g",{children:(0,b.jsx)("path",{d:"M2.71 12.742c-.417 0-.786-.078-1.106-.234a1.833 1.833 0 01-.756-.662 1.8 1.8 0 01-.276-.996c0-.555.205-.996.616-1.325.414-.332 1.001-.517 1.763-.556l1.817-.106v-.48c0-.383-.122-.684-.364-.903-.238-.222-.566-.334-.984-.334-.352 0-.647.075-.885.223-.234.149-.435.381-.603.697a.613.613 0 01-.217.2.61.61 0 01-.287.064.562.562 0 01-.387-.135.481.481 0 01-.146-.363c0-.066.007-.133.023-.2A1.53 1.53 0 011 7.422c.164-.379.467-.682.908-.908.442-.227.957-.34 1.547-.34.516 0 .961.088 1.336.263.379.176.67.422.873.739.207.316.31.69.31 1.119v3.838c0 .195-.054.348-.163.457a.57.57 0 01-.422.158.595.595 0 01-.422-.152.562.562 0 01-.164-.41v-.657h-.03a1.92 1.92 0 01-.498.65 2.32 2.32 0 01-.72.417c-.27.097-.551.146-.844.146zm.33-.932c.32 0 .608-.068.866-.205.262-.136.47-.32.627-.55.156-.235.235-.496.235-.785v-.592l-1.653.111c-.418.027-.74.133-.967.316a.855.855 0 00-.34.704c0 .3.114.543.34.726.23.184.528.275.891.275zm4.651.932a.578.578 0 01-.427-.158c-.106-.105-.159-.254-.159-.445V4.627a.63.63 0 01.165-.457.591.591 0 01.445-.176c.18 0 .324.059.433.176.114.113.17.266.17.457v2.889h.036c.18-.41.45-.735.814-.973a2.263 2.263 0 011.26-.357c.539 0 1.007.134 1.406.404.398.265.707.644.926 1.137.219.492.328 1.072.328 1.74 0 .668-.11 1.248-.328 1.74-.215.492-.524.871-.926 1.137-.402.265-.873.398-1.412.398-.488 0-.914-.117-1.277-.351a2.266 2.266 0 01-.827-.967h-.023v.715a.59.59 0 01-.17.445.598.598 0 01-.434.158zm2.403-1.002c.355 0 .664-.092.926-.275a1.75 1.75 0 00.603-.785c.14-.34.211-.744.211-1.213 0-.461-.072-.862-.217-1.201a1.743 1.743 0 00-.603-.786 1.522 1.522 0 00-.92-.28c-.348 0-.655.093-.92.28a1.878 1.878 0 00-.627.797c-.149.34-.223.737-.223 1.19 0 .46.074.861.223 1.201.152.34.361.604.627.791.265.188.572.281.92.281zm6.68 1.002c-.61 0-1.141-.133-1.594-.398a2.721 2.721 0 01-1.05-1.131c-.245-.492-.368-1.074-.368-1.746 0-.668.123-1.248.369-1.74a2.719 2.719 0 011.037-1.149c.45-.273.979-.41 1.588-.41.414 0 .795.068 1.142.205.352.137.653.324.903.563.25.238.426.507.527.808a.73.73 0 01.041.152c.012.051.018.1.018.147a.47.47 0 01-.147.363.547.547 0 01-.375.13.56.56 0 01-.316-.083.865.865 0 01-.235-.287c-.156-.332-.363-.582-.62-.75a1.608 1.608 0 00-.909-.252c-.535 0-.965.207-1.289.621-.324.41-.486.969-.486 1.676 0 .71.162 1.271.486 1.682.324.406.754.609 1.29.609.37 0 .683-.084.937-.252a1.77 1.77 0 00.603-.727.944.944 0 01.235-.298.539.539 0 01.334-.094.504.504 0 01.515.504.81.81 0 01-.017.158c-.012.055-.03.113-.053.176-.117.297-.303.56-.557.79-.254.231-.555.41-.902.54a3.129 3.129 0 01-1.108.193zM1.345 16.434a.718.718 0 01-.528-.217.721.721 0 01-.21-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.888 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.73.73 0 01.744-.732c.204 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.729.729 0 01.744-.732c.203 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.721.721 0 01-.211-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.216.522.711.711 0 01-.522.217zm2.883 0a.711.711 0 01-.522-.217.711.711 0 01-.216-.522.71.71 0 01.216-.521.721.721 0 01.522-.211.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.889 0a.718.718 0 01-.528-.217.711.711 0 01-.217-.522.728.728 0 01.744-.732c.2 0 .372.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.704.704 0 01-.515.217zm2.882 0a.73.73 0 01-.527-.217.71.71 0 01-.217-.522.71.71 0 01.217-.521.74.74 0 01.527-.211c.203 0 .375.07.516.21a.71.71 0 01.217.522.71.71 0 01-.217.522.692.692 0 01-.516.217z"})})}),Cn=(0,v.IU)("chartGridLine",{viewBox:"0 0 20 20",svg:(0,b.jsxs)("g",{children:[(0,b.jsx)("circle",{cx:"4",cy:"10",r:"1"}),(0,b.jsx)("circle",{cx:"8",cy:"10",r:"1"}),(0,b.jsx)("circle",{cx:"12",cy:"10",r:"1"}),(0,b.jsx)("circle",{cx:"16",cy:"10",r:"1"})]})}),vn=(0,v.IU)("collectionVerticalSegments",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M2.38428 7.84033L13.6362 7.84033V9.15967L2.38428 9.15967V7.84033ZM1.61865 4.36084C1.61865 3.62256 1.8055 3.06429 2.1792 2.68604C2.55745 2.30778 3.11117 2.11865 3.84033 2.11865L12.1597 2.11865C12.8934 2.11865 13.4471 2.30778 13.8208 2.68604C14.1945 3.06429 14.3813 3.62256 14.3813 4.36084L14.3813 12.6392C14.3813 13.3774 14.1945 13.9357 13.8208 14.314C13.4471 14.6922 12.8934 14.8813 12.1597 14.8813L3.84033 14.8813C3.11117 14.8813 2.55745 14.6922 2.1792 14.314C1.8055 13.9357 1.61865 13.3774 1.61865 12.6392L1.61865 4.36084ZM2.96533 4.44287L2.96533 12.5571C2.96533 12.8716 3.04736 13.1131 3.21143 13.2817C3.37549 13.4504 3.62386 13.5347 3.95654 13.5347L12.0503 13.5347C12.3784 13.5347 12.6245 13.4504 12.7886 13.2817C12.9526 13.1131 13.0347 12.8716 13.0347 12.5571L13.0347 4.44287C13.0347 4.12386 12.9526 3.88232 12.7886 3.71826C12.6245 3.54964 12.3784 3.46533 12.0503 3.46533L3.95654 3.46533C3.62386 3.46533 3.37549 3.54964 3.21143 3.71826C3.04736 3.88232 2.96533 4.12386 2.96533 4.44287Z"})});var bn=o(44643),jn=o(14177),wn=o(84199),Mn=o(83357);const _n="Not implemented";function kn(e){var t;let{collectionViewStore:o,chartConfig:i}=e;const a=(0,r.O7)(),l=(0,f.Fg)(),c=(0,n.useCallback)((e=>{var t;const o=null===(t=(0,yn.kJ)(e,l))||void 0===t?void 0:t.slice(0,6);return{key:e,title:(0,b.jsx)(s.FormattedMessage,{...Mn.h5[e]}),caption:o?(0,b.jsx)("div",{style:{display:"flex"},children:null==o?void 0:o.map((e=>(0,b.jsx)("div",{style:{background:e,borderRadius:2,width:12,height:12,marginRight:3,marginTop:1}},e)))}):null,captionInline:!0,captionStyle:{marginLeft:"auto"},inlineSpacerStyle:{display:"none"}}}),[l]),d=(0,n.useMemo)((()=>[yn.iR.map(c),yn.b6.map(c)]),[c]),u=(null===(t=i.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto";return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartColor}),selectedKey:u,sections:d,icon:jn.y,hideCheck:!0,onChange:e=>{if(!e)return;const t=Mt.Xh(i);t.chartFormat||(t.chartFormat={}),t.chartFormat.colorTheme=e,p.createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,perform:e=>{io.sW({store:o.getFormatStore(),data:{chart_config:t},transaction:e})}})}})}function Vn(){const e=[{key:_n,title:_n}];return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartGroupStyle}),selectedKey:e[0].key,options:e,icon:vn,onChange:()=>{}})}function Tn(e){let{collectionViewStore:t,chartConfig:o}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>{var e;const t=null==o||null===(e=o.axisConfig.axisFormat)||void 0===e?void 0:e.axisGridLine;return t||"horizontal"}),[o]),c=(0,n.useCallback)((e=>{const n=Mt.Xh(o);n.axisConfig.axisFormat||(n.axisConfig.axisFormat={axisGridLine:yn.Xm.horizontal}),n.axisConfig.axisFormat.axisGridLine=e,p.createAndCommit({userAction:"chartSettings.setChartConfig",environment:i,perform:e=>{io.sW({store:t.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[o,t,i]),d=(0,f.yK)((()=>({menuItem:{...F.Z.textOverflowStyle}})),[]),u=(0,n.useMemo)((()=>Object.entries(Mn.s8).map((e=>{let[t,o]=e;return{key:t,title:(0,b.jsx)("div",{style:d.menuItem,children:(0,b.jsx)(s.FormattedMessage,{...o})})}}))),[d.menuItem]);return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartGridLine}),selectedKey:l,options:u,icon:Cn,onChange:c})}function Pn(e){let{collectionViewStore:t,chartConfig:o}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>{var e;const t=null==o||null===(e=o.axisConfig.axisFormat)||void 0===e?void 0:e.axisLabel;return t||yn.Xg.none}),[o]),c=(0,n.useCallback)((e=>{const n=Mt.Xh(o);n.axisConfig.axisFormat||(n.axisConfig.axisFormat={axisLabel:yn.Xg.none}),n.axisConfig.axisFormat.axisLabel=e,p.createAndCommit({userAction:"chartSettings.setChartConfig",environment:i,perform:e=>{io.sW({store:t.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[o,t,i]),d=(0,f.yK)((()=>({menuItem:{...F.Z.textOverflowStyle}})),[]),u=(0,n.useMemo)((()=>Object.entries(Mn.li).map((e=>{let[t,o]=e;return{key:t,title:(0,b.jsx)("div",{style:d.menuItem,children:(0,b.jsx)(s.FormattedMessage,{...o})})}}))),[d.menuItem]);return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartAxisName}),selectedKey:l,options:u,icon:hn,onChange:c})}function Fn(e){let{collectionViewStore:t,chartConfig:o}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>{var e;return!(null!=o&&null!==(e=o.chartFormat)&&void 0!==e&&e.hideLegend)}),[o]),c=(0,n.useCallback)((()=>{var e;const n=Mt.Xh(o);n.chartFormat||(n.chartFormat={hideLegend:!1}),n.chartFormat.hideLegend=!(null!==(e=o.chartFormat)&&void 0!==e&&e.hideLegend),p.createAndCommit({userAction:"chartSettings.setChartConfig",environment:i,perform:e=>{io.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}})}),[o,t,i]);return(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartLegend}),showChevron:!1,right:(0,b.jsx)(sn.Z,{on:l,onClick:c}),icon:wn.N,onClick:c})}function Zn(){return(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartCaption}),showChevron:!1,right:(0,b.jsx)(sn.Z,{on:!0}),icon:xn.o})}function Bn(e){let{collectionViewStore:t,chartConfig:o}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>{var e;return Boolean(null==o||null===(e=o.axisConfig)||void 0===e||null===(e=e.axisFormat)||void 0===e?void 0:e.hideEmptyGroups)}),[o]),c=(0,n.useCallback)((()=>{const e=Mt.Xh(o);e.axisConfig.axisFormat={...e.axisConfig.axisFormat,hideEmptyGroups:!l},p.createAndCommit({userAction:"chartSettings.setChartConfig",environment:i,perform:o=>{io.sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}})}),[o,t,i,l]);return(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartHideEmptyGroups}),showChevron:!1,right:(0,b.jsx)(sn.Z,{on:l,onClick:c}),icon:bn.L})}const In=function(e){const{collectionContextStore:t}=e,o=(0,a.VK)((()=>Qe.default.checkGate("charts_mvp")),[]),n=(0,a.VK)((()=>t.collectionViewStore()),[t]),i=(0,a.VK)((()=>t.normalizedFormatStore.state.chart_config),[t]);return o&&"placeholder"!==i.type?(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...Mn.OV.chartStyleTitle}),children:[(0,b.jsx)(kn,{collectionViewStore:n,chartConfig:i}),(0,b.jsx)(Vn,{}),("column"===i.type||"line"===i.type)&&(0,b.jsx)(Tn,{collectionViewStore:n,chartConfig:i}),("column"===i.type||"line"===i.type)&&(0,b.jsx)(Pn,{collectionViewStore:n,chartConfig:i}),(0,b.jsx)(Fn,{collectionViewStore:n,chartConfig:i}),(0,b.jsx)(Zn,{}),("column"===i.type||"line"===i.type)&&(0,b.jsx)(Bn,{collectionViewStore:n,chartConfig:i})]}):null};var An=o(47453),Kn=o(89475),On=o(98742),Dn=o(30874);function Rn(e){const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:i}=e,l=(0,f.yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),c=(0,r.O7)(),u=(0,a.VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),p=(0,a.VK)((()=>{const e=Dn.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&u?(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:Ln({environment:c,integration:t,spaceId:u}),children:(0,b.jsx)("div",{style:l.settingsMenu,children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:p.map((e=>{const n={key:e.id,render:o=>(0,b.jsx)(ln.ZP,{renderTooltip:()=>(0,b.jsx)("span",{children:e.account_name}),placement:ln.ug.Left,textWrap:!0,render:n=>(0,b.jsx)(X.Z,{...(0,On.Z)(n||{},o),title:e.account_name,icon:(0,b.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{d.z$({collectionSettingsStore:o}),i(e)}};return n})),render:e=>(0,b.jsx)(ne.Z,{...e})}]})})}):null}function Ln(e){const t=e.environment.device.isMobileBrowser;return(0,b.jsx)(ne.Z,{topBorder:!0,children:t?void 0:Hn(e)})}function Hn(e){return(0,b.jsx)(A.Z,{...e,icon:An.R,title:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await Kn.hM({...e,from:"source_picker_connect_another_account"})}})}var zn=o(58573),En=o(20270),Un=o(35840),Nn=o(31701),Wn=o(18265),Gn=o(57549),qn=o(893),$n=o(61202),Xn=o(45257),Yn=o(53336),Qn=o(70764),Jn=o(75079),ei=o(80444);function ti(e){const{onClick:t,integration:o,accountName:n}=e,i=(0,f.yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:F.Z.fontWeight.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,b.jsx)("div",{style:i.accountSelection,children:(0,b.jsxs)("div",{onClick:t,children:[(0,b.jsx)(dt.Z,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,b.jsx)(ln.ZP,{renderTooltip:()=>(0,b.jsx)("span",{children:n}),placement:ln.ug.Left,textWrap:!0,render:t=>(0,b.jsx)(X.Z,{showExtensionArrow:!0,focused:!1,...(0,On.Z)(t||{},e),title:n,icon:(0,b.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var oi=o(29109),ni=o(89728),ii=o(31278),ri=o(1634);function ai(e){const{collectionContextStore:t,integration:o}=e,n=(0,f.Fg)(),i=(0,a.VK)((()=>t.collectionStore()),[t]),l=(0,a.VK)((()=>null==i?void 0:i.getIcon()),[i]),c=(0,r.O7)(),d=(0,a.VK)((()=>{var e;return null===(e=ei.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),u=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.regularInvertedTextColor}})),[]),{background:p,hoveredBackground:g,pressedBackground:m}=(0,oi.d)(o,n.mode);return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,b.jsx)("div",{style:u.settingsMenu,children:(0,b.jsxs)("div",{style:u.authenticationBody,children:[(0,b.jsx)(ii.Z,{disabled:!0,bucket:"secure",store:i,icon:l,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,b.jsx)("div",{style:u.settingsMenuSubHeading,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,b.jsx)(ni.Z,{onClick:()=>{d&&(Kn.hM({environment:c,integration:o,spaceId:d,from:"placeholder_root_external_collection_view_block"}),ri.Z.reset())},style:{background:p,...u.settingsMenuAuthenticationButton},hoveredStyle:{background:g},pressedStyle:{background:m},children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function si(e){const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,a.VK)((()=>o.collectionStore()),[o]),r=(0,a.VK)((()=>{if(!i)return;const e=i.getFormat().integration_id;return Dn.Z.integrations.state.find((t=>t.id===e))}),[i]),s=(0,a.VK)((()=>!!r&&(0,Qn.NP)(r.id).length>0),[r]),l=(0,a.VK)((()=>{var e;return null===(e=ei.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return i&&l&&r?(0,b.jsx)(b.Fragment,{children:s?(0,b.jsx)(di,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r,externalAuthentication:n}):(0,b.jsx)(ai,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r})}):null}function li(e){var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))}const ci=(0,s.defineMessages)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function di(e){const{integration:t,collectionContextStore:o,collectionSettingsStore:i,externalAuthentication:l}=e,[c,u]=(0,n.useState)(""),p=(0,a.VK)((()=>{const e=Dn.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),g=(0,a.VK)((()=>l||(p.length?p[0]:null)),[p,l]),[m,S]=(0,n.useState)(!1),[y,h]=(0,n.useState)(null),C=(0,f.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:Nn.ZP.white,background:Nn.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),v=(0,a.VK)((()=>o.collectionStore()),[o]),j=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]),w=(0,r.O7)(),[{value:M,status:_}]=(0,x.r5)((async()=>{if(!g)return;const e=g.parent_id;return se.listExternalCollections(w,{bot_id:e})}),[w,g]),k="success"===(null==M?void 0:M.type)&&"data"in M.data?M.data.data:[],V="success"===(null==M?void 0:M.type)&&"error"in M.data?M.data.error:null,T=k.filter((e=>!y||e.type===y)),P=T.length?(0,zn.ZP)(c,T,(e=>e.title)):[],F=Array.from(new Set(k.map((e=>e.type)))),B=li({integration:t,url:c}),A=async e=>{if(S(!0),!v||!j)return;const n=e||c,r=li({integration:t,url:n});if(!r)return S(!1),void Z.showDialog({items:[{label:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{qn.RD({environment:w,stringValue:JSON.stringify({botId:null==g?void 0:g.parent_id,url:n},null,2),copiedMessage:qn.tq.copiedToClipboard})}},{label:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const a=(0,Qn.NP)(t.id);await $n.UY({environment:w,url:n,botIds:a.map((e=>e.id)),externalCollectionStore:v,externalCollectionViewBlockStore:j});const{host:l}=(0,Wn.Qc)(n);Gn.Mp(w,{...(0,Jn.Pn)(o),integrationId:t.id,type:"collection",entity:r.name,domain:l||"",from:"external_picker_settings"}),d.wl({collectionSettingsStore:i,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),S(!1)};if(!v||!j)return null;const K=F.length>1?(0,b.jsx)("div",{style:C.filterContainer,children:(0,b.jsxs)(Yn.Z,{type:Xe.Z.X,style:C.filterContainerScroller,showLeftRightOverlay:!1,children:[(0,b.jsx)(Xn.Z,{title:(0,b.jsx)("span",{children:yo.default.formatMessage(ci.all)}),on:!(0,N.K0)(y),hideChevron:!0,onClick:e=>{(0,$e.ZP)({event:e,context:$e.Af.CollectionSettingsClick,callback:()=>{h(null)}})}},"all"),F.map((e=>(0,b.jsx)(Xn.Z,{title:(0,b.jsx)("span",{children:yo.default.formatMessage(ci[e])}),on:y===e,hideChevron:!0,onClick:t=>{(0,$e.ZP)({event:t,context:$e.Af.CollectionSettingsClick,callback:()=>{h((t=>t===e?null:e))}})}},e)))]})}):null,O=B?(0,b.jsx)("div",{style:C.syncSourceButton,children:(0,b.jsx)(oe.Z,{isLarge:!0,onClick:e=>{(0,$e.ZP)({event:e,context:$e.Af.CollectionSettingsClick,callback:()=>{A()}})},disabled:!1,children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,D=B||k.length&&P.length?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:C.noResults,children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,b.jsxs)("div",{style:C.suggestionBox,children:[(0,nt.D)({marginRight:8,width:14,height:14}),(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),R=k.length&&P.length?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"collections",items:P.map((e=>{const t={key:e.url,render:t=>(0,b.jsx)(ln.ZP,{renderTooltip:()=>(0,b.jsx)("span",{children:e.title}),placement:ln.ug.Left,textWrap:!0,render:o=>(0,b.jsx)(X.Z,{...(0,On.Z)(o||{},t),title:e.title,icon:(0,b.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),A(e.url)}};return t})),render:e=>(0,b.jsx)(ne.Z,{...e,disableMobilePadding:!0})}]})}):null,L="pending"===_||"idle"===_||m;if(!g||V&&(V.status===En.mQ.UNAUTHORIZED||V.status===En.mQ.FORBIDDEN))return(0,b.jsx)(ai,{collectionContextStore:o,collectionSettingsStore:i,integration:t});const H="rejected"===_||"failed"===(null==M?void 0:M.type)||V,z=(0,b.jsx)(ti,{onClick:()=>{d.H4({collectionSettingsStore:i,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{d.H4({collectionSettingsStore:i,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:g.account_name});return(0,b.jsx)(I.ZP,{...e,footer:O||m?null:z,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!L&&"resolved"===_&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(mo.ZP,{inputLeft:(0,b.jsx)(mo.f_,{icon:Un.R}),onSubmit:()=>{B&&A()},style:C.settingsMenuSearchBox,focusInitial:!0,value:c,onChange:e=>{u(e.target.value)},placeholder:"Search source or paste a link..."}),B?null:K]}),children:(0,b.jsxs)("div",{style:C.settingsMenu,children:[H&&(0,b.jsx)("div",{style:C.errorMessage,children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),L&&(m?(0,b.jsxs)("div",{style:C.syncingData,children:[(0,b.jsx)("span",{children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,b.jsx)(Le.Z,{style:{alignSelf:"center"}})]}):(0,b.jsxs)("div",{style:C.syncingData,children:[(0,b.jsx)("span",{children:(0,b.jsx)(s.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,b.jsx)(Le.Z,{style:{alignSelf:"center"}})]})),!L&&"resolved"===_&&(0,b.jsxs)(b.Fragment,{children:[O,D,R]})]})})}var ui=o(79362),pi=o(20616),gi=o(71214),mi=o(33732),Si=o(49085),fi=o(92165),yi=o(12589),xi=o(80881);const hi=(0,v.IU)("groupByHorizontal",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H4.86914V13.1094H2.22363ZM6.18164 13.1094V3.02637H9.81152V13.1094H6.18164ZM13.7695 3.02637C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H11.124V3.02637H13.7695Z"})}),Ci=(0,v.IU)("groupByVertical",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M0.952148 1.83008H15.041C15.3691 1.83008 15.5879 1.59082 15.5879 1.24219C15.5879 0.893555 15.3691 0.647461 15.041 0.647461H0.952148C0.624023 0.647461 0.405273 0.886719 0.405273 1.24219C0.405273 1.59082 0.624023 1.83008 0.952148 1.83008ZM1.875 7.44238H3.2832C4.26758 7.44238 4.75293 6.95703 4.75293 5.94531V4.58496C4.75293 3.57324 4.26758 3.09473 3.2832 3.09473H1.875C0.890625 3.09473 0.405273 3.57324 0.405273 4.58496V5.94531C0.405273 6.95703 0.890625 7.44238 1.875 7.44238ZM7.28906 7.44238H8.69727C9.68164 7.44238 10.167 6.95703 10.167 5.94531V4.58496C10.167 3.57324 9.68164 3.09473 8.69727 3.09473H7.28906C6.30469 3.09473 5.81934 3.57324 5.81934 4.58496V5.94531C5.81934 6.95703 6.30469 7.44238 7.28906 7.44238ZM12.71 7.44238H14.1182C15.1025 7.44238 15.5879 6.95703 15.5879 5.94531V4.58496C15.5879 3.57324 15.1025 3.09473 14.1182 3.09473H12.71C11.7188 3.09473 11.2402 3.57324 11.2402 4.58496V5.94531C11.2402 6.95703 11.7188 7.44238 12.71 7.44238ZM1.88184 6.31445C1.64258 6.31445 1.52637 6.19824 1.52637 5.94531V4.57812C1.52637 4.33887 1.64258 4.21582 1.88184 4.21582H3.26953C3.50879 4.21582 3.625 4.33887 3.625 4.57812V5.94531C3.625 6.19824 3.50879 6.31445 3.26953 6.31445H1.88184ZM7.30273 6.31445C7.05664 6.31445 6.94727 6.19824 6.94727 5.94531V4.57812C6.94727 4.33887 7.05664 4.21582 7.30273 4.21582H8.69043C8.92969 4.21582 9.0459 4.33887 9.0459 4.57812V5.94531C9.0459 6.19824 8.92969 6.31445 8.69043 6.31445H7.30273ZM12.7168 6.31445C12.4775 6.31445 12.3613 6.19824 12.3613 5.94531V4.57812C12.3613 4.33887 12.4775 4.21582 12.7168 4.21582H14.1045C14.3438 4.21582 14.46 4.33887 14.46 4.57812V5.94531C14.46 6.19824 14.3438 6.31445 14.1045 6.31445H12.7168ZM0.952148 9.82812H15.041C15.3691 9.82812 15.5879 9.58887 15.5879 9.24023C15.5879 8.8916 15.3691 8.64551 15.041 8.64551H0.952148C0.624023 8.64551 0.405273 8.88477 0.405273 9.24023C0.405273 9.5957 0.624023 9.82812 0.952148 9.82812ZM1.88184 15.4404H3.29004C4.27441 15.4404 4.75977 14.9619 4.75977 13.9434V12.583C4.75977 11.5713 4.27441 11.0928 3.29004 11.0928H1.88184C0.897461 11.0928 0.412109 11.5713 0.412109 12.583V13.9434C0.412109 14.9619 0.897461 15.4404 1.88184 15.4404ZM7.2959 15.4404H8.7041C9.68848 15.4404 10.1738 14.9619 10.1738 13.9434V12.583C10.1738 11.5713 9.68848 11.0928 8.7041 11.0928H7.2959C6.31152 11.0928 5.82617 11.5713 5.82617 12.583V13.9434C5.82617 14.9619 6.31152 15.4404 7.2959 15.4404ZM12.7168 15.4404H14.1182C15.1094 15.4404 15.5879 14.9619 15.5879 13.9434V12.583C15.5879 11.5713 15.1094 11.0928 14.1182 11.0928H12.7168C11.7256 11.0928 11.2471 11.5713 11.2471 12.583V13.9434C11.2471 14.9619 11.7256 15.4404 12.7168 15.4404ZM1.88867 14.3125C1.64941 14.3125 1.5332 14.1963 1.5332 13.9502V12.583C1.5332 12.3369 1.64941 12.2139 1.88867 12.2139H3.27637C3.51562 12.2139 3.63184 12.3369 3.63184 12.583V13.9502C3.63184 14.1963 3.51562 14.3125 3.27637 14.3125H1.88867ZM7.30957 14.3125C7.06348 14.3125 6.9541 14.1963 6.9541 13.9502V12.583C6.9541 12.3369 7.06348 12.2139 7.30957 12.2139H8.69727C8.93652 12.2139 9.05273 12.3369 9.05273 12.583V13.9502C9.05273 14.1963 8.93652 14.3125 8.69727 14.3125H7.30957ZM12.7236 14.3125C12.4844 14.3125 12.3682 14.1963 12.3682 13.9502V12.583C12.3682 12.3369 12.4844 12.2139 12.7236 12.2139H14.1113C14.3506 12.2139 14.4668 12.3369 14.4668 12.583V13.9502C14.4668 14.1963 14.3506 14.3125 14.1113 14.3125H12.7236Z"})});var vi=o(13495),bi=o(90199),ji=o(62208);const wi=(0,v.IU)("nest",{viewBox:"0 0 16 16",svg:(0,b.jsxs)("g",{children:[(0,b.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,b.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,b.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,b.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})});var Mi=o(94110),_i=o(37888),ki=o(58188),Vi=o(72711),Ti=o(993);function Pi(e){const{style:t}=e,o=(0,f.Fg)(),n=(0,r.MO)(),i=(0,b.jsx)("div",{style:{marginTop:1},children:(0,bi.b)({width:14,marginRight:8,height:void 0})}),a=(0,b.jsx)(dt.Z,{style:{color:o.regularTextColor,lineHeight:F.Z.lineHeight.UISmall.desktop},isSmall:!0,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,b.jsx)(D,{icon:i,title:a,style:n?{backgroundColor:o.sidebarBackground,boxShadow:o.plainButtonBoxShadow,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,b.jsx)(dt.Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var Fi=o(57420),Zi=o(13148),Bi=o(59960),Ii=o(25888),Ai=o(12714),Ki=o(91851),Oi=o(94841),Di=o(73063),Ri=o(83182);const Li=(0,s.defineMessages)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});function Hi(e){const t=(0,r.MO)(),o=(0,f.yK)((e=>({homeIcon:{width:13,marginRight:8,...t?{width:16,marginRight:12}:{}},badgeTitle:{color:e.regularTextColor,lineHeight:F.Z.lineHeight.UISmall.desktop,fontWeight:F.Z.fontWeight.regular,fontSize:t?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop,marginRight:5},badgeStyle:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",padding:"12px 14px"}})),[t]),{collectionContextStore:n}=e,i=(0,Bi.w)(o.homeIcon),l=(0,a.VK)((()=>n.permissionScopes.state.canConfigureCollection),[n]),c=(0,b.jsx)(dt.Z,{style:o.badgeTitle,isSmall:!0,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"This is a task database",id:"CollectionTaskTypeBadge.title"})});return(0,b.jsx)(D,{icon:i,title:c,showCloseButton:!1,right:l?(0,b.jsx)(Ei,{collectionContextStore:n}):(0,b.jsx)(zi,{}),style:o.badgeStyle,children:(0,b.jsx)(dt.Z,{style:{marginLeft:t?28:22},isSmall:!0,isMultiline:!0,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"See your tasks in Home.",id:"CollectionTaskTypeBadge.description"})})})}function zi(){const e=(0,s.useIntl)(),t=(0,r.O7)();return(0,b.jsx)(Di.Z,{icon:_.m,ariaLabel:e.formatMessage(Li.learn),onClick:()=>{Ii.Fs(t,{from:"view_settings_task_type_badge"}),Ai.D({environment:t,url:Oi.su})}})}function Ei(e){const{collectionContextStore:t}=e,o=(0,r.O7)(),i=(0,r.MO)(),a=(0,s.useIntl)(),l=(0,f.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:24,width:24},threeDotIcon:{width:i?16:12,height:i?16:12,fill:e.mediumIconColor},hideButtonIcon:{height:17,width:17},confirmationModalTitle:{fontWeight:500},confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[i]),c=(0,n.useCallback)((()=>{p.createAndCommit({environment:o,userAction:"CollectionTaskTypeBadge.untypeDatabase",perform:e=>{Ki.RQ({environment:o,collectionContextStore:t,transaction:e})}})}),[o,t]),d=(0,b.jsx)("span",{style:l.confirmationModalDescription,children:(0,b.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})}),u=e=>[{key:"removeFromHome",render:e=>(0,b.jsx)(X.Z,{...e,icon:(0,Zi.U)(l.hideButtonIcon),title:(0,b.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.title",defaultMessage:"Undo task database"})}),action:()=>{const t=[{label:(0,b.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:c}];Z.showDialog({message:(0,b.jsx)("div",{style:{textAlign:"center"},children:(0,b.jsx)("span",{style:l.confirmationModalTitle,children:(0,b.jsx)(s.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})}),description:d,showCancel:!0,keepFocus:!0,items:t}),e.close()}}],g=(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(Ri.Z,{href:Oi.su,title:a.formatMessage(Li.learn),analyticsFrom:"view_settings_task_type_badge"})});return(0,b.jsx)(Y.ZP,{popupType:i?Y.Z4.SlideUp:Y.Z4.Popup,alignmentToOrigin:Y.vR.Center,originGap:2,renderOrigin:e=>(0,b.jsx)(O.Z,{style:l.buttonStyle,...e,children:(0,po.o)(l.threeDotIcon)}),render:e=>{const t=[{key:"all",render:e=>(0,b.jsx)(ne.Z,{...e}),items:u(e)}];return(0,b.jsxs)(J.Z,{menuType:i?so.og.ActionSheet:so.og.Popup,width:200,children:[(0,b.jsx)(ee.Z,{type:ee.i.Vertical,sections:t,initialFocus:void 0}),g]})}})}var Ui=o(74420),Ni=o(32662),Wi=o(28020),Gi=o(54802),qi=o(95697),$i=o(30806),Xi=o(5933),Yi=o(52489),Qi=o(7289);const Ji=(0,v.IU)("collectionChartStyle",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M1.8491 15.1243C1.28739 14.5494 1.00437 13.9414 1.00005 13.3001C0.995729 12.6589 1.27011 12.0552 1.82318 11.4892C2.0133 11.2946 2.25527 11.0978 2.54909 10.8988C2.84723 10.6998 3.15833 10.5052 3.4824 10.3151C3.80646 10.1205 4.11325 9.93474 4.40274 9.75785C4.69656 9.58095 4.93637 9.41512 5.12217 9.26034L3.76758 7.88057C3.49536 7.60197 3.35709 7.30567 3.35277 6.99169C3.35277 6.67328 3.48672 6.37698 3.75461 6.1028L4.60367 5.23381C4.87156 4.95963 5.1589 4.82475 5.46568 4.82917C5.77679 4.82917 6.06844 4.96847 6.34066 5.24708L11.4933 10.534C11.7698 10.8126 11.9081 11.1089 11.9081 11.4228C11.9124 11.7324 11.7828 12.0265 11.5192 12.3051L10.6637 13.1807C10.4001 13.4505 10.1128 13.5832 9.80169 13.5787C9.49058 13.5787 9.20109 13.4394 8.93319 13.1608L7.58507 11.7744C7.42952 11.9646 7.26533 12.2078 7.09249 12.5041C6.91966 12.8004 6.73818 13.1166 6.54806 13.4527C6.36226 13.7888 6.17215 14.1072 5.97771 14.4079C5.78759 14.7131 5.59531 14.9629 5.40087 15.1575C4.8478 15.7236 4.258 16.0044 3.63147 15.9999C3.00494 15.9955 2.41082 15.7037 1.8491 15.1243ZM4.79811 6.82585C4.64255 6.98063 4.64255 7.13762 4.79811 7.29683L6.36659 8.89549C6.50053 9.02816 6.56103 9.17852 6.54806 9.34657C6.5351 9.51462 6.45732 9.67603 6.31474 9.83081C6.18943 9.96348 5.97987 10.1161 5.68605 10.2885C5.39223 10.461 5.05952 10.6534 4.68792 10.8656C4.32065 11.0779 3.95553 11.3057 3.59258 11.5489C3.22963 11.7921 2.92068 12.0442 2.66575 12.3051C2.36761 12.6058 2.21854 12.9309 2.21854 13.2802C2.22286 13.6296 2.37625 13.9613 2.67871 14.2752C2.9855 14.5848 3.3074 14.7396 3.64443 14.7396C3.98578 14.744 4.30553 14.5937 4.60367 14.2885C4.86292 14.0276 5.10921 13.7114 5.34254 13.3399C5.58019 12.9684 5.80271 12.5948 6.01011 12.2189C6.21752 11.8385 6.40547 11.5002 6.57399 11.2039C6.74682 10.9032 6.89589 10.6887 7.0212 10.5605C7.17243 10.4101 7.33014 10.3305 7.49434 10.3217C7.65853 10.3084 7.8076 10.3703 7.94155 10.5074L9.49707 12.1061C9.65262 12.2697 9.80601 12.2675 9.95724 12.0995L10.4498 11.5953C10.6011 11.4361 10.6032 11.2791 10.4563 11.1243L5.75086 6.31507C5.68173 6.23989 5.60827 6.20451 5.5305 6.20894C5.45272 6.20894 5.3771 6.24652 5.30365 6.3217L4.79811 6.82585ZM3.62499 14.1094C3.41326 14.1094 3.23179 14.032 3.08055 13.8772C2.92932 13.7225 2.85371 13.5367 2.85371 13.32C2.85371 13.1033 2.92932 12.9176 3.08055 12.7628C3.23179 12.608 3.41326 12.5306 3.62499 12.5306C3.83671 12.5306 4.01819 12.608 4.16942 12.7628C4.32065 12.9176 4.39626 13.1033 4.39626 13.32C4.39626 13.5367 4.32065 13.7225 4.16942 13.8772C4.01819 14.032 3.83671 14.1094 3.62499 14.1094ZM11.3183 11.3233L10.4757 10.4676L13.5284 7.34326C13.6494 7.21944 13.7099 7.08234 13.7099 6.93198C13.7099 6.78163 13.643 6.6379 13.509 6.50081L8.69338 1.57877C8.62857 1.51243 8.56159 1.47705 8.49246 1.47263C8.42765 1.46821 8.36715 1.49032 8.31098 1.53897C8.25913 1.58319 8.22024 1.65616 8.19432 1.75787C8.03877 2.34162 7.90698 2.84134 7.79896 3.25704C7.69094 3.67274 7.57859 4.04642 7.46193 4.3781C7.34527 4.70977 7.1962 5.03702 7.01472 5.35985C6.83756 5.67826 6.59775 6.03646 6.29529 6.43447L5.43976 5.55885C5.64284 5.26698 5.80919 5.01491 5.93882 4.80264C6.07277 4.58594 6.18511 4.37367 6.27585 4.16582C6.36659 3.95355 6.44868 3.71696 6.52214 3.45604C6.59991 3.1907 6.68201 2.8723 6.76843 2.50082C6.85485 2.12492 6.96071 1.66058 7.08601 1.10779C7.15083 0.82034 7.26749 0.588168 7.436 0.411276C7.60452 0.229961 7.79896 0.108347 8.01932 0.0464343C8.24401 -0.0154781 8.47086 -0.0154781 8.69986 0.0464343C8.92887 0.103924 9.13627 0.225538 9.32207 0.411276L14.4164 5.63182C14.8009 6.02983 14.9954 6.44774 14.9997 6.88555C15.0084 7.32336 14.8247 7.73464 14.4488 8.11938L11.3183 11.3233ZM10.2748 7.4494C10.197 7.37422 10.2035 7.29019 10.2943 7.19732C10.6572 6.82585 10.9726 6.419 11.2405 5.97676C11.5128 5.53453 11.6791 5.01933 11.7396 4.43116L13.1655 5.88389C13.0013 6.09617 12.7766 6.31286 12.4914 6.53398C12.2063 6.75067 11.9081 6.94525 11.597 7.11772C11.2902 7.28577 11.0137 7.40517 10.7674 7.47593C10.5254 7.54669 10.3612 7.53784 10.2748 7.4494Z"})}),er=(0,v.IU)("collectionChartDonutSelected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{d:"M12.75 3.03079C17.1223 3.39148 20.6085 6.87768 20.9692 11.25H18.4069C18.0637 8.28709 15.7129 5.93628 12.75 5.59314V3.03079Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),tr=(0,v.IU)("collectionChartDonutUnselected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),or=(0,v.IU)("collectionChartHorizontalBarSelected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{d:"M20.25 20H4.75V18H20.25V20Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),nr=(0,v.IU)("collectionChartHorizontalBarUnselected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),ir=(0,v.IU)("collectionChartLineSelected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02037 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),rr=(0,v.IU)("collectionChartLineUnselected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02038 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),ar=(0,v.IU)("collectionChartVerticalBarSelected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{d:"M18.75 20.25V4.75H21.25V20.25H18.75Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),sr=(0,v.IU)("collectionChartVerticalBarUnselected",{viewBox:"0 0 24 24",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})});function lr(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,s.useIntl)(),l=(0,ut.Y$)(),c=(0,a.VK)((()=>l.collectionViewStore()),[l]),d=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),u=(0,a.VK)((()=>{if(!t)return;const e=t.type;if("placeholder"===e)throw new Error("Should not happen");return e}),[t]),g=(0,n.useCallback)((e=>{c&&t&&"placeholder"!==t.type&&p.createAndCommit({userAction:"chartSettings.setChartType",environment:o,perform:o=>{const n=Mt.Xh(t);if(e&&(n.type=e),"column"!==e&&"line"!==e||!n.axisConfig){if("donut"===e){const e=(0,yn.kT)({collectionSchema:d}),t=e?(0,yn.fI)({property:e,collectionSchema:d}):void 0;n.donutConfig=t?{dataConfig:{groupBy:t,aggregation:(0,Qi.kR)({})},...n.donutConfig}:void 0}}else{const t=(0,yn._z)(n.axisConfig);t&&(n.axisConfig.dataConfig.yAxis=[{...t,seriesFormat:{displayType:e}}])}io.sW({store:c.getFormatStore().getKeyStore("chart_config"),data:{...n},transaction:o})}})}),[o,c,t,d]),m={column:{supported:!0,unselected:sr,selected:ar},bar:{supported:!1,unselected:nr,selected:or},line:{supported:!0,unselected:rr,selected:ir},donut:{supported:!0,unselected:tr,selected:er}},S=(0,f.yK)((e=>({button:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:4,margin:6,padding:6,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,position:"relative",width:42,height:42},selectedButton:{boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:24,height:24,position:"absolute",top:10}})),[]);return(0,b.jsx)("div",{style:{display:"flex",marginLeft:10,marginRight:10},children:yn.Ri.map((e=>{const o=m[e].supported;return(0,b.jsx)(O.Z,{style:{...S.button,...e===u&&S.selectedButton},onClick:()=>{g(e)},disabled:!t||!o,ariaLabel:i.formatMessage(Mn.NV[e]),children:e===u?m[e].selected(S.icon):m[e].unselected(S.icon)},e)}))})}var cr=o(2032),dr=o(22771);const ur=(0,v.IU)("pieChartSliceBy",{viewBox:"0 0 16 16",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 3.39946C3.95441 3.95981 2.25 6.0316 2.25 8.5C2.25 10.2655 3.12025 11.8278 4.46076 12.7815C5.31822 13.3915 6.36539 13.75 7.5 13.75C8.14111 13.75 8.75268 13.6357 9.3173 13.4273C10.9405 12.8284 12.1854 11.4498 12.6005 9.75H8.25C7.14543 9.75 6.25 8.85457 6.25 7.75V3.39946ZM1 8.5C1 5.16337 3.51407 2.41394 6.75126 2.04265C7.16277 1.99546 7.5 2.33578 7.5 2.75V7.75C7.5 8.16421 7.83579 8.5 8.25 8.5H13.25C13.6642 8.5 14.0046 8.837 13.9574 9.24852C13.6742 11.7184 12.0066 13.7674 9.75 14.6C9.0489 14.8587 8.29095 15 7.5 15C6.09723 15 4.79824 14.5556 3.73613 13.8C2.08017 12.6219 1 10.6871 1 8.5Z",fill:"#32302C"}),(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.75 2.39949V6.25H13.6005C13.1378 4.35519 11.6448 2.86215 9.75 2.39949ZM14.9573 6.75126C15.0045 7.16277 14.6642 7.5 14.25 7.5H9.25C8.83579 7.5 8.5 7.16421 8.5 6.75V1.75C8.5 1.33578 8.83723 0.995456 9.24874 1.04265C12.2403 1.38576 14.6142 3.75975 14.9573 6.75126Z",fill:"#32302C"})]})}),pr=(0,v.IU)("pieChartSliceRepresents",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M11.9102 12.8223L7.6377 8.65234C7.56934 8.58854 7.52148 8.52246 7.49414 8.4541C7.4668 8.38574 7.45312 8.30371 7.45312 8.20801V2.08301H8.54688V7.36719L13.0312 4.79688L13.585 5.74707L8.99121 8.37207L12.7373 12.0566L11.9102 12.8223ZM7.99316 15.126C7.02702 15.126 6.11784 14.9414 5.26562 14.5723C4.41341 14.2077 3.66146 13.6995 3.00977 13.0479C2.36263 12.3962 1.85449 11.6442 1.48535 10.792C1.11621 9.93978 0.931641 9.0306 0.931641 8.06445C0.931641 7.09831 1.11621 6.18913 1.48535 5.33691C1.85449 4.4847 2.36263 3.73503 3.00977 3.08789C3.66146 2.4362 4.41113 1.92578 5.25879 1.55664C6.111 1.1875 7.02018 1.00293 7.98633 1.00293C8.95703 1.00293 9.86849 1.1875 10.7207 1.55664C11.5729 1.92578 12.3249 2.4362 12.9766 3.08789C13.6283 3.73503 14.1387 4.4847 14.5078 5.33691C14.877 6.18913 15.0615 7.09831 15.0615 8.06445C15.0615 9.0306 14.877 9.93978 14.5078 10.792C14.1387 11.6442 13.6283 12.3962 12.9766 13.0479C12.3249 13.6995 11.5729 14.2077 10.7207 14.5723C9.86849 14.9414 8.95931 15.126 7.99316 15.126ZM7.99316 13.7314C8.78158 13.7314 9.51758 13.5856 10.2012 13.2939C10.8848 13.0023 11.4863 12.5967 12.0059 12.0771C12.5254 11.5576 12.931 10.9561 13.2227 10.2725C13.5143 9.58887 13.6602 8.85286 13.6602 8.06445C13.6602 7.2806 13.5143 6.54688 13.2227 5.86328C12.931 5.17513 12.5254 4.57129 12.0059 4.05176C11.4863 3.53223 10.8825 3.12663 10.1943 2.83496C9.51074 2.54329 8.77474 2.39746 7.98633 2.39746C7.20247 2.39746 6.46647 2.54329 5.77832 2.83496C5.09473 3.12663 4.49544 3.53223 3.98047 4.05176C3.46549 4.57129 3.06217 5.17513 2.77051 5.86328C2.47884 6.54688 2.33301 7.2806 2.33301 8.06445C2.33301 8.85286 2.47884 9.58887 2.77051 10.2725C3.06217 10.9561 3.46549 11.5576 3.98047 12.0771C4.5 12.5967 5.10156 13.0023 5.78516 13.2939C6.47331 13.5856 7.20931 13.7314 7.99316 13.7314Z",fill:"#32302C"})});function gr(e){let{title:t,icon:o,aggregationOptions:n,selectedAggregation:i,onChange:r,disabled:l}=e;const c=(0,s.useIntl)(),d=(0,ut.Y$)(),u=(0,a.VK)((()=>d.databaseType),[d]);if(!i||(0,cr.HK)(i)||"unique"===i.aggregator)return null;const p=n.map((e=>{if((0,cr.HK)(e))return;return{key:e,title:(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:(0,Mn.Hk)({aggregation:e,databaseType:u,intl:c})})}})).filter(N.$K);return(0,b.jsx)(ht.Z,{title:t,icon:o,disabled:l,collectionContextStore:d,selectedKey:i,options:p,onChange:e=>{e&&r(e)}})}var mr=o(14714);const Sr=(0,v.IU)("collectionHorizontalSegments",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M8.15967 2.38428L8.15967 13.6362L6.84033 13.6362L6.84033 2.38428L8.15967 2.38428ZM11.6392 1.61865C12.3774 1.61865 12.9357 1.8055 13.314 2.1792C13.6922 2.55745 13.8813 3.11117 13.8813 3.84033L13.8813 12.1597C13.8813 12.8934 13.6922 13.4471 13.314 13.8208C12.9357 14.1945 12.3774 14.3813 11.6392 14.3813L3.36084 14.3813C2.62256 14.3813 2.06429 14.1945 1.68603 13.8208C1.30778 13.4471 1.11865 12.8934 1.11865 12.1597L1.11865 3.84033C1.11865 3.11116 1.30778 2.55745 1.68604 2.1792C2.06429 1.8055 2.62256 1.61865 3.36084 1.61865L11.6392 1.61865ZM11.5571 2.96533L3.44287 2.96533C3.12842 2.96533 2.88688 3.04736 2.71826 3.21143C2.54964 3.37549 2.46533 3.62386 2.46533 3.95654L2.46533 12.0503C2.46533 12.3784 2.54964 12.6245 2.71826 12.7886C2.88688 12.9526 3.12842 13.0347 3.44287 13.0347L11.5571 13.0347C11.8761 13.0347 12.1177 12.9526 12.2817 12.7886C12.4504 12.6245 12.5347 12.3784 12.5347 12.0503L12.5347 3.95654C12.5347 3.62386 12.4504 3.37549 12.2817 3.21143C12.1177 3.04736 11.8761 2.96533 11.5571 2.96533Z"})});var fr=o(77498),yr=o(35011),xr=o(54569),hr=o(38769),Cr=o(75498),vr=o(79131),br=o(5145),jr=o(28992),wr=o(97820),Mr=o(92918),_r=o(18514),kr=o(73590);const Vr=Si.default.createClass(void 0),Tr=Si.default.createClass(Mr.XD);function Pr(e){return e?(0,b.jsx)(wr.Z,{propertySchema:e,showIcon:!1}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function Fr(e,t){return"collection_group_by"===e&&"board"===t?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function Zr(e,t){return"manual"===t?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Manual",id:"database.viewSettings.groupTab.sortType.manual"}):"ascending"===t?(0,mr.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Oldest first",id:"database.viewSettings.groupTab.sortType.chronological"}):(0,mr.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.viewSettings.groupTab.sortType.alphabetical"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Ascending",id:"database.viewSettings.groupTab.sortType.ascending"}):"descending"===t?(0,mr.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Newest first",id:"database.viewSettings.groupTab.sortType.reverseChronological"}):(0,mr.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.groupTab.sortType.reverseAlphabetical"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Descending",id:"database.viewSettings.groupTab.sortType.descending"}):void(0,N.t1)(t)}function Br(e){const{groupBy:t,schema:o}=e,n=o[t.property];if(!n||!(0,mr.LG)(n))return;let i;if("formula"===n.type){const e=(0,yr.mm)(n);if("unknown"===e||"array"===e)return;i="block"===e?"relation":e}else i=n.type;return(0,mr.A1)(i)||(0,mr.HB)(i)||"number"===i||"status"===i?i:void 0}function Ir(e){const t=Br(e);if(t)return(0,mr.A1)(t)?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,mr.HB)(t)?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function Ar(e){return(0,mr.ib)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function Kr(e){return(0,mr.aB)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function Or(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function Dr(e){const{groupBy:t}=e,o=Br(e);if(o)if((0,mr.A1)(o)){const e=Ar(t);if(e)return Er(e.groupBy)}else if((0,mr.HB)(o)){const e=Kr(t);if(e)return Ur(e.groupBy)}else if("number"===o){const e=Or(t);if(e)return(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const Rr=(0,s.defineMessages)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}}),Lr=(0,s.defineMessages)({group:{defaultMessage:"group",id:"database.groupMenu.statusGroupBy.lowerCaseGroup"},option:{defaultMessage:"option",id:"database.groupMenu.statusGroupBy.lowerCaseOption"}});function Hr(e,t){return"group"===e?t?(0,b.jsx)(s.FormattedMessage,{...Lr.group}):(0,b.jsx)(s.FormattedMessage,{...Rr.group}):"option"===e?t?(0,b.jsx)(s.FormattedMessage,{...Lr.option}):(0,b.jsx)(s.FormattedMessage,{...Rr.option}):void(0,N.t1)(e)}const zr=(0,s.defineMessages)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}});function Er(e){return"relative"===e?(0,b.jsx)(s.FormattedMessage,{...zr.relative}):"day"===e?(0,b.jsx)(s.FormattedMessage,{...zr.day}):"week"===e?(0,b.jsx)(s.FormattedMessage,{...zr.week}):"month"===e?(0,b.jsx)(s.FormattedMessage,{...zr.month}):"year"===e?(0,b.jsx)(s.FormattedMessage,{...zr.year}):void(0,N.t1)(e)}function Ur(e){return"exact"===e?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,N.t1)(e)}const Nr=function(e){const{collectionContextStore:t,groupsFormatKey:o,groupByKey:n,collectionSettingsStore:i}=e,l=(0,r.O7)(),c=(0,a.qz)(void 0,Tr),d=(0,a.qz)(void 0,Vr),g=(0,a.VK)((()=>{var e;const i=t.normalizedFormatStore.state,r=t.normalizedSchemaStore.state,a=t.collectionViewBlockStore(),s=Gr(t,n),l=d.state;if(!s||!a||!l)return;const u=c.state,p=(0,mr.Qq)({schema:r,groupBy:s}),g=l.results,m=l?l.total:0,S=(0,Mr.Cz)({groupBy:s,schema:r,formatGroups:i[o]||[],schemaGroups:p,reducerResults:g,getRecordModel:a.getRecordModel,relativeVariableResult:t.relativeVariableStore.state,viewAppConfigUri:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri,allowedCollectionStores:t.collectionStoresStore.state}),f=S.filter((e=>!(0,mr.eF)(e))).slice(0,u),y=S.filter((e=>(0,mr.eF)(e)));return{currentGroups:[...f,...y],visibleGroups:f,hiddenGroups:y,total:m}}),[o,t,n,d,c]),m=(0,a.VK)((()=>Gr(t,n)),[t,n]),S=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),f=(0,a.VK)((()=>function(e,t){return qr(e)&&(0,Mr._1)({viewType:Wr(e),groupByKey:t})}(t,n)),[t,n]);return(0,b.jsxs)(I.ZP,{collectionSettingsStore:i,title:(0,b.jsx)($r,{collectionSettingsStore:i,collectionContextStore:t}),children:[(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(Xr,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:n,groupsFormatKey:o,groupBy:m}),m&&Br({groupBy:m,schema:S})&&(0,b.jsx)(Qr,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:n,groupsFormatKey:o,groupBy:m}),m&&(0,b.jsx)(Jr,{collectionContextStore:t,groupByKey:n,groupBy:m}),m&&(0,b.jsx)(ea,{groupByKey:n,collectionContextStore:t,groupsFormatKey:o,groupsDisplayState:g,groupBy:m}),m&&"board_columns_by"===n&&(0,b.jsx)(Yr,{collectionContextStore:t})]}),m&&(0,b.jsx)(ia,{groupsFormatKey:o,collectionContextStore:t,groupByKey:n,reducerResultStore:d,groupsLimitStore:c,groupsDisplayState:g}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[m&&f&&(0,b.jsx)(A.Z,{isGray:!0,icon:P.y,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();if(!i)return;p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,perform:e=>{u.FH({stores:[i],update:{[o]:void 0,[n]:void 0},transaction:e})}}),no.wd({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(l,t,n,o),isRed:!0}),(0,b.jsx)(kr.Z,{href:(0,_r.UY)("guides.databaseGroup"),title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})};function Wr(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function Gr(e,t){return e.normalizedFormatStore.state[t]}function qr(e){return e.permissionScopes.state.canConfigureBlock}function $r(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>(0,Ye.n)(t)),[t]),i=(0,a.VK)((()=>Wr(o)),[o]);return n&&"group"===n.type?"collection_group_by"===n.groupByKey&&"board"===i?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function Xr(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:n,groupByKey:i,groupsFormatKey:s}=e;const l=(0,r.O7)(),c=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),u=t?c[t.property]:void 0,p=(0,a.VK)((()=>qr(o)),[o]),g=(0,a.VK)((()=>Wr(o)),[o]);return(0,b.jsx)(A.Z,{title:Fr(i,g),showChevron:!0,right:Pr(u),onClick:()=>{no.wd({environment:l,collectionContextStore:o,action:"click_group_by_property",original_view_type:void 0,property_type:null==u?void 0:u.type}),d.H4({collectionSettingsStore:n,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:s}})},disabled:!p})}function Yr(e){let{collectionContextStore:t}=e;const o=(0,r.O7)(),n=(0,a.VK)((()=>(0,Mr.h6)(t.normalizedFormatStore.state)),[t]),i=(0,a.VK)((()=>qr(t)),[t]);return(0,b.jsx)(ie.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!n,focused:!1,onClick:()=>{d.iN({environment:o,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function Qr(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:n,groupByKey:i,groupsFormatKey:s}=e;const l=(0,r.O7)(),c=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),g=(0,a.VK)((()=>qr(o)),[o]),m="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,mr.ib)(m)?(0,b.jsx)(ht.Z,{title:Ir({groupBy:m,schema:c}),popupStyle:{minWidth:190},selectedKey:m.groupBy,options:mr.z8.map((e=>({key:e,title:Er(e)}))),onChange:e=>function(e,t,o,n,i){const r=Gr(o,n),a=o.collectionViewStore();if(!r||!a)return;const s=Ar(r);if(s){if((0,mr.ib)(r))p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:t=>{u.FH({stores:[a],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===r.type){const o={...Mt.CE(s,"property"),type:"date",groupBy:e},l={...r,groupBy:o};p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:e=>{u.FH({stores:[a],update:{[n]:l,[i]:void 0},transaction:e})}})}no.wd({environment:t,collectionContextStore:o,action:"update_date_group_by"})}}(e,l,o,i,s),disabled:!g}):(0,mr.aB)(m)?(0,b.jsx)(ht.Z,{title:Ir({groupBy:m,schema:c}),popupStyle:{minWidth:190},selectedKey:m.groupBy,options:mr.Kp.map((e=>({key:e,title:Ur(e)}))),onChange:e=>function(e,t,o,n,i){const r=Gr(o,n),a=o.collectionViewStore();if(!r||!a)return;const s=Kr(r);if(s){if((0,mr.aB)(r))p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:t=>{u.FH({stores:[a],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===r.type){const o={...Mt.CE(s,"property"),groupBy:e},l={...r,groupBy:o};p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:e=>{u.FH({stores:[a],update:{[n]:l,[i]:void 0},transaction:e})}})}no.wd({environment:t,collectionContextStore:o,action:"update_text_group_by"})}}(e,l,o,i,s),disabled:!g}):"number"===m.type?(0,b.jsx)(A.Z,{title:Ir({groupBy:m,schema:c}),showChevron:!0,right:Dr({groupBy:m,schema:c}),onClick:()=>{d.H4({collectionSettingsStore:n,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:s}})},disabled:!g}):"status"===m.type?(0,b.jsx)(ht.Z,{title:Ir({groupBy:m,schema:c}),popupStyle:{minWidth:190},selectedKey:m.groupBy,options:mr.vu.map((e=>({key:e,title:Hr(e)}))),onChange:e=>function(e,t,o,n,i){const r=Gr(o,n),a=o.collectionViewStore();r&&a&&"status"===(null==r?void 0:r.type)&&(p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,perform:t=>{u.FH({stores:[a],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}}),no.wd({environment:t,collectionContextStore:o,action:"update_status_group_by"}))}(e,l,o,i,s),disabled:!g}):null}function Jr(e){let{groupBy:t,collectionContextStore:o,groupByKey:n}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>(0,mr.YG)(t)),[t]),c=(0,a.VK)((()=>qr(o)),[o]);if(l.length<=1)return null;const d=(0,mr.mu)(t);return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:d.type,options:l.map((e=>({key:e,title:Zr(t,e)}))),onChange:e=>function(e,t,o,n){const i=Gr(o,n),r=o.collectionViewStore();if(i&&r){if("formula"===i.type){const o={...i,groupBy:{...i.groupBy,sort:{type:e}}};p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:e=>{u.FH({stores:[r],update:{[n]:o},transaction:e})}})}else p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:t=>{u.FH({stores:[r],update:{[n]:{...i,sort:{type:e}}},transaction:t})}});no.wd({environment:t,collectionContextStore:o,action:"update_group_sort"})}}(e,i,o,n),disabled:!c})}function ea(e){let{groupBy:t,groupByKey:o,collectionContextStore:i,groupsFormatKey:l,groupsDisplayState:c}=e;const d=(0,r.O7)(),g=(0,n.useCallback)((()=>function(e,t,o,n,i){const r=Gr(o,t);if(!i)return;const{currentGroups:a}=i,s=o.collectionViewStore();if(!r||!s)return;const l=!r.hideEmptyGroups;p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,perform:e=>{if(l){const t=a.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));xr.A6({collectionContextStore:o,newGroups:t,groupsFormatKey:n,transaction:e})}u.FH({stores:[s],update:{[t]:{...r,hideEmptyGroups:l}},transaction:e})}}),no.wd({environment:e,collectionContextStore:o,action:"toggle_hide_empty_groups"})}(d,o,i,l,c)),[d,o,i,l,c]),m=(0,a.VK)((()=>qr(i)),[i]);return(0,b.jsx)(ie.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(t.hideEmptyGroups),focused:!1,onClick:g,disabled:!m,textWrapperStyle:{opacity:1}})}function ta(e){const t=(0,r.O7)(),{groupFormat:o,canReorder:n,collectionContextStore:i,groupByKey:s,groupsFormatKey:l,groupsDisplayState:c}=e,d=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),u=(0,mr.eF)(o),g=(0,a.VK)((()=>Gr(i,s)),[i,s]),m=(0,a.VK)((()=>qr(i)),[i]);return g?(0,b.jsx)(jr.Z,{disabled:!m,title:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[n&&(0,b.jsx)(br.ZP,{iconSize:12,style:{marginRight:3}}),(0,b.jsx)(hr.Z,{groupBy:g,groupFormat:o,currentGroups:(null==c?void 0:c.currentGroups)??[],schema:d,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:i})]}),right:(0,b.jsx)(Di.Z,{icon:u?ot.B:tt.c,iconStyle:{width:16,height:16},isDarkIconColor:!u,onClick:()=>{!function(e,t,o,n,i){if(!i)return;const{currentGroups:r}=i,a=r.map((t=>(0,mr.ZH)(t,e)?{...e,hidden:!(0,mr.eF)(e)}:t));p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:t,perform:e=>{xr.A6({collectionContextStore:o,newGroups:a,groupsFormatKey:n,transaction:e})}}),no.wd({environment:t,collectionContextStore:o,action:"toggle_group_visibility"})}(o,t,i,l,c)},disabled:!m}),textWrapperStyle:{opacity:1}}):null}function oa(e){const t=(0,r.O7)(),{groups:o,canReorder:i,isHidden:s,collectionContextStore:l,groupByKey:d,groupsFormatKey:u,groupsDisplayState:g}=e,m=(0,a.VK)((()=>qr(l)),[l]);return i?(0,b.jsx)(vr.ZP,{direction:"vertical",keys:o.map((e=>(0,mr.mD)(e))),renderKey:(e,t)=>{const n=o[t];return(0,b.jsx)(ta,{collectionContextStore:l,groupByKey:d,groupsFormatKey:u,groupsDisplayState:g,groupFormat:n,canReorder:i})},onDrop:e=>{!function(e,t,o,n,i,r){if(!r)return;const{currentGroups:a}=r,s=a.filter((t=>e.indexOf((0,mr.mD)(t))<0)),l=a.filter((t=>e.indexOf((0,mr.mD)(t))>=0)),d=Mt.MR(l,(t=>{const o=e.indexOf((0,mr.mD)(t));return o>=0?o:1/0})),u=t?[...s,...d]:[...d,...s];p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleGroupReorder",environment:o,perform:e=>{xr.A6({collectionContextStore:n,newGroups:u,groupsFormatKey:i,transaction:e})}}),c.wd(o,{view_type:Wr(n),action:t?"reorder_hidden_groups":"reorder_groups"})}(e,s,t,l,u,g)},disabled:!m}):(0,b.jsx)(b.Fragment,{children:o.map((e=>(0,b.jsx)(n.Fragment,{children:(0,b.jsx)(ta,{collectionContextStore:l,groupByKey:d,groupsFormatKey:u,groupsDisplayState:g,groupFormat:e,canReorder:i})},(0,mr.mD)(e))))})}function na(e){let{collectionContextStore:t,groupsFormatKey:o,groupByKey:i,groupsLimitStore:l,groupsDisplayState:c}=e;const d=(0,f.Fg)(),u=(0,r.O7)(),g=(0,n.useCallback)((()=>function(e,t,o,n,i){if(!i)return;const{currentGroups:r}=i,a=r.map((e=>({...e,hidden:!1})));n.setState(Mr.XD),p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:e,perform:e=>{xr.A6({collectionContextStore:t,newGroups:a,groupsFormatKey:o,transaction:e})}}),no.wd({environment:e,collectionContextStore:t,action:"click_groups_show_all"})}(u,t,o,l,c)),[u,t,o,l,c]),m=(0,n.useCallback)((()=>function(e,t,o,n,i){if(!i)return;const{currentGroups:r}=i,a=r.map((e=>({...e,hidden:!0})));n.setState(Mr.XD),p.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:e,perform:e=>{xr.A6({collectionContextStore:t,newGroups:a,groupsFormatKey:o,transaction:e})}}),no.wd({environment:e,collectionContextStore:t,action:"click_groups_hide_all"})}(u,t,o,l,c)),[u,t,o,l,c]),S=(0,a.VK)((()=>Gr(t,i)),[t,i]),y=S?(0,mr.mu)(S):void 0,x=(0,a.VK)((()=>qr(t)),[t]),h=(0,a.VK)((()=>"manual"===(null==y?void 0:y.type)&&!u.device.isMobile&&x),[x,y,u]),C=(0,a.VK)((()=>l.state),[l]);if(!S)return null;if(!c)return(0,b.jsx)(ne.Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,b.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,b.jsx)(Le.Z,{})})});const{total:v,hiddenGroups:j,visibleGroups:w}=c,M=Math.min(Mr.kW,v-j.length-w.length),_=M>0?(0,b.jsx)(X.Z,{disabled:!1,focused:!1,style:{color:d.mediumTextColor},icon:(0,po.o)({width:14,height:14}),title:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:M}}),onClick:()=>{t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),l.setState(C+Mr.kW)}}):void 0;return(0,b.jsxs)(b.Fragment,{children:[w.length>0&&(0,b.jsxs)(ne.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,b.jsx)("span",{style:{alignSelf:"center"},children:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:m,disabled:!x,children:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[(0,b.jsx)(oa,{collectionContextStore:t,groupByKey:i,groupsFormatKey:o,groupsDisplayState:c,groups:w,canReorder:h,isHidden:!1}),_]}),j.length>0&&(0,b.jsx)(ne.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:g,disabled:!x,children:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:(0,b.jsx)(oa,{collectionContextStore:t,groupByKey:i,groupsFormatKey:o,groupsDisplayState:c,groups:j,canReorder:h,isHidden:!0})})]})}function ia(e){let{groupsFormatKey:t,collectionContextStore:o,groupByKey:n,reducerResultStore:i,groupsLimitStore:r,groupsDisplayState:s}=e;const l=(0,a.VK)((()=>{const e=o.normalizedFormatStore.state,i=o.normalizedSchemaStore.state,a=o.remoteRequestStore.state,s=Gr(o,n);if(s)return(0,Mr.ej)({groupBy:s,schema:i,format:e,filter:null==a?void 0:a.loader.filter,groupsFormatKey:t,limit:r.state})}),[o,t,n,r]);return l?(0,b.jsx)(Cr.Z,{id:`group_menu_${t}`,reducer:l,collectionContextStore:o,resultStore:i,render:()=>(0,b.jsx)(na,{collectionContextStore:o,groupsFormatKey:t,groupByKey:n,groupsLimitStore:r,groupsDisplayState:s})}):(0,b.jsx)(na,{collectionContextStore:o,groupsFormatKey:t,groupByKey:n,groupsLimitStore:r,groupsDisplayState:s})}function ra(e){const{title:t,icon:o,iconStyle:n,selectedProperty:i,handlePropertySelect:s,isPropertyValid:l,disabled:c,...d}=e,u=(0,ut.Y$)(),p=(0,r.Fy)(),g=(0,a.qz)(void 0,xt.Z),m=(0,a.Kw)(g),S=(0,a.VK)((()=>u.normalizedSchemaStore.state),[u]),f=i?S[i]:void 0;return(0,b.jsx)(Y.ZP,{buttonPopupStore:g,popupType:p.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,renderOrigin:e=>(0,b.jsx)(A.Z,{title:t,icon:o,iconStyle:n,showChevron:!0,right:null==f?void 0:f.name,rotateChevron:m.open,disabled:c,...(0,On.Z)(e,d)}),render:e=>(0,b.jsx)(fr.Z,{isRelationProperty:!1,schema:S,onAccept:e=>s(e),onClose:e.close,allowProperty:l,selectedProperty:i}),disabled:c})}function aa(e){let{groupBy:t,propertySchema:o,onChange:i,disabled:r}=e;const l=(0,ut.Y$)(),c=(0,a.VK)((()=>l.settingsStore),[l]),u=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),p=(0,a.VK)((()=>(0,yn.PL)(t)),[t]),g=(0,n.useMemo)((()=>Ir({groupBy:t,schema:u})),[u,t]),m=null==o?void 0:o.type;return m&&o?(0,mr.A1)(m)&&(0,yn.h_)(p)?(0,b.jsx)(ht.Z,{title:g,popupStyle:{minWidth:190},selectedKey:p,options:mr.z8.map((e=>({key:e,title:Er(e)}))),icon:Sr,onChange:i,disabled:r}):(0,mr.H1)(m)&&(0,yn.QJ)(p)?(0,b.jsx)(ht.Z,{title:g,popupStyle:{minWidth:190},selectedKey:p,options:mr.vu.map((e=>({key:e,title:Hr(e)}))),icon:Sr,onChange:i,disabled:r}):"number"===t.type?(0,b.jsx)(A.Z,{disabled:!0,icon:Sr,title:g,showChevron:!0,right:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartXAxisGroupByUnique}),onClick:()=>{d.H4({collectionSettingsStore:c,item:{type:"groupByNumber",groupByKey:"collection_group_by",groupsFormatKey:mr.Uh}})}}):null:null}var sa=o(80951),la=o(12396),ca=o(96451),da=o(96525),ua=o(40721);const pa=10,ga="default",ma="aggregate",Sa="distinct",fa={y_axis_property:[ga,ma,Sa],donut_slice_property:[ga,ma,Sa],y_axis_groups:[ga]};function ya(e){return"none"===e.type||"record_count"===e.type?e.type:e.groupByOption?`${e.property}-${e.groupByOption}`:e.property}function xa(e){const{collectionContextStore:t,selectedProperty:o,properties:i,callsite:l}=e,c=(0,r.O7)(),d=(0,r.Fy)(),u=(0,s.useIntl)(),[p,g]=n.useState(""),m=(0,a.qz)(void 0,xt.Z),S=(0,a.Kw)(m),y=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),x=(0,a.VK)((()=>i.length>pa),[i.length]),h=(0,a.VK)((()=>{const e=Mt.vM(i,(e=>e.sectionName));return fa[l].map((t=>{const o=e[t]??[];return[...o.filter((e=>"none"===e.key.type)),...o.filter((e=>"none"!==e.key.type)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))]}))}),[i,l]),C=(0,a.VK)((()=>{if(p.length>0){return h.map((e=>co().filter(p,e,{extract:e=>e.name}).map((e=>{let{original:t}=e;return t}))))}return h}),[p,h]),v=(0,f.yK)((e=>({propertyIcon:{theme:e,fill:e.regularIconColor}})),[]);function j(){if(!o)return(0,b.jsx)(s.FormattedMessage,{...Mn.s8.none});const e=i.find((e=>ya(e.key)===ya(o)));if((null==e?void 0:e.sectionName)===Sa){const t=u.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.right",defaultMessage:"Distinct {propertyName}"},{propertyName:null==e?void 0:e.name});return(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:t})}return(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:null==e?void 0:e.name})}return(0,b.jsx)(da.Z,{focused:!1,buttonPopupStore:m,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,popupType:d.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,onClose:()=>{g((()=>""))},renderOrigin:t=>(0,b.jsx)(A.Z,{...t,showChevron:!0,rotateChevron:S.open,icon:e.originProps.icon,title:e.originProps.title,right:j()}),render:t=>{const n=c.device.isMobile?{menuType:so.og.Modal,right:(0,b.jsx)(ua.DoneMenuText,{}),onClickRight:t.close}:{menuType:so.og.Popup,width:250,maxHeight:400},i=[];if(x){const e={key:"search",items:[{key:"search-item",render:(e,t)=>(0,b.jsx)(mo.ZP,{...e,value:p,onChange:e=>{g((()=>e.target.value))},placeholder:u.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.searchPlaceholder",defaultMessage:"Search properties..."})}),action:e=>{}}],showNoResultMessage:!0,render:e=>(0,b.jsx)(ne.Z,{isInput:!0,...e})};i.push(e)}return C.forEach((t=>{if(0===t.length)return;const n=t[0].sectionName,r={key:n,items:t.map((t=>{const{key:n,name:i}=t;let r;if("record_count"===n.type)r=(0,ca.k)({width:16,height:16,marginRight:-2});else if("property"===n.type){const e=(0,sa.Qm)({schema:y,property:n.property});r=e?(0,b.jsx)(la.ZP,{type:e.type,icon:e.icon,size:16,theme:v.propertyIcon.theme,style:{fill:v.propertyIcon.fill}}):void 0}const a=o&&ya(o)===ya(n);return{key:i,render:(e,t)=>(0,b.jsx)(X.Z,{...e,title:i,icon:r,right:a?(0,Mo.k)({width:14,height:14}):void 0}),action:o=>{e.handlePropertySelect(t)}}})).filter(N.$K),render:e=>{const t=function(e){if(e===ga)return;if(e===ma)return yo.default.formatMessage(Mn.wh.chartAggregateSection);if(e===Sa)return yo.default.formatMessage(Mn.wh.chartDistinctSection)}(n);return(0,b.jsx)(ne.Z,{title:t,...e})}};i.push(r)})),(0,b.jsx)(J.Z,{...n,children:(0,b.jsx)(ee.Z,{initialFocus:0,type:ee.i.Vertical,sections:i})})}})}function ha(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),l=(0,a.VK)((()=>i.collectionViewStore()),[i]),c=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),d=(0,a.VK)((()=>null==t?void 0:t.donutConfig),[t]),u=n.useCallback((e=>{if(!t)return;const n=(0,yn.fI)({property:e,collectionSchema:c});p.createAndCommit({userAction:"chartSettings.setDonutGroupBy",environment:o,perform:e=>{if(n&&l){const o=Mt.Xh(t);o.donutConfig.dataConfig.groupBy=n,io.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:{...o},transaction:e})}}})}),[c,l,o,t]),g=(0,a.VK)((()=>d?d.dataConfig.groupBy.property:void 0),[d]),m=n.useCallback((e=>(0,yn.Co)(e.type)),[]);return(0,b.jsx)(ra,{icon:ur,title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartSliceDonutBy}),selectedProperty:g,handlePropertySelect:u,isPropertyValid:m,disabled:!d})}function Ca(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),s=(0,a.VK)((()=>i.collectionViewStore()),[i]),l=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),c=(0,a.VK)((()=>null==t?void 0:t.donutConfig),[t]),d=(0,a.VK)((()=>{const e=c?c.dataConfig.groupBy.property:void 0;if(e&&l)return l[e]}),[c,l],{useDeepEqual:!0}),u=(0,a.VK)((()=>null==c?void 0:c.dataConfig.groupBy),[c]),g=n.useCallback((e=>{if(!d||!s||!t)return;const n=(0,yn.qV)({property:t.donutConfig.dataConfig.groupBy.property,propertySchema:d,groupByOption:e});p.createAndCommit({userAction:"chartSettings.setDonutGroups",environment:o,perform:e=>{if(n){const o=Mt.Xh(t);o.donutConfig.dataConfig.groupBy=n,io.sW({store:s.getFormatStore().getKeyStore("chart_config"),data:{...o},transaction:e})}}})}),[o,s,t,d]);return u?(0,b.jsx)(aa,{groupBy:u,propertySchema:d,onChange:g,disabled:!1}):null}function va(e){let{chartConfig:t}=e;const o=(0,s.useIntl)(),i=(0,r.O7)(),l=(0,ut.Y$)(),c=(0,a.VK)((()=>l.collectionViewStore()),[l]),d=(0,a.VK)((()=>l.databaseType),[l]),u=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),g=(0,a.VK)((()=>null==t?void 0:t.donutConfig),[t]),m=(0,a.VK)((()=>{const e=null==g?void 0:g.dataConfig.aggregation;if(!e)return;const t=e.type;return"record_count"===t?{type:"record_count"}:"property_aggregation"===t?{type:"property",property:e.property}:void 0}),[g]),S=(0,a.VK)((()=>{if(!g)return[];const e=g.dataConfig.groupBy.property,t=(0,N.qP)(u).map((t=>{let[o,n]=t;if(n&&o!==e){if((0,Jt.G$)(n)){return{key:{type:"property",property:o},name:n.name,sectionName:ma}}if((0,Jt.gB)(n)||(0,Jt.KR)(n)||(0,Jt.p_)(n)||(0,Jt.cu)(n)){return{key:{type:"property",property:o},name:n.name,sectionName:Sa}}}})).filter(N.$K);return[{key:{type:"record_count"},name:(0,Mn.Hk)({aggregation:{aggregator:"count"},databaseType:d,intl:o})||"",sectionName:"default"},...t]}),[g,u,d,o]),f=n.useCallback((e=>{const{key:o,sectionName:n}=e;if(!c||!t)return;const r=t.donutConfig.dataConfig.aggregation;let a;if("record_count"===o.type){const e={aggregator:"count"};a=(0,yn.BU)(r,e)}else{const{property:e}=o;if(n===ma){const t={aggregator:"sum",property:e};a=(0,yn.BU)(r,t)}else if(n===Sa){const t={aggregator:"unique",property:e};a=(0,yn.BU)(r,t)}}p.createAndCommit({userAction:"chartSettings.setXAxis",environment:i,perform:e=>{if(a){const o=Mt.Xh(t);o.donutConfig.dataConfig.aggregation=a,io.sW({store:c.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}})}),[t,c,i]);return(0,b.jsx)(xa,{collectionContextStore:l,selectedProperty:m,properties:S,handlePropertySelect:f,originProps:{title:(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartSliceDonutAggregation})}),icon:pr},callsite:"donut_slice_property"})}function ba(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),l=(0,a.VK)((()=>i.collectionViewStore()),[i]),c=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),d=(0,a.VK)((()=>null==t?void 0:t.donutConfig),[t]),u=(0,a.VK)((()=>null==d?void 0:d.dataConfig.aggregation),[d]),g=(0,a.VK)((()=>u&&"record_count"!==u.type?(0,yn.II)({collectionSchema:c,property:u.property}):[]),[c,u]),m=(0,a.VK)((()=>{if("record_count"===(null==u?void 0:u.type)){return{aggregator:"count"}}if("property_aggregation"===(null==u?void 0:u.type))return{aggregator:u.aggregator,property:u.property}}),[u]),S=n.useCallback((e=>{if(!l||!t||!u)return;const n=(0,yn.BU)(u,e);p.createAndCommit({userAction:"chartSettings.setDonutSliceAggregateBy",environment:o,perform:e=>{if(n){const o=Mt.Xh(t);o.donutConfig.dataConfig.aggregation=n,io.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}})}),[l,t,u,o]);return!m||(0,cr.HK)(m)||"unique"===m.aggregator?null:(0,b.jsx)(gr,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartAggregateBy}),icon:()=>(0,dr.J)({width:20,height:20,marginLeft:2}),aggregationOptions:g,selectedAggregation:m,onChange:S,disabled:!t})}const ja=(0,v.IU)("arrowsLeftRight",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M13.7791 3.59799C13.9305 3.74539 14.004 3.9196 13.9998 4.1206C13.9998 4.32607 13.9263 4.50251 13.7791 4.64992L10.5317 8.0268C10.3888 8.1742 10.2269 8.24791 10.0462 8.24791C9.84861 8.24791 9.68676 8.1809 9.56065 8.0469C9.43874 7.91736 9.37779 7.74986 9.37779 7.54439C9.37779 7.34785 9.44295 7.18481 9.57326 7.05528L10.9227 5.66834L11.8937 4.77722L10.5506 4.83082L2.66857 4.83082C2.4752 4.83082 2.31546 4.76382 2.18935 4.62982C2.06323 4.49581 2.00018 4.32831 2.00018 4.1273C2.00018 3.91736 2.06323 3.74539 2.18935 3.61139C2.31546 3.48185 2.4752 3.41708 2.66857 3.41708L10.5506 3.41709L11.8937 3.47069L10.9227 2.57286L9.57326 1.19263C9.44295 1.05863 9.37779 0.893355 9.37779 0.696817C9.37779 0.491345 9.43874 0.323841 9.56065 0.194305C9.68676 0.0647681 9.84861 -1.81463e-07 10.0462 -1.72827e-07C10.2269 -1.64925e-07 10.3888 0.0737017 10.5317 0.221105L13.7791 3.59799ZM2.21457 12.4087C2.06744 12.2568 1.99597 12.0804 2.00018 11.8794C2.00018 11.6784 2.07164 11.5042 2.21457 11.3568L5.47459 7.9799C5.61331 7.8325 5.77516 7.75879 5.96012 7.75879C6.1577 7.75879 6.31744 7.82356 6.43935 7.9531C6.56126 8.0871 6.62222 8.25684 6.62222 8.46231C6.62222 8.65438 6.55916 8.81742 6.43305 8.95142L5.08364 10.3317L4.10626 11.2295L5.44937 11.1759L13.3314 11.1759C13.5248 11.1759 13.6845 11.2429 13.8107 11.3769C13.9368 11.5109 13.9998 11.6784 13.9998 11.8794C13.9998 12.0849 13.9368 12.2546 13.8107 12.3886C13.6845 12.5226 13.5248 12.5896 13.3314 12.5896L5.44937 12.5896L4.10626 12.536L5.08364 13.4338L6.43305 14.8141C6.55916 14.9436 6.62222 15.1066 6.62222 15.3032C6.62222 15.5087 6.56126 15.6762 6.43935 15.8057C6.31744 15.9352 6.1577 16 5.96012 16C5.77516 16 5.61331 15.9285 5.47459 15.7856L2.21457 12.4087Z"})}),wa=(0,v.IU)("collectionChartXAxis",{viewBox:"0 0 16 16",svg:(0,b.jsx)("path",{d:"M2.20831 11.2556L2.20782 2.77084C2.20782 2.62501 2.26023 2.49741 2.36505 2.38803C2.47443 2.27866 2.60659 2.22397 2.76154 2.22397C2.91193 2.22397 3.03953 2.27866 3.14435 2.38803C3.25372 2.49741 3.30841 2.62501 3.30841 2.77084L3.3089 10.5104C3.3089 10.638 3.3727 10.7018 3.50031 10.7018H12.3548C12.5052 10.7018 12.6351 10.7542 12.7444 10.8591C12.8538 10.9684 12.9085 11.0983 12.9085 11.2487C12.9085 11.4037 12.8538 11.5335 12.7444 11.6384C12.6351 11.7432 12.5052 11.7956 12.3548 11.7956H2.75519C2.59113 11.7956 2.45896 11.7455 2.3587 11.6452C2.25844 11.5495 2.20831 11.4196 2.20831 11.2556ZM9.40851 9.02458C9.40851 8.91065 9.43813 8.82406 9.49738 8.76482C9.56118 8.70102 9.64093 8.66684 9.73663 8.66228C9.83689 8.65772 9.93943 8.68507 10.0443 8.74431L13.5784 10.8635C13.6696 10.9181 13.7311 10.9911 13.763 11.0822C13.7995 11.1688 13.8017 11.2577 13.7698 11.3488C13.7425 11.4354 13.681 11.5083 13.5853 11.5676L10.0511 13.6867C9.94627 13.7505 9.84373 13.7801 9.74347 13.7756C9.64777 13.771 9.56801 13.7391 9.50421 13.6799C9.44041 13.6161 9.40851 13.5249 9.40851 13.4064V9.02458Z"})});var Ma=o(54497);const _a=(0,s.defineMessages)({unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property to group by."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property to group by."}});function ka(e){switch(e){case"groupBy_property_is_not_groupable":return yo.default.formatMessage(_a.unsupportedProperty);case"groupBy_property_deleted_from_schema":return yo.default.formatMessage(_a.deletedProperty);default:return}}function Va(e){return"groupBy_property_deleted_from_schema"===e||"groupBy_property_is_not_groupable"===e}function Ta(e){let{chartConfig:t,chartError:o}=e;const i=(0,r.O7)(),l=(0,ut.Y$)(),c=(0,f.yK)((e=>({errorIcon:{fill:e.accentColors.orange[400]}})),[]),d=(0,a.VK)((()=>l.collectionViewStore()),[l]),u=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),g=(0,a.VK)((()=>null==t?void 0:t.axisConfig),[t]),m=(0,a.VK)((()=>{if(null!=g&&g.dataConfig.xAxis.groupBy.property)return null==g?void 0:g.dataConfig.xAxis.groupBy.property}),[g]),S=(0,a.VK)((()=>{const e={icon:wa};return o&&Va(o.error)?{icon:Ma.t,iconStyle:c.errorIcon}:e}),[o,c.errorIcon]),y=n.useCallback((e=>(0,Qi.mk)(e.type)),[]),x=n.useCallback((e=>{if(!t)return;const o=(0,Qi.t2)({xAxisProperty:e,collectionSchema:u});p.createAndCommit({userAction:"chartSettings.setXAxis",environment:i,perform:e=>{if(o&&d){const n=Mt.Xh(t);n.axisConfig.dataConfig.xAxis={groupBy:o},io.sW({store:d.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}})}),[u,d,i,t]);return(0,b.jsx)(ln.ZP,{textWrap:!0,placement:ln.ug.Left,disableTooltip:!o||!Va(o.error),renderTooltip:e=>o?(0,b.jsx)("span",{...e,children:ka(o.error)}):null,render:e=>(0,b.jsx)(ra,{...e,...S,title:(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartWhatToShow})}),selectedProperty:m,handlePropertySelect:x,isPropertyValid:y,disabled:!g})})}function Pa(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),s=(0,a.VK)((()=>i.collectionViewStore()),[i]),l=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),c=(0,a.VK)((()=>null==t?void 0:t.axisConfig),[t]),d=(0,a.VK)((()=>{const e=c?c.dataConfig.xAxis.groupBy.property:void 0;if(e&&l)return l[e]}),[c,l],{useDeepEqual:!0}),u=(0,a.VK)((()=>null==c?void 0:c.dataConfig.xAxis.groupBy),[c]),g=n.useCallback((e=>{if(!d||!s||!t)return;const n=(0,yn.qV)({property:t.axisConfig.dataConfig.xAxis.groupBy.property,propertySchema:d,groupByOption:e});p.createAndCommit({userAction:"chartSettings.setXAxisGroups",environment:o,perform:e=>{if(n){const o=Mt.Xh(t);o.axisConfig.dataConfig.xAxis={groupBy:n},io.sW({store:s.getFormatStore().getKeyStore("chart_config"),data:{...o},transaction:e})}}})}),[o,s,t,d]);return u?(0,b.jsx)(aa,{groupBy:u,propertySchema:d,onChange:g,disabled:!1}):null}function Fa(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),l=(0,a.VK)((()=>i.collectionViewStore()),[i]),c=(0,a.VK)((()=>{var e;return(null==t||null===(e=t.axisConfig)||void 0===e||null===(e=e.axisFormat)||void 0===e?void 0:e.axisSort)||yn.hd.manual}),[t]),d=(0,a.VK)((()=>{var e;const o=null==t||null===(e=t.axisConfig)||void 0===e?void 0:e.dataConfig.xAxis.groupBy.property;if(o)return i.normalizedSchemaStore.state[o]}),[t,i]),u=n.useCallback((e=>{l&&t&&p.createAndCommit({userAction:"chartSettings.setXAxisSort",environment:o,perform:o=>{const n=Mt.Xh(t);n.axisConfig.axisFormat||(n.axisConfig.axisFormat={}),n.axisConfig.axisFormat.axisSort=e,io.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:n,transaction:o})}})}),[o,l,t]),g=[{key:yn.hd.xAscending,title:"X ascending"},{key:yn.hd.xDescending,title:"X descending"}],m=[{key:yn.hd.yAscending,title:"Y ascending"},{key:yn.hd.yDescending,title:"Y descending"}],S=[{key:yn.hd.manual,title:"Manual"}];return"date"!==(null==d?void 0:d.type)&&S.push(...m),S.push(...g),(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartSortBy}),selectedKey:c,options:S,icon:ja,onChange:u})}var Za=o(22109);const Ba=(0,v.IU)("collectionChartYAxis",{viewBox:"0 0 16 16",svg:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("path",{d:"M4.35184 13.3584L4.35184 4.92715C4.35184 4.77446 4.40671 4.64086 4.51645 4.52634C4.63097 4.41183 4.76935 4.35457 4.93158 4.35457C5.08904 4.35457 5.22264 4.41183 5.33239 4.52634C5.4469 4.64086 5.50416 4.77446 5.50416 4.92715V12.5783C5.50416 12.7119 5.57096 12.7787 5.70456 12.7787L13.1625 12.7792C13.3199 12.7792 13.4559 12.8341 13.5704 12.9438C13.6849 13.0583 13.7422 13.1943 13.7422 13.3518C13.7422 13.514 13.6849 13.65 13.5704 13.7598C13.4559 13.8695 13.3199 13.9244 13.1625 13.9244L4.92442 13.9239C4.75265 13.9239 4.61427 13.8714 4.5093 13.7664C4.40432 13.6662 4.35184 13.5302 4.35184 13.3584Z"}),(0,b.jsx)("path",{d:"M2.36568 6.57231C2.42771 6.63434 2.51837 6.66535 2.63766 6.66535L7.22548 6.66535C7.34954 6.66535 7.44497 6.63195 7.51177 6.56515C7.5738 6.49835 7.6072 6.41485 7.61197 6.31464C7.61674 6.20967 7.58573 6.10231 7.51893 5.99257L5.30017 2.29225C5.23814 2.19205 5.1618 2.12763 5.07114 2.099C4.97571 2.0656 4.88266 2.06799 4.792 2.10616C4.69657 2.13956 4.62023 2.20398 4.56297 2.29941L2.34421 5.99972C2.28218 6.10947 2.25355 6.21683 2.25832 6.3218C2.2631 6.422 2.29888 6.50551 2.36568 6.57231Z"})]})});function Ia(e){let{chartConfig:t}=e;const o=(0,s.useIntl)(),i=(0,r.O7)(),l=(0,ut.Y$)(),c=(0,a.VK)((()=>l.collectionViewStore()),[l]),d=(0,a.VK)((()=>l.databaseType),[l]),u=(0,a.VK)((()=>l.normalizedSchemaStore.state),[l]),g=(0,a.VK)((()=>null==t?void 0:t.axisConfig),[t]),m=(0,a.VK)((()=>{if(!g)return;const e=(0,yn._z)(g);if(!e)return;const t=e.type;return"record_count"===t?{type:"record_count"}:"property_aggregation"===t?{type:"property",property:e.property}:void 0}),[g]),S=(0,a.VK)((()=>{if(!g)return[];const e=g.dataConfig.xAxis.groupBy.property,t=(0,N.qP)(u).map((t=>{let[o,n]=t;if(n&&o!==e){if((0,Jt.G$)(n)){return{key:{type:"property",property:o},name:n.name,sectionName:ma}}if((0,Jt.gB)(n)||(0,Jt.KR)(n)||(0,Jt.p_)(n)||(0,Jt.cu)(n)){return{key:{type:"property",property:o},name:n.name,sectionName:Sa}}}})).filter(N.$K);return[{key:{type:"record_count"},name:(0,Mn.Hk)({aggregation:{aggregator:"count"},databaseType:d,intl:o})||"",sectionName:"default"},...t]}),[g,u,d,o]),f=n.useCallback((e=>{const{key:o,sectionName:n}=e;if(!c||!t)return;const r=(0,yn._z)(t.axisConfig);if(!r)return;let a;if("record_count"===o.type){const e={aggregator:"count"};a=(0,yn.BU)(r,e)}else{const{property:e}=o;if(n===ma){const t={aggregator:"sum",property:e};a=(0,yn.BU)(r,t)}else if(n===Sa){const t={aggregator:"unique",property:e};a=(0,yn.BU)(r,t)}}p.createAndCommit({userAction:"chartSettings.setXAxis",environment:i,perform:e=>{if(a){const o=Mt.Xh(t);o.axisConfig.dataConfig.yAxis=[a],io.sW({store:c.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}})}),[t,c,i]);return(0,b.jsx)(xa,{collectionContextStore:l,selectedProperty:m,properties:S,handlePropertySelect:f,originProps:{title:(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartWhatToShow})}),icon:Ba},callsite:"y_axis_property"})}function Aa(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),l=(0,a.VK)((()=>i.collectionViewStore()),[i]),c=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i]),d=(0,a.VK)((()=>null==t?void 0:t.axisConfig),[t]),u=(0,a.VK)((()=>(0,yn._z)(d)),[d]),g=(0,a.VK)((()=>u&&"record_count"!==u.type?(0,yn.II)({collectionSchema:c,property:u.property}):[]),[c,u]),m=(0,a.VK)((()=>{const e=(0,yn._z)(d);if(e){if("record_count"===e.type){return{aggregator:"count"}}return"property_aggregation"===e.type?{aggregator:e.aggregator,property:e.property}:void 0}}),[d]),S=n.useCallback((e=>{if(!l||!t)return;const n=(0,yn._z)(t.axisConfig);if(!n)return;const i=(0,yn.BU)(n,e);p.createAndCommit({userAction:"chartSettings.setYAxis",environment:o,perform:e=>{if(i){const o=Mt.Xh(t);o.axisConfig.dataConfig.yAxis=[i],io.sW({store:l.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}})}),[o,t,l]);return!m||(0,cr.HK)(m)||"unique"===m.aggregator?null:(0,b.jsx)(gr,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartAggregateBy}),icon:()=>(0,dr.J)({width:20,height:20,marginLeft:2}),aggregationOptions:g,selectedAggregation:m,onChange:S,disabled:!t})}function Ka(e){let{chartConfig:t}=e;const o=(0,r.O7)(),i=(0,ut.Y$)(),l=(0,a.VK)((()=>i.normalizedSchemaStore.state),[i.normalizedSchemaStore]),c=(0,a.VK)((()=>i.collectionViewStore()),[i]),d=n.useCallback(((e,n)=>{const i=l[e];if(!i||!t)return;const r=(0,yn.qV)({property:e,propertySchema:i,groupByOption:n}),a=(0,yn._z)(t.axisConfig);r&&(0,yn.CT)(r)&&c&&p.createAndCommit({userAction:"chartSettings.setYAxisStackBy",environment:o,perform:e=>{if(a){const o=Mt.Xh(t);o.axisConfig.dataConfig.yAxis=[{...a,stackOptions:{groupBy:r}}],io.sW({store:c.getFormatStore().getKeyStore("chart_config"),data:o,transaction:e})}}})}),[l,c,t,o]),u=n.useCallback((()=>{if(!t)return;const e=(0,yn._z)(t.axisConfig);c&&p.createAndCommit({userAction:"chartSettings.clearYAxisStackBy",environment:o,perform:o=>{if(e){const n=Mt.Xh(t);n.axisConfig.dataConfig.yAxis=[{...e,stackOptions:void 0}],io.sW({store:c.getFormatStore().getKeyStore("chart_config"),data:n,transaction:o})}}})}),[c,t,o]),g=n.useCallback((e=>{const{key:t}=e;if("none"===t.type)u();else{const{property:e,groupByOption:o}=t;d(e,o)}}),[u,d]),m=(0,a.VK)((()=>{var e;if(!t)return;const o=(0,yn._z)(t.axisConfig),n=null==o||null===(e=o.stackOptions)||void 0===e?void 0:e.groupBy;return n?"status"===n.type||"date"===n.type?{type:"property",property:n.property,groupByOption:n.groupBy}:{type:"property",property:n.property}:{type:"none"}}),[t]),S=(0,a.VK)((()=>{const e=Object.keys(l),t=[],o={key:{type:"none"},name:yo.default.formatMessage(Mn.wh.noneMenuItem),sectionName:ga};return t.push(o),e.forEach((e=>{const o=(0,sa.Qm)({schema:l,property:e});if(o)if((0,mr.H1)(o.type))mr.vu.forEach((n=>{t.push({key:{type:"property",property:e,groupByOption:n},name:`${o.name} (${yo.default.formatMessage(Lr[n])})`,sectionName:ga})}));else if((0,mr.A1)(o.type))mr.z8.forEach((n=>{t.push({key:{type:"property",property:e,groupByOption:n},name:`${o.name} (${yo.default.formatMessage(zr[n])})`,sectionName:ga})}));else{if("select"!==o.type&&"multi_select"!==o.type&&"relation"!==o.type&&"number"!==o.type&&"person"!==o.type)return;t.push({key:{type:"property",property:e},name:o.name,sectionName:ga})}})),t}),[l]);return(0,b.jsx)(xa,{collectionContextStore:i,selectedProperty:m,properties:S,handlePropertySelect:g,originProps:{title:(0,b.jsx)("span",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartGroupBy})}),icon:vn},callsite:"y_axis_groups"})}function Oa(e){let{}=e;const t=[{key:Mn.hi,title:Mn.hi}];return(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartSortBy}),selectedKey:t[0].key,options:t,icon:Za.T,onChange:()=>{}})}var Da=o(95477);function Ra(){(0,f.yK)((e=>({link:{color:e.accentColors.uiBlue[600],fontSize:12}})),[]);return null}var La=o(27714);const Ha=function(e){let{collectionContextStore:t}=e;const o=(0,r.O7)();return(0,b.jsx)(A.Z,{icon:La.N,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"}),onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(d.Ol({environment:e,collectionContextStore:t,collectionViewStore:o}),no.wd({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(o,t)})};const za=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),l=(0,a.VK)((()=>t.permissionScopes.state),[t]),c=(0,a.VK)((()=>!l.canConfigureBlock||"collectionTypedView"===t.contextType),[t,l]);return!i||c?null:(0,b.jsx)(A.Z,{icon:P.y,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteButton.title"}),isRed:!0,onClick:()=>function(e,t,o){const n=t.collectionViewStore();n&&(d.TT({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,from:"view_settings"}),no.wd({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:n.getType()}))}(n,t,o)})};var Ea=o(88437);const Ua=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,s.useIntl)(),l=(0,a.VK)((()=>t.permissionScopes.state),[t]);return(0,a.VK)((()=>!l.canConfigureBlock||"collectionTypedView"===t.contextType),[t,l])?null:(0,b.jsx)(A.Z,{icon:Ea.a,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"}),onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();i&&(d.zt({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:n}),no.wd({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(n,t,o,i)})};var Na=o(6637);const Wa=function(e){let{collectionContextStore:t,collectionSettingsStore:o,disabled:n}=e;const i=(0,r.O7)(),l=(0,a.VK)((()=>t.permissionScopes.state),[t]),c=(0,a.VK)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&l.canConfigureBlock?1:0)),[t,l]);return(0,b.jsx)(A.Z,{disabled:n,icon:Na.I,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:c>0?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:c},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{no.wd({environment:i,collectionContextStore:t,action:"click_filters"}),0===c?d.H4({collectionSettingsStore:o,item:{type:"createFilter"}}):d.H4({collectionSettingsStore:o,item:{type:"filters"}})}})};var Ga=o(89036),qa=o(76798);const $a={[uo.Vj.Jira]:y.Z.images.externalIntegrations.jiraPng};var Xa=o(92283);function Ya(e){let{collectionStore:t,collectionSettingsStore:o}=e;const n=(0,a.VK)((()=>{var e;return null==t||null===(e=t.getFormat())||void 0===e?void 0:e.external_collection_type}),[t]),i=n?$a[n]:"";return(0,b.jsx)(A.Z,{icon:Ga.v,onClick:()=>{d.H4({collectionSettingsStore:o,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("img",{style:{height:16,width:16,display:"inline-flex",alignItems:"center"},src:i,alt:"External intergration icon"}),(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,Mt.kC)(n)}})]}),showChevron:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}const Qa=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.collectionStore()),[t]),l=(0,a.VK)((()=>null==i?void 0:i.isExternalSyncedCollection()),[i]),c=(0,a.VK)((()=>(0,Xa.K)()),[]),u=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),p=(0,a.VK)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),n=t.collectionViewStore();if(!e||!o||!n)return!1;if(e.isSyncedCollection())return!0;return void 0===o.getCollectionViewSourceCollectionStore()}),[t]),g=(0,a.VK)((()=>null==i?void 0:i.getIcon()),[i]);return c&&l&&i?(0,b.jsx)(Ya,{collectionStore:i,collectionSettingsStore:o}):i&&u&&p?(0,b.jsx)(A.Z,{icon:Ga.v,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,b.jsxs)(b.Fragment,{children:[g&&(0,b.jsx)(ii.Z,{icon:g,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,b.jsx)(qa.Z,{store:i})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_source"}),d.H4({collectionSettingsStore:o,item:{type:"source"}})}}):null};function Ja(e){let{chartConfig:t,chartError:o}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartXAxis}),children:[(0,b.jsx)(Ta,{chartConfig:t,chartError:o}),(0,b.jsx)(Pa,{chartConfig:t}),(0,b.jsx)(Fa,{chartConfig:t})]}),(0,b.jsxs)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartYAxis}),children:[(0,b.jsx)(Ia,{chartConfig:t}),(0,b.jsx)(Aa,{chartConfig:t}),(0,b.jsx)(Ka,{chartConfig:t}),(0,b.jsx)(Oa,{})]})]})}function es(e){let{chartConfig:t}=e;return(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(ha,{chartConfig:t}),(0,b.jsx)(Ca,{chartConfig:t}),(0,b.jsx)(va,{chartConfig:t}),(0,b.jsx)(ba,{chartConfig:t})]})}function ts(e){let{collectionSettingsStore:t,disabled:o}=e;return(0,b.jsx)(A.Z,{disabled:o,title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartStyle}),icon:Ji,showChevron:!0,onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"chartStyle"}})}})}function os(e){let{collectionSchema:t,collectionViewStore:o}=e;const i=(0,r.O7)(),a=n.useCallback((()=>{p.createAndCommit({userAction:"chartSettings.clearChartConfig",environment:i,perform:e=>{io.sW({store:o.getFormatStore(),data:{chart_config:(0,Qi.K0)({collectionSchema:t})},transaction:e})}})}),[i,o,t]);return(0,b.jsx)(Q.Z,{href:"",onClick:()=>a(),children:(0,b.jsx)(A.Z,{title:"CLEAR CONFIG REMOVE ME",isGray:!0})})}const ns=function(e){let{collectionSettingsStore:t}=e;const o=(0,s.useIntl)(),n=(0,ut.Y$)(),i=(0,a.VK)((()=>Qe.default.checkGate("charts_mvp")),[]),r=(0,a.VK)((()=>n.normalizedSchemaStore.state),[n]),l=(0,a.VK)((()=>n.collectionViewStore()),[n]),{chartConfig:c,chartError:d}=(0,a.VK)((()=>(0,yn.LI)({collectionViewFormat:n.normalizedFormatStore.state,collectionSchema:r})),[n,r]);return i&&l&&r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{topBorder:!0,title:o.formatMessage(Mn.wh.chartType),right:(0,b.jsx)(Ra,{}),children:(0,b.jsx)(lr,{chartConfig:c})}),void 0===c&&(0,b.jsx)(Ja,{chartConfig:void 0,chartError:d}),("line"===(null==c?void 0:c.type)||"column"===(null==c?void 0:c.type))&&(0,b.jsx)(Ja,{chartConfig:c,chartError:d}),"donut"===(null==c?void 0:c.type)&&(0,b.jsx)(es,{chartConfig:c}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(Wa,{disabled:!c,collectionContextStore:n,collectionSettingsStore:t}),(0,b.jsx)(ts,{collectionSettingsStore:t,disabled:!c})]}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(Qa,{collectionContextStore:n,collectionSettingsStore:t}),(0,b.jsx)(Ha,{collectionContextStore:n}),(0,b.jsx)(Ua,{collectionContextStore:n,collectionSettingsStore:t}),(0,b.jsx)(za,{collectionContextStore:n,collectionSettingsStore:t})]}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(kr.Z,{href:"",title:(0,b.jsx)(s.FormattedMessage,{...Mn.wh.chartHelp}),analyticsFrom:"view_settings_charts_help"}),(0,b.jsx)(os,{collectionSchema:r,collectionViewStore:l})]})]}):null};var is=o(17095),rs=o(27871),as=o(40745);const ss=function(e){let{collectionContextStore:t}=e;const o=(0,r.O7)(),n=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),i=(0,a.VK)((()=>t.isFullScreen.state),[t]),l=(0,a.VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),c=(0,a.VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,uo.rx)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),d=(0,a.VK)((()=>t.permissionScopes.state),[t]);return n.collection_group_by||!i&&"calendar"!==l?(0,b.jsx)(ht.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:c,popupStyle:{minWidth:190},options:uo.jk.map((e=>({key:e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;p.createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,perform:t=>{u.FH({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),no.wd({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,o,t),disabled:!d.canConfigureBlock,icon:as.M}):null};const ls=(0,s.defineMessages)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}}),cs=Si.default.createClass(!1);const ds=function(e){const{collectionContextStore:t,collectionViewStore:o,selectViewNameInitial:i,collectionSettingsStore:l}=e,c=(0,s.useIntl)(),d=(0,f.Fg)(),g=(0,r.O7)(),m=(0,a.qz)(void 0,cs),S=(0,a.VK)((()=>t.isInHomeWidget.state),[t]),x=(0,a.VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,Wi.qG)(o)}),[t]),h=(0,n.useCallback)((e=>function(e,t,o,n){const i=null==n?void 0:n.getFormat().description;if(!n||e===i)return;p.createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,perform:t=>{ro.iG({collectionViewStore:n,update:{format:{...n.getFormat(),description:e}},transaction:t})}}),no.wd({environment:t,collectionContextStore:o,action:"set_description"})}(e,g,t,o)),[g,t,o]),C=(0,r.Fy)(),v=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),j=(0,a.VK)((()=>t.permissionScopes.state),[t]),w=(0,a.VK)((()=>t.isEmptyStore.state),[t]),M=(0,a.VK)((()=>o.isDefined()),[o]),{description:_,collection_view_icon:k}=(0,a.VK)((()=>o.getFormat()),[o]),V=(0,a.VK)((()=>o.getType()),[o]),T=(0,a.VK)((()=>o.getAppConfigUri()),[o]),P=(0,a.VK)((()=>o.getName()),[o]),F=!(T&&(0,le.xB)(T)),Z=(0,a.VK)((()=>m.state),[m]),B=(0,a.VK)((()=>Qe.default.checkGate("home_compact_view")),[]),K=(0,yt.E)("feature_settings");if(!M||!v)return null;const O=(0,b.jsx)(ne.Z,{title:C.isMobile&&(0,b.jsx)(s.FormattedMessage,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,b.jsx)(gi.I,{initialValue:P||"",placeholder:c.formatMessage(ls.viewNamePlaceholderMessage),onBlur:e=>Zs(e,g,t),onSubmit:e=>Zs(e,g,t),focusInitial:i,selectAll:i,disabled:!j.canConfigureBlock||!F,iconButton:{icon:e=>(0,b.jsx)(pi.F,{color:"gray",viewIcon:k,viewType:V,style:{marginRight:6}}),iconStyle:{fill:ui.Lr[d.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore(),i=t.collectionViewBlockStore();if(!i||!n||!n.isDefined())return;const r=(0,Wi.qG)(i.id);p.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,perform:e=>{if(r){const t=o||y.Z.images.appPackages.taskDbIconSvg;ro.Uy({collectionViewStore:n,icon:t,transaction:e}),u.FH({stores:[i],update:{page_icon:t},transaction:e})}else ro.Uy({collectionViewStore:n,icon:o,transaction:e})}}),no.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(g,t,e)},inputRightButton:x?null:(0,b.jsx)(is.l,{description:_,showTooltip:!Z,onClick:()=>m.setState(!Z),addDescriptionText:c.formatMessage(ls.addDescriptionTooltip),editDescriptionText:c.formatMessage(ls.editDescriptionTooltip)})})});if("page"===V)return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:O});if(S)return(0,b.jsxs)(b.Fragment,{children:[w?null:(0,b.jsxs)(b.Fragment,{children:[B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{style:{paddingBottom:0},children:O}),(0,b.jsx)(ne.Z,{children:(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:l})})]}),(0,b.jsxs)(ne.Z,{topBorder:B,children:[(0,b.jsx)(_s,{collectionContextStore:t,collectionSettingsStore:l}),(0,b.jsx)(Wa,{collectionContextStore:t,collectionSettingsStore:l}),(0,b.jsx)(ks,{collectionContextStore:t,collectionSettingsStore:l}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(vs,{collectionContextStore:t,collectionSettingsStore:l}),(0,b.jsx)(bs,{collectionContextStore:t,collectionSettingsStore:l})]})]})]}),x&&(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(A.Z,{icon:bn.L,isPadded:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from home"}),showChevron:!1,onClick:()=>{ei.default.state.currentSpaceViewStore&&ki.aG({environment:g,currentSpaceViewStore:ei.default.state.currentSpaceViewStore,feature:"tasks",from:"tasks_more_menu"})}}),(0,b.jsx)(Fs,{collectionContextStore:t})]})]});let D;return D="chart"===V?(0,b.jsx)(Ks,{collectionContextStore:t,collectionSettingsStore:l}):K?(0,b.jsx)(Ds,{collectionContextStore:t,collectionSettingsStore:l,isMyTasks:x}):(0,b.jsx)(Os,{collectionContextStore:t,collectionSettingsStore:l,isMyTasks:x}),(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,b.jsx)(Ss,{collectionContextStore:t}),O,Z&&(0,b.jsx)(rs.i,{initialDescription:_,handleSaveDescription:h}),D]})};function us(e,t,o){return t?o?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Unlock wiki",id:"action.unlockWikiName.name"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Lock wiki",id:"action.lockWikiName.name"}):e?o?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"}):o?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"})}function ps(e){let t;return t=e?e.supportedInView&&e.isVisibleInView?St.dH.relationFeatureShownMessage:St.dH.relationFeatureHiddenMessage:St.dH.relationFeatureOffMessage,yo.default.formatMessage(t)}function gs(e,t){const o=t.permissionScopes.state,n=(0,N.$K)(e),i=o.canConfigureBlock;return n||i}function ms(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function Ss(e){let{collectionContextStore:t}=e;return(0,a.VK)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,b.jsx)(Pi,{})}function fs(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>o.currentSubitemFormatStoreForCollection.state),[o]),i=(0,a.VK)((()=>o.databaseType),[o]),r=(0,a.VK)((()=>Zo({feature:"subitem",collectionContextStore:o})),[o]),l=(0,a.VK)((()=>gs(n,o)),[o,n]),c=(0,a.VK)((()=>Qe.default.checkGate("collection_subitem_new_show_hide_options")),[]),u=(0,a.VK)((()=>c?function(e){let t;return t=e?St.dH.relationFeatureOnMessage:St.dH.relationFeatureOffMessage,yo.default.formatMessage(t)}(r):ps(r)),[r,c]);return(0,b.jsx)(A.Z,{icon:wi,title:(0,b.jsx)(s.FormattedMessage,{...(0,St.Gt)({feature:"subitem",databaseType:i})}),showChevron:!0,right:u,onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"subitemV2"}})},disabled:!l})}function ys(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>o.currentArrowsByFormatStore.state),[o]),i=(0,a.VK)((()=>o.databaseType),[o]),r=(0,a.VK)((()=>Zo({feature:"timeline_arrows_by",collectionContextStore:o})),[o]),l=(0,a.VK)((()=>gs(n,o)),[o,n]);return(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{...(0,St.Gt)({feature:"timeline_arrows_by",databaseType:i})}),showChevron:!0,icon:xi.I,right:ps(r),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"dependencies"}})},disabled:!l})}function xs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,a.VK)((()=>(0,Gi.cB)(t)),[t]),i=(0,a.VK)((()=>t.aliveAutomationCount.state),[t]),r=(0,a.VK)((()=>(0,Gi.Li)({collectionStore:t.collectionStore()})),[t]);return n?(0,b.jsx)(A.Z,{icon:yi.M,onClick:()=>{!r||i>0?d.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings"}}):d.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}})},right:i>0?i:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function hs(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>{const e=o.databaseType;return e===R.iS||e===R.p$}),[o]),{sprintSettingsPermissionsContext:i,automaticSprintCompletionEnabled:r}=$({collectionSettingsStore:t,collectionContextStore:o});let l;if(null!=i&&i.canEdit){l=i.sprintsEnabled?r?(0,b.jsx)(s.FormattedMessage,{...me.automatic}):(0,b.jsx)(s.FormattedMessage,{...me.manual}):(0,b.jsx)(s.FormattedMessage,{...me.off})}return n&&l?(0,b.jsx)(A.Z,{icon:T.L,right:l,showChevron:!0,title:(0,b.jsx)(s.FormattedMessage,{...me.sprintsMenuTitle}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"sprintSettings"}})}}):null}function Cs(e){let{collectionContextStore:t}=e;const o=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),n=(0,a.VK)((()=>null==o?void 0:o.getRole()),[o]);return(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getDatabaseType()}),[t])!==R.iS?null:o&&"content_only_editor"!==n?(0,b.jsx)(Hi,{collectionContextStore:t}):null}function vs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>ms(t)),[t]),l="board"===i?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),u=(0,a.VK)((()=>t.normalizedFormatStore.state),[t])[l.groupByKey],p=(0,a.VK)((()=>t.permissionScopes.state),[t]);return"calendar"!==i?(0,b.jsx)(A.Z,{icon:"board"===i?hi:Ci,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:Pr(u?c[u.property]:void 0),onClick:()=>{var e;no.wd({environment:n,collectionContextStore:t,action:"click_group",original_view_type:i,property_type:u?null===(e=c[u.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:u?{type:"group",...l}:{type:"groupByProperty",...l}})},disabled:!u&&!p.canConfigureBlock}):null}function bs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>ms(t)),[t]),l=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]).collection_group_by,u={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},p=(0,a.VK)((()=>t.permissionScopes.state),[t]);return"board"===i?(0,b.jsx)(A.Z,{icon:Ci,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:Pr(c?l[c.property]:void 0),onClick:()=>{var e;no.wd({environment:n,collectionContextStore:t,action:"click_subgroup",original_view_type:i,property_type:c?null===(e=l[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:c?{type:"group",...u}:{type:"groupByProperty",...u}})},disabled:!c&&!p.canConfigureBlock}):null}function js(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),l=(0,a.VK)((()=>t.currentSubitemFormatStoreForUiDisplay.state),[t]),c=l?i[l.property]:void 0,u=(0,a.VK)((()=>t.permissionScopes.state),[t]),p=(0,a.VK)((()=>t.databaseType),[t]);return(0,b.jsx)(A.Z,{icon:wi,title:(0,b.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,b.jsx)(s.FormattedMessage,{...(0,St.Gt)({feature:"subitem",databaseType:p})}),(0,b.jsx)(Ni.Z,{size:2})]}),showChevron:!0,right:(0,b.jsx)("span",{style:{...F.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,b.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.subitemTab.none"})}),onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_subitem"}),d.H4({collectionSettingsStore:o,item:{type:"subitem"}})},disabled:!l&&!u.canConfigureBlock})}function ws(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),l=(0,a.VK)((()=>t.currentArrowsByFormatStore.state),[t]),c=l?i[l]:void 0,u=(0,a.VK)((()=>t.permissionScopes.state),[t]);return(0,b.jsx)(A.Z,{icon:fi.Z,title:(0,b.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Dependencies",id:"database.viewSettings.mainTab.dependencies.title"}),(0,b.jsx)(Ni.Z,{size:2})]}),showChevron:!0,right:(0,b.jsx)("span",{style:{...F.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,b.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.arrowsByTab.none"})}),onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_timeline_arrows_by"}),d.H4({collectionSettingsStore:o,item:{type:"arrowsBy"}})},disabled:!l&&!u.canConfigureBlock})}function Ms(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.collectionViewStore()),[t]),l=(0,a.VK)((()=>null==i?void 0:i.getType()),[i]);return i&&l?(0,b.jsx)(A.Z,{icon:vi.M,isPadded:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:fo.Bh[l],onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_layout"}),d.H4({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function _s(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),l=(0,a.VK)((()=>ms(t)),[t]),c=(0,a.VK)((()=>(0,uo.oz)(l)),[l]);if("chart"===l)return(0,b.jsx)(b.Fragment,{});const u=((c?i[c]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,b.jsx)(A.Z,{icon:wn.N,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:u}}),onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_properties"}),d.H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function ks(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.O7)(),i=(0,a.VK)((()=>t.currentSortsStore.state.length),[t]);return(0,b.jsx)(A.Z,{icon:Mi.j,isPadded:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:i>0?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:i},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{no.wd({environment:n,collectionContextStore:t,action:"click_sort"}),0===i?d.H4({collectionSettingsStore:o,item:{type:"createSort"}}):d.H4({collectionSettingsStore:o,item:{type:"sort"}})}})}function Vs(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;return(0,a.VK)((()=>Qe.default.checkGate("dependency_date_shifting_by_space")),[])?(0,b.jsx)(fs,{collectionSettingsStore:t,collectionContextStore:o}):(0,b.jsx)(js,{collectionContextStore:o,collectionSettingsStore:t})}function Ts(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>Qe.default.checkGate("dependency_date_shifting_by_space")),[]),i=(0,a.VK)((()=>qo({feature:"timeline_arrows_by",viewType:ms(o)})),[o]);return n?(0,b.jsx)(ys,{collectionSettingsStore:t,collectionContextStore:o}):i?(0,b.jsx)(ws,{collectionContextStore:o,collectionSettingsStore:t}):null}function Ps(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,a.VK)((()=>t.collectionStore()),[t]),r=(0,a.VK)((()=>null==i?void 0:i.isSyncedCollection()),[i]),s=(0,a.VK)((()=>t.contextType),[t]);return r||"collectionTypedView"===s?null:(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(Vs,{collectionSettingsStore:o,collectionContextStore:t}),(0,b.jsx)(Ts,{collectionSettingsStore:o,collectionContextStore:t})]})}function Fs(e){const t=(0,r.O7)(),o=(0,a.VK)((()=>{const e=ei.default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,Wi.qG)(e.id))}),[]),n=(0,a.VK)((()=>{if(!(0,qi.QI)())return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,Wi.qG)(t.id))}),[e.collectionContextStore]),i=(0,f.yK)((e=>({icon:Bs(e).iconStyles,title:Bs(e).menuItemStyles})),[]);if(!n)return null;const l=o?"home_tasks":"home_tile_tasks";return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Fi.default,{from:l}),(0,b.jsx)(A.Z,{showChevron:!1,icon:_.m,iconStyle:i.icon,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:i.title,onClick:()=>{Xi.Z.setState(!0),(0,$i.Aq)({environment:t,from:l})}})]})}function Zs(e,t,o){const n=o.collectionViewBlockStore(),i=o.collectionViewStore();if(!n||!i||!i.isDefined())return;const r=(0,Wi.qG)(n.id);i.getName()!==e&&p.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,perform:t=>{if(ro.iG({collectionViewStore:i,update:{name:e},transaction:t}),r){const o=(0,E.TPx)(e);Ti.sO({environment:n.environment,editorMode:"default",store:n.getBlockTitleStore(),value:o,transaction:t})}}}),no.wd({environment:t,collectionContextStore:o,action:"rename",original_view_type:i.getType()})}function Bs(e){return{menuItemStyles:{color:e.lightTextColor},iconStyles:{width:16,marginLeft:4,marginRight:2,fill:e.lightIconColor}}}function Is(e){let{collectionContextStore:t}=e;const o=(0,r.O7)(),n=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),i=(0,a.VK)((()=>null==n?void 0:n.getCollectionViewSourceCollectionStore()),[n]),s=(0,a.VK)((()=>null==n?void 0:n.isLocked()),[n]),l=(0,a.VK)((()=>i?i.canEditCollection():null==n?void 0:n.canEditCollection()),[n,i]),c=(0,a.VK)((()=>null==n?void 0:n.isCollectionViewPageWithContent()),[n]);return n&&l?(0,b.jsx)(A.Z,{icon:s?_i.U:bi.b,title:us(i,c,s),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();o&&(Vi.bo({environment:e,store:o,lock:!o.isLocked()}),no.wd({environment:e,collectionContextStore:t,action:"click_toggle_lock"}))}(o,t)}):null}function As(e){let{collectionContextStore:t}=e;const o=(0,r.O7)(),n=(0,r.MO)(),i=(0,a.VK)((()=>t.collectionStore()),[t]),l=(0,a.VK)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),n=t.collectionViewStore();if(!e||!o||!n)return!1;if(e.isSyncedCollection())return!1;const i=o.getCollectionViewSourceCollectionStore();return!!t.permissionScopes.state.canConfigureBlock&&((null==i||!i.isTypedCollection())&&void 0!==i)}),[t]);return i&&l?(0,b.jsx)(ne.Z,{topBorder:!0,style:{marginLeft:4},children:(0,b.jsx)(A.Z,{icon:()=>(0,ji.z)({width:n?16:14,marginLeft:n?4:void 0}),title:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[(0,b.jsx)("div",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Turn into task database",id:"database.viewSettings.mainTab.turnIntoTask.title"})}),(0,b.jsx)(Ui.Z,{})]}),caption:(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"See your tasks in Home, manage tasks in sprints, and more.",id:"database.viewSettings.mainTab.turnIntoTask.caption"})}),shouldWrapCaption:!0,showChevron:!1,onClick:()=>{Yi.Z.setState({isModalOpen:!0,databaseType:R.iS,collectionContextStore:t}),no.gd({environment:o,database_type:R.iS,collectionContextStore:t})}})}):null}function Ks(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{children:(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:o})}),(0,b.jsx)(ns,{collectionSettingsStore:o})]})}function Os(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:n}=e;const i=(0,r.O7)(),{device:s}=i,l=(0,a.VK)((()=>(0,qi.QI)()),[]),c=(0,a.VK)((()=>(0,le.rm)()),[]),d=(0,a.VK)((()=>t.isCompactView.state),[t]);return(0,b.jsxs)(b.Fragment,{children:[s.isMobile?(0,b.jsxs)(ne.Z,{topBorder:!0,children:[!d&&(0,b.jsx)(Qa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(_s,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Wa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(ks,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(vs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(bs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Ps,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(hs,{collectionSettingsStore:o,collectionContextStore:t}),(0,b.jsx)(ss,{collectionContextStore:t}),(0,b.jsx)(xs,{collectionContextStore:t,collectionSettingsStore:o})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.Z,{children:[!d&&(0,b.jsx)(Qa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(_s,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Wa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(ks,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(vs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(bs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Ps,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(hs,{collectionSettingsStore:o,collectionContextStore:t}),(0,b.jsx)(ss,{collectionContextStore:t}),(0,b.jsx)(xs,{collectionContextStore:t,collectionSettingsStore:o}),d&&(0,b.jsx)(Qa,{collectionContextStore:t,collectionSettingsStore:o})]})]}),l||c?(0,b.jsx)(As,{collectionContextStore:t}):void 0,(0,b.jsxs)(ne.Z,{topBorder:!0,mobileStyle:l||c?{paddingTop:2}:{},children:[l||c?(0,b.jsx)(Cs,{collectionContextStore:t}):void 0,(0,b.jsx)(Is,{collectionContextStore:t}),(0,b.jsx)(Ha,{collectionContextStore:t}),(0,b.jsx)(Ua,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(za,{collectionContextStore:t,collectionSettingsStore:o}),n&&(0,b.jsx)(Fs,{collectionContextStore:t})]})]})}function Ds(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:n}=e;const i=(0,r.O7)(),{device:s}=i,l=(0,a.VK)((()=>(0,qi.QI)()),[]),c=(0,a.VK)((()=>(0,le.rm)()),[]);return(0,b.jsxs)(b.Fragment,{children:[s.isMobile?(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(_s,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Wa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(ks,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(vs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(bs,{collectionContextStore:t,collectionSettingsStore:o})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{children:(0,b.jsx)(Ms,{collectionContextStore:t,collectionSettingsStore:o})}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(_s,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(Wa,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(ks,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(vs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(bs,{collectionContextStore:t,collectionSettingsStore:o})]})]}),l||c?(0,b.jsx)(As,{collectionContextStore:t}):void 0,(0,b.jsx)(Rs,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsxs)(ne.Z,{topBorder:!0,mobileStyle:l||c?{paddingTop:2}:{},children:[l||c?(0,b.jsx)(Cs,{collectionContextStore:t}):void 0,(0,b.jsx)(Is,{collectionContextStore:t}),(0,b.jsx)(Ha,{collectionContextStore:t}),(0,b.jsx)(Ua,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(za,{collectionContextStore:t,collectionSettingsStore:o}),n&&(0,b.jsx)(Fs,{collectionContextStore:t})]})]})}function Rs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r.MO)(),i=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]);return(0,b.jsx)(ne.Z,{topBorder:!0,style:{marginLeft:4},children:(0,b.jsx)(A.Z,{icon:()=>(0,ji.z)({width:n?16:14,marginLeft:n?4:void 0}),title:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[(0,b.jsx)("div",{style:F.Z.textOverflowStyle,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.mainTab.customizeButton.title",values:{databaseName:i}})}),(0,b.jsx)(Ui.Z,{})]}),caption:(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Manage and extend features.",id:"database.viewSettings.mainTab.customizeButton.caption"})}),shouldWrapCaption:!0,showChevron:!0,onClick:()=>{d.H4({collectionSettingsStore:o,item:{type:"customize"}})}})})}const Ls=function(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,s.useIntl)(),i=(0,f.Fg)(),l=(0,r.O7)(),{device:c}=l,u=(0,a.VK)((()=>t.collectionViewStore()),[t]),g=(0,a.VK)((()=>null==u?void 0:u.isDefined()),[u]),m=(0,a.VK)((()=>null==u?void 0:u.getFormat().collection_view_icon),[u]),S=(0,a.VK)((()=>null==u?void 0:u.getType()),[u]);return u&&g?(0,b.jsxs)(I.ZP,{...e,collectionSettingsStore:o,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:290,children:[(0,b.jsx)(ne.Z,{children:(0,b.jsx)(gi.I,{initialValue:"",placeholder:n.formatMessage(ls.viewNamePlaceholderMessage),focusInitial:!c.isMobile||void 0,onBlur:e=>Hs(e,l,t),iconButton:{icon:e=>(0,b.jsx)(pi.F,{color:"gray",viewIcon:m,viewType:S,style:{marginRight:6}}),iconStyle:{fill:ui.Lr[i.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;p.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,perform:e=>{ro.Uy({collectionViewStore:n,icon:o,transaction:e})}}),no.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(l,t,e)},onSubmit:e=>function(e,t,o,n){Hs(e,t,n),d.wl({collectionSettingsStore:o,item:{type:"main"}}),no.wd({environment:t,collectionContextStore:n,action:"rename"})}(e,l,o,t)})}),(0,b.jsx)(mi.Z,{collectionContextStore:t,collectionSettingsStore:o,showDoneButton:!c.isMobile})]}):null};function Hs(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&p.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,perform:t=>{ro.iG({collectionViewStore:n,update:{name:e},transaction:t})}})}var zs=o(34464),Es=o(10070),Us=o(87085),Ns=o(34517),Ws=o(16732),Gs=o(14871);function qs(e){const{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,b.jsx)(ne.Z,{topBorder:!0,title:"Advanced",children:(0,b.jsx)(xs,{collectionContextStore:t,collectionSettingsStore:o})})}function $s(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,a.VK)((()=>{var e;if(t)return null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]);return(0,yt.E)("feature_settings")?(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.customizeMenu.title",values:{databaseName:n??"database"}}),unconstrainedWidth:!0,children:[(0,b.jsx)(mo.ZP,{value:"",onChange:e=>{},placeholder:"Find or add features..."}),(0,b.jsx)(nl,{collectionContextStore:t,collectionSettingsStore:o}),(0,b.jsx)(qs,{collectionContextStore:t,collectionSettingsStore:o})]}):null}function Xs(e){return(0,a.VK)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;return o?(0,le.YB)((0,Ns.appConfigs)(),o):void 0}),[e])}function Ys(e){const{collectionFormat:t,feature:o}=e,n=t.app_config_uri;return o.collectionUri===n&&(o.dependencies.some((e=>"property"===e.type&&e.collectionUri===n&&(0,R.jP)(e.uri)))&&!o.isAi)}function Qs(e){const t=(0,r.O7)(),o=Xs(e);return(0,a.VK)((()=>{var n,i;if(!o)return[(0,Ws.EG)(),(0,Ws.tQ)()];const r=null===(n=e.collectionStore())||void 0===n?void 0:n.getFormat(),a=null===(i=e.collectionStore())||void 0===i?void 0:i.getSchema(),s=e.collectionStore(),l=e.collectionViewBlockStore();if(!(r&&a&&s&&l))return[];const c={};o.allFeatures.forEach((e=>{(0,le.FW)(e)&&e.variants.every((e=>Boolean(o.allFeatures.find((t=>t.uri===e&&(0,le.oX)(t)&&Ys({collectionFormat:r,feature:t}))))))&&(c[e.uri]=e.variants)}));const d=Object.values(c).flat(),u=o.allFeatures.filter((e=>{if(!d.find((t=>t===e.uri))&&(0,le.oX)(e)){const o=Ys({collectionFormat:r,feature:e}),n=function(e){const{environment:t,collectionStore:o,collectionFormat:n,collectionViewBlockStore:i,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;const a=r.dependencies[0];return a.collectionViewBlockUri===i.getFormat().app_config_uri&&a.collectionUri===n.app_config_uri&&(0,le.Ep)({environment:t,viewDependency:a,collectionStore:o})}({environment:t,collectionStore:s,collectionFormat:r,collectionViewBlockStore:l,feature:e});return o||n}return!!(0,le.FW)(e)&&Boolean(c[e.uri])}));return u.sort(((e,t)=>(0,le.FW)(e)?-1:(0,le.FW)(t)?1:e.dependencies.length-t.dependencies.length))}),[t,o,e])}function Js(e){const{collectionStore:t,feature:o,appConfig:n,collectionContextStore:i,collectionViewBlockStore:r}=e;if(!n)return function(e,t){const o=Zo({feature:"timeline_arrows_by",collectionContextStore:e});if("notion://tasks/sub_task_feature"===t.uri)return Boolean(e.currentSubitemFormatStoreForCollection.state);if("notion://tasks/task_dependencies_feature"===t.uri)return Boolean(o);return!1}(i,o);const a=Es.aQ.deriveTypeUris((null==t?void 0:t.getSchema())??{},null==t?void 0:t.getPropertyMapping());return o.dependencies.some((e=>{var o,n,i;const s="property"===e.type&&e.collectionUri===(null==t||null===(o=t.getFormat())||void 0===o?void 0:o.app_config_uri)&&(0,R.jP)(e.uri)&&a.has(e.uri),l="collection_view"===e.type&&e.collectionViewBlockUri===r.getFormat().app_config_uri&&e.collectionUri===(null==t||null===(n=t.getFormat())||void 0===n?void 0:n.app_config_uri)&&e.uri in((null===(i=r.getFormat())||void 0===i?void 0:i.app_uri_map)??{});return s||l}))}function el(e,t){return Mt.oA(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,le.oX)(o))return o})))}function tl(e){const{buttonMenuItemProps:t,name:o}=e,n=(0,f.yK)((()=>({menuItem:{display:"flex",padding:"8px 0px",alignItems:"center"},featureName:{fontSize:16},featureCaption:{fontSize:14,color:"gray"}})),[]);return(0,b.jsx)(jr.Z,{...t,style:n.menuItem,icon:(0,b.jsx)(ii.Z,{disabled:!0,icon:void 0,title:o,isEmptyPage:!1,size:32,isLarge:!0,useInvertedColors:!0}),title:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:n.featureName,children:o}),(0,b.jsx)("div",{style:n.featureCaption,children:"insert caption here"})]})})}function ol(e){const{buttonMenuItemProps:t,name:o,handleToggleOn:i}=e,[r,a]=(0,n.useState)(!1),s=(0,f.yK)((()=>({menuItem:{display:"flex",padding:"8px 0px",alignItems:"center"},titleWrapper:{display:"flex",alignItems:"center",justifyContent:"space-between"},featureName:{fontSize:16},featureCaption:{fontSize:14,color:"gray"}})),[]);return(0,b.jsx)(jr.Z,{...t,style:s.menuItem,icon:(0,b.jsx)(ii.Z,{disabled:!0,icon:void 0,title:o,isEmptyPage:!1,size:32,isLarge:!0,useInvertedColors:!0}),title:(0,b.jsxs)("div",{style:s.titleWrapper,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:s.featureName,children:o}),(0,b.jsx)("div",{style:s.featureCaption,children:"insert caption here"})]}),(0,b.jsx)(sn.Z,{on:r,onClick:()=>{a(!r),i()}})]})})}function nl(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,r.O7)(),i=Xs(t),{addedFeatures:s,suggestedFeatures:l}=function(e){const t=Xs(e),o=Qs(e);return(0,a.VK)((()=>{const n=e.collectionStore(),i=e.collectionViewBlockStore(),r=[],a=[];if(!n||!i)return{addedFeatures:r,suggestedFeatures:a};for(const s of o){let o;if((0,le.oX)(s))o=s;else{const e=el(s,null==t?void 0:t.allFeatures);if(0===e.length){console.error("FeatureWithVariants has no variants.");continue}o=e[0]}(Js({collectionStore:n,feature:o,appConfig:t,collectionContextStore:e,collectionViewBlockStore:i})?r:a).push(s)}return{addedFeatures:r,suggestedFeatures:a}}),[o,t,e])}(t),c={key:"suggested",render:e=>(0,b.jsx)(ne.Z,{...e,title:"Suggested for you"}),items:l.map((e=>({key:e.name,render:r=>{var a,s;return(0,b.jsx)(dn,{showImage:!0,caption:e.description,tooltipImage:null===(a=e.tooltipImage)||void 0===a?void 0:a.img,tooltipImageScale:null===(s=e.tooltipImage)||void 0===s?void 0:s.scale,render:a=>{if((0,le.oX)(e))return(0,b.jsx)(ol,{buttonMenuItemProps:{...(0,On.Z)(r,a)},name:e.name,handleToggleOn:async()=>{const i=function(e){return"notion://tasks/sub_task_feature"===e.uri?{type:"subitemV2"}:"notion://tasks/task_dependencies_feature"===e.uri?{type:"dependencies"}:void 0}(e);i?d.H4({collectionSettingsStore:o,item:i}):await Us.G0({environment:n,feature:e,collectionContextStore:t})}});{const o=new xt.Z,s=el(e,null==i?void 0:i.allFeatures);return(0,b.jsx)(Gs.Z,{buttonPopupStore:o,items:s,getKey:e=>e.name,onSelect:async e=>{await Us.G0({environment:n,feature:e,collectionContextStore:t})},selectedItem:void 0,renderOrigin:t=>(0,b.jsx)(ol,{buttonMenuItemProps:{focused:Boolean(r.focused),...(0,On.Z)(Mt.CE(r,"onClick","focused"),(0,On.Z)(a,t))},name:e.name,handleToggleOn:()=>{o.setState({open:!0})}}),renderItem:e=>(0,b.jsx)(X.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:()=>{}})))},u={key:"added",render:e=>(0,b.jsx)(ne.Z,{...e,title:"Settings"}),items:s.map((e=>({key:e.name,render:t=>{var o,n;return(0,b.jsx)(dn,{showImage:!0,caption:e.description,tooltipImage:null===(o=e.tooltipImage)||void 0===o?void 0:o.img,tooltipImageScale:null===(n=e.tooltipImage)||void 0===n?void 0:n.scale,render:o=>(0,b.jsx)(tl,{buttonMenuItemProps:{...(0,On.Z)(t,o)},name:e.name})})},action:()=>{}})))};return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(ee.Z,{disableInitialScroll:!0,type:ee.i.Vertical,initialFocus:0,sections:[u,c],resetInitialFocusOnSectionChange:!0})})}var il=o(55863),rl=o(98963),al=o(26249),sl=o(93174),ll=o(68641);const cl=(0,s.defineMessages)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"}});function dl(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:i}=e;const l=(0,r.O7)(),c=(0,f.Fg)(),u=(0,a.VK)((()=>o.normalizedDeletedSchemaStore.state),[o]),g=(0,n.useCallback)((()=>{const e=Object.entries(u).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(N.$K);return 0===e.length?(0,b.jsx)(ne.Z,{children:(0,b.jsx)(jr.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,b.jsx)(ne.Z,{children:e.map((e=>{let{propertyId:n,propertySchema:r}=e;return(0,b.jsx)(jr.Z,{title:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,b.jsx)(la.ZP,{type:r.type,icon:r.icon,size:16,theme:c,style:{fill:c.regularIconColor}}),(0,b.jsx)("span",{style:{marginLeft:6,maxWidth:200,...F.Z.textOverflowStyle},children:r.name})]}),right:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Di.Z,{icon:il.s,iconStyle:{marginRight:2},ariaLabel:yo.default.formatMessage(cl.undo),onClick:()=>{!function(e,t,o,n,i){const r=o.collectionStore(),a=(0,ll.jI)({timelineViewTab:n,collectionContextStore:o});if(r){const o=lt.D8({deletedSchema:r.getDeletedSchema(),property:e});if(o){var l;if("verification"===(null===(l=r.getDeletedSchema()[e])||void 0===l?void 0:l.type)){const e=r.getSchema(),t=Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));if(t)return void Z.showDialog({message:(0,b.jsx)(s.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,b.jsx)(s.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}p.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handleRestoreDeletedPropertyClick",environment:i,perform:e=>{ro.xO({environment:i,collectionStore:r,update:o.updateSchema,transaction:e}),ro.$N({collectionStore:r,update:o.updateDeletedSchema,transaction:e})}}),d.z$({collectionSettingsStore:t}),d.H4({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:a}})}}}(n,t,o,i,l)}}),(0,b.jsx)(Di.Z,{icon:P.y,ariaLabel:yo.default.formatMessage(cl.delete),onClick:()=>{!async function(e,t,o){const{automationActions:n}=await sl._1.loader();Z.showDialog({message:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:()=>{const i=t.collectionStore();if(i){const t=function(e,t){const o=e.getDeletedSchema(),n=o[t];if((0,N.$K)(n)&&(0,Jt.D1)(n)&&n.automation_id)return q.Mz.createChildStore(e,{id:n.automation_id,spaceId:e.getSpaceId(),table:rl.cv})}(i,e);p.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,perform:r=>{ro.$N({collectionStore:i,update:{[e]:null},transaction:r}),t&&n.deleteAutomation({automationStore:t,environment:o,transaction:r})}})}}}]})}(n,o,l)}})]})},n)}))})}),[o,t,u,l,c,i]);return(0,b.jsx)(I.ZP,{collectionSettingsStore:t,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:g()})}const ul=n.memo(dl,al.Z);var pl=o(43696),gl=o(33907),ml=o(60458);const Sl=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a project...",id:"database.viewSettings.collectionSettingsExternalListProjects.inputPlaceholder"}});function fl(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,[i,l]=n.useState(""),[c,u]=n.useState(!1),[p,g]=n.useState([]),m=(0,r.O7)(),S=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),y=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().bot_id}),[t]),h=(0,a.VK)((()=>{const{projectCollectionPointer:e}=hl(t.collectionStore());return e}),[t]),[{value:C,status:v}]=(0,x.r5)((async()=>S&&y&&h?se.getProjectsForJiraSite(m,{botId:y,spaceId:S,projectCollectionPointer:h}):null),[m,h,S,y]);(0,n.useEffect)((()=>{const e="success"===(null==C?void 0:C.type)?C.data.existingImportedProjectKeys:[],t="success"===(null==C?void 0:C.type)?C.data.jiraProjects:[];e.length?(u(!0),g(e)):g(t.map((e=>e.key)))}),[C]);const j=(0,f.yK)((e=>({fetchingProjects:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},settingsMenu:{padding:"8px"},projectIcon:{width:20,height:20,borderRadius:4}})),[]);if(!y||!S)return null;const w="pending"===v||"idle"===v,M="rejected"===v||"failed"===(null==C?void 0:C.type),_="success"===(null==C?void 0:C.type)&&"data"in C?C.data.jiraProjects:[],k="success"===(null==C?void 0:C.type)&&"data"in C?C.data.existingImportedProjectKeys:[],V=_.length?(0,zn.ZP)(i,_,(e=>e.name)):[],T=e=>{p.includes(e)?g(p.filter((t=>t!==e))):g([...p,e])},P=V.map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,onClick:()=>{T(e.key)},title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:14,checked:p.includes(e.key),onClick:()=>{T(e.key)},style:{borderRadius:2,marginBottom:14}})}),icon:(0,b.jsx)("img",{src:e.avatarUrls["48x48"],style:j.projectIcon}),caption:(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjects",values:{issues:e.insight.totalIssueCount}})})}),action:()=>{}}))),F=V.filter((e=>k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,onClick:()=>{T(e.key)},title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:14,checked:p.includes(e.key),onClick:()=>{T(e.key)},style:{borderRadius:2,marginBottom:14}})}),icon:(0,b.jsx)("img",{src:e.avatarUrls["48x48"],style:j.projectIcon}),caption:(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.existingSyncedProjects",values:{issues:e.insight.totalIssueCount}})})}),action:()=>{}}))),Z=V.filter((e=>!k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},focused:!1,onClick:()=>{T(e.key)},title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:14,checked:p.includes(e.key),onClick:()=>{T(e.key)},style:{borderRadius:2,marginBottom:14}})}),icon:(0,b.jsx)("img",{src:e.avatarUrls["48x48"],style:j.projectIcon}),caption:(0,b.jsx)("div",{children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjects",values:{issues:e.insight.totalIssueCount}})})}),action:()=>{}})));return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{titleText}",id:"database.viewSettings.collectionSettingsExternalListProjects.title",values:{titleText:c?"Synced projects":"Select projects"}}),header:!w&&!M&&(0,b.jsx)(yl,{inputValue:i,onChange:l}),handleClose:()=>{d.E3({collectionSettingsStore:o})},footer:!w&&!M&&(0,b.jsx)(xl,{onActionButtonClick:()=>{const e={};_.forEach((t=>{p.includes(t.key)&&(e[t.key]=t.insight.totalIssueCount)})),d.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:Jt.K6.SyncProjects,selectedProjectKeys:p,projectIssueCounts:e}})},disabled:!c&&0===p.length}),fullHeight:!0,children:(0,b.jsxs)("div",{children:[!w&&!M&&(0,b.jsx)(b.Fragment,{children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{existingSyncedProjectsCount} projects synced",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsTitle",values:{existingSyncedProjectsCount:k.length.toString()}}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12},onClick:()=>{const e=p.filter((e=>!k.includes(e)));k.every((e=>p.includes(e)))?g(e):g([...e,...k])},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.bulkSelectButtonForSyncedProjects",defaultMessage:"{buttonText}",values:{buttonText:k.every((e=>p.includes(e)))?"Unselect all":"Select all"}})})}),(0,b.jsx)(ee.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},type:ee.i.Vertical,initialFocus:0,sections:[{key:"unsyncedProjects",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:F}]}),(0,b.jsx)(ne.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{unsyncedProjectsCount} unsynced projects",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsTitle",values:{unsyncedProjectsCount:(_.length-k.length).toString()}}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12},onClick:()=>{const e=_.filter((e=>!k.includes(e.key))).map((e=>e.key)),t=p.filter((t=>!e.includes(t)));e.every((e=>p.includes(e)))?g(t):g([...t,...e])},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.bulkSelectButtonForUnsyncedProjects",defaultMessage:"{buttonText}",values:{buttonText:_.filter((e=>!k.includes(e.key))).map((e=>e.key)).every((e=>p.includes(e)))?"Unselect all":"Select all"}})})}),(0,b.jsx)(ee.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},type:ee.i.Vertical,initialFocus:0,sections:[{key:"syncedProjects",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:Z}]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{style:{paddingTop:"0px",paddingBottom:"0px"},title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{buttonText}",id:"database.viewSettings.collectionSettingsExternalListProjects.selectedProjectsTitleForInitialSync",values:{buttonText:p.length===_.length?`All ${_.length} Projects`:`${p.length.toString()} of ${_.length.toString()} projects`}}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12},onClick:()=>{p.length===_.length?g([]):g(_.map((e=>e.key)))},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.bulkSelectButton",defaultMessage:"{buttonText}",values:{buttonText:p.length===_.length?"Unselect all":"Select all"}})})}),(0,b.jsx)(ee.Z,{type:ee.i.Vertical,style:{paddingTop:"0px",paddingBottom:"0px"},initialFocus:0,sections:[{key:"allProjects",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:P}]})]})}),w&&(0,b.jsxs)("div",{style:j.fetchingProjects,children:[(0,b.jsx)("span",{children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListProjects.loadingData",defaultMessage:"Loading projects from Jira..."})}),(0,b.jsx)(Le.Z,{style:{alignSelf:"center"}})]})]})})}function yl(e){const{isMobile:t}=(0,r.Fy)();return(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(dt.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop},children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Whenever a synced project is updated in Jira, those updates will appear in Notion",id:"database.viewSettings.collectionSettingsExternalListProjects.description"})}),(0,b.jsx)(mo.ZP,{focusInitial:!0,value:e.inputValue,showClearButton:!0,onChange:t=>{e.onChange(t.target.value)},placeholder:yo.default.formatMessage(Sl.inputPlaceholder)})]})}function xl(e){const t=(0,f.yK)((e=>({wrapper:{marginLeft:14,marginRight:14,marginTop:12,borderColor:"none"},button:{width:"100%",border:"none",fontWeight:F.Z.fontWeight.medium}})),[]);return(0,b.jsx)("div",{style:t.wrapper,children:(0,b.jsxs)(oe.Z,{style:t.button,onClick:e.onActionButtonClick,disabled:e.disabled,children:[(0,b.jsx)(pi.F,{color:"blue",viewIcon:"/icons/target_gray.svg",viewType:"board",style:{marginRight:6}}),(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Select properties to sync ",id:"database.viewSettings.collectionSettingsExternalListProjects.selectProperties"}),(0,gl.n)({width:14,marginLeft:6})]})})}function hl(e){let t=null,o=null;if(!e)return{projectCollectionPointer:t,taskCollectionPointer:o};const n=e.getFormat();if(n.app_config_uri===R.wW){t=e.pointer;const n=e.getSchema()[R.zI.ProjectToTaskRelation];n&&(0,Jt.p_)(n)&&n.collection_pointer&&(o=n.collection_pointer)}else if(n.app_config_uri===R.iS){o=e.pointer;const n=e.getSchema()[R.Es.TaskToProjectRelation];n&&(0,Jt.p_)(n)&&n.collection_pointer&&(t=n.collection_pointer)}return{projectCollectionPointer:t,taskCollectionPointer:o}}const Cl=new Map([[R.Es.Status,"status"],["title","title"],[R.Es.Priority,"priority"],[R.Es.Tags,"tags"],[R.Es.Assign,"assignee"],[R.Es.DueDate,"duedate"],[R.Es.SubTaskRelation,"subtasks"],[R.Es.ParentTaskRelation,"parent_task"],[R.Es.BlockingRelation,"blocking_tasks"],[R.Es.BlockedRelation,"blocked_by_tasks"],[R.Es.TaskToProjectRelation,"task_to_project"]]);new Map([[R.zI.Status,"status"],["title","title"],[R.zI.Priority,"priority"],[R.zI.Collaborators,"collaborators"],[R.zI.CompletionRollup,"completion_rollup"],[R.zI.People,"people"],[R.zI.ProjectDates,"project_dates"],[R.zI.ProjectToTaskRelation,"project_to_task"]]);var vl=o(51077),bl=o(63296),jl=o(49579);const wl=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.inputPlaceholder"}}),Ml=Cl,_l=["attachment"],kl=new Map([["user","person"],["attachment","file"],["array","multi_select"],["option","select"],["option-with-child","select"],["number","number"],["datetime","date"],["date","date"],["priority","select"],["issuetype","select"],["string","text"],["default","text"]]);function Vl(e){const{collectionSettingsStore:t,collectionContextStore:o,action:i,selectedProjectKeys:l}=e,[c,u]=n.useState(""),[p,g]=n.useState([]),m=(0,f.Fg)(),[S,y]=n.useState(!1),[h,C]=n.useState(!1),v=(0,r.O7)(),j=(0,a.VK)((()=>o.collectionStore()),[o]),w=(0,a.VK)((()=>null==j?void 0:j.getSpaceId()),[j]),M=(0,a.VK)((()=>{var e;return null==j||null===(e=j.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[j]),_=(0,a.VK)((()=>null==j?void 0:j.getFormat().bot_id),[j]),[{value:k}]=(0,x.r5)((async()=>w&&M?await se.getFieldsForJiraIssues(v,{spaceId:w,site:M}):null),[v,w,M]);if(!h&&"success"===(null==k?void 0:k.type)&&"data"in k){const e=k.data.fields.filter((e=>!p.find((t=>t.id===e.id)))).map((e=>{var t;const o=_l.includes(e.id);return{id:e.id,name:e.name,isSelected:o,isRequired:o,currentlySyncing:o,type:kl.get((null==e||null===(t=e.schema)||void 0===t?void 0:t.type)??"default")}}));C(!0),g((t=>[...t,...e]))}const V=(0,a.VK)((()=>null==j?void 0:j.getFormat()),[j]),T=(0,a.VK)((()=>null==j?void 0:j.getSchema()),[j]),P=(0,a.VK)((()=>{const e=o.collectionViewBlockStore();return"notion://projects_collection"===(null==V?void 0:V.app_config_uri)?(0,jl.M)(e,null==T?void 0:T["notion://projects/project_to_task_relation"]):j}),[o,T,V,j]),F=(0,a.VK)((()=>null==P?void 0:P.getSchema()),[P]);(0,n.useEffect)((()=>{const e=[];F&&Object.entries(F).forEach((t=>{let[o,n]=t;if(("relation"!==(null==n?void 0:n.type)||null==n||!n.connectedRelation)&&(null!=n&&n.derived_property_record_metadata||Ml.has(o))){var i;const t="title"===o?"Task Name (Summary)":(null==n?void 0:n.name)??Ml.get(o)??"",r=(null==n||null===(i=n.derived_property_record_metadata)||void 0===i?void 0:i.external_object_attribute)??Ml.get(o)??"";e.push({id:r,name:t,isSelected:!0,currentlySyncing:!0,isRequired:Ml.has(o)||_l.includes(r),type:null==n?void 0:n.type})}})),g((t=>[...t,...e]))}),[F]);const Z=(0,f.yK)((e=>({settingsMenu:{padding:"8px"}})),[]),B=p.length?(0,zn.ZP)(c,p,(e=>e.name)):[],A=e=>{g(p.map((t=>t.id===e.id?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!e.isSelected,currentlySyncing:e.currentlySyncing,type:e.type}:t)))},K=B.filter((e=>e.isRequired)).map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{focused:!1,onClick:()=>{A(e)},disabled:e.isRequired,title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:16,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{A(e)},style:{borderRadius:2}})}),icon:(0,b.jsx)(la.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),O=B.filter((e=>!e.isRequired&&e.currentlySyncing)),D=B.filter((e=>!e.isRequired&&!e.currentlySyncing&&S)),R=O.map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{focused:!1,onClick:()=>{A(e)},title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:16,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{A(e)},style:{borderRadius:2}})}),icon:(0,b.jsx)(la.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),L=D.map((e=>({key:e.id,render:()=>(0,b.jsx)(X.Z,{focused:!1,onClick:()=>{A(e)},title:(0,b.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,b.jsx)("div",{children:(0,b.jsx)(ml.Z,{size:16,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{A(e)},style:{borderRadius:2}})}),icon:(0,b.jsx)(la.ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}})));return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Synced task properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.title"}),header:(0,b.jsx)(Tl,{inputValue:c,onChange:u}),handleClose:()=>{d.E3({collectionSettingsStore:t})},footer:(0,b.jsx)(Pl,{action:i,onSubmit:async()=>{if(!(j&&_&&w))return;const{projectCollectionPointer:o,taskCollectionPointer:n}=hl(j);if(!o||!n)return;const i=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source)),r=p.filter((e=>e.isSelected)).map((e=>e.id));_l.forEach((e=>{r.includes(e)||r.push(e)})),await se.syncJiraProjects(v,{botId:_,projectKeys:l,projectIssueCounts:e.projectIssueCounts,spaceId:w,properties:r,projectCollectionPointer:o,taskCollectionPointer:n,onlyUpdateProperties:!i}),d.E3({collectionSettingsStore:t})}}),fullHeight:!0,children:(0,b.jsx)("div",{style:Z.settingsMenu,children:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{requiredPropertyCount} required properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.requiredPropertiesTitle",values:{requiredPropertyCount:Ml.size}}),children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"requiredProperties",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:K}]})}),R.length>0&&(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{syncedOptionalPropertyCount} synced properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncedOptionalPropertiesTitle",values:{syncedOptionalPropertyCount:R.length.toString()}}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>{p.filter((e=>e.currentlySyncing&&!e.isRequired)).every((e=>e.isSelected))?g(p.map((e=>!e.isRequired&&e.currentlySyncing?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!1,currentlySyncing:e.currentlySyncing,type:e.type}:e))):g(p.map((e=>e.currentlySyncing?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!0,currentlySyncing:e.currentlySyncing,type:e.type}:e)))},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListTaskProperties.bulkSelectButtonForSyncedOptionalProperties",defaultMessage:"{buttonText}",values:{buttonText:p.filter((e=>e.currentlySyncing&&!e.isRequired)).every((e=>e.isSelected))?"Unselect all":"Select all"}})}),children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"syncedOptionalProperties",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:R}]})}),h&&S&&(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{sectionText}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.unsyncedOptionalPropertiesTitle",values:{sectionText:R.length?`${L.length.toString()} unsynced properties`:`${L.length.toString()} optional properties`}}),right:(0,b.jsx)(ni.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>{p.filter((e=>!e.currentlySyncing&&!e.isRequired)).every((e=>e.isSelected))?g(p.map((e=>e.isRequired||e.currentlySyncing?e:{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!1,currentlySyncing:e.currentlySyncing,type:e.type}))):g(p.map((e=>e.currentlySyncing?e:{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!0,currentlySyncing:e.currentlySyncing,type:e.type})))},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListTaskProperties.bulkSelectButtonForUnsyncedOptionalProperty",defaultMessage:"{buttonText}",values:{buttonText:p.filter((e=>!e.currentlySyncing)).every((e=>e.isSelected))?"Unselect all":"Select all"}})}),children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"unsyncedOptionalProperties",render:e=>(0,b.jsx)(ne.Z,{topBorder:!1,...e}),items:L}]})}),(0,b.jsx)(X.Z,{focused:!1,onClick:e=>{y(!S)},left:S&&!h?(0,b.jsx)(Le.Z,{style:{alignSelf:"right"}}):(0,b.jsx)(Di.Z,{icon:po.o,ariaLabel:"Icon to toggle all optional properties display"}),title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalListTaskProperties.showAllProperties",defaultMessage:"{showOrHideAllProperties}",values:{showOrHideAllProperties:S?"Hide all properties":"Show all properties"}})})]})})})}function Tl(e){const{isMobile:t}=(0,r.Fy)();return(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(dt.Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop},children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Select which Jira issue properties are synced as Notion properties in Tasks",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.description"})}),(0,b.jsx)(mo.ZP,{focusInitial:!0,value:e.inputValue,showClearButton:!0,onChange:t=>{e.onChange(t.target.value)},placeholder:yo.default.formatMessage(wl.inputPlaceholder)})]})}function Pl(e){const t=(0,f.yK)((e=>({wrapper:{marginLeft:14,marginRight:14,marginTop:12,borderColor:"none"},button:{width:"100%",border:"none",fontWeight:F.Z.fontWeight.medium,color:"rgba(35, 131, 226, 1)"}})),[]);return e.action===Jt.K6.SyncProjects?(0,b.jsx)("div",{style:t.wrapper,children:(0,b.jsxs)(bl.Z,{style:t.button,backgroundColor:"rgba(35, 131, 226, 0.07)",onClick:e.onSubmit,children:[(0,b.jsx)(pi.F,{color:"blue",viewIcon:"/icons/target_gray.svg",viewType:"board",style:{marginRight:6}}),(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sync projects",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton"})]})}):(0,b.jsx)("div",{style:t.wrapper,children:(0,b.jsxs)(bl.Z,{style:t.button,backgroundColor:"rgba(35, 131, 226, 0.07)",onClick:e.onSubmit,children:[(0,b.jsx)(vl.Z,{type:"image_url",size:18,imageURL:y.Z.images.appPackages.projectsIconSvg,style:{marginRight:4}}),(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sync additional properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncAdditionalProperties"})]})})}var Fl=o(42696),Zl=o(86793),Bl=o(43224);const Il=(0,s.defineMessages)({CollectionSettingsExternalSourceTitle:{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.tabTitle"},CollectionSettingsExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.description",defaultMessage:"Display Jira projects and issues inside Notion"}}),Al=12;function Kl(e){var t,o;const{collectionSettingsStore:n,collectionContextStore:i}=e,l=(0,s.useIntl)(),{isMobile:c}=(0,r.Fy)(),d=(0,a.VK)((()=>i.collectionStore()),[i]),u=(0,a.VK)((()=>null==d?void 0:d.getFormat()),[d]),p=(0,a.VK)((()=>null==d?void 0:d.getSchema()),[d]),g=(0,a.VK)((()=>{var e;return null==d||null===(e=d.getFormat())||void 0===e?void 0:e.external_collection_type}),[d]),m=g?$a[g]:"",S=(0,a.VK)((()=>{const e=i.collectionViewBlockStore();return(0,jl.M)(e,(null==u?void 0:u.app_config_uri)===R.wW?null==p?void 0:p[R.zI.ProjectToTaskRelation]:null==p?void 0:p[R.Es.TaskToProjectRelation])}),[i,p,u]),y=(0,f.yK)((e=>({collectionSettingsExternalSourceTitle:{marginLeft:12,fontSize:c?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.text.secondary},preview:{padding:"12px 36px 12px 30px",background:e.v2.surface.wash,display:"flex",justifyContent:"flex-start",marginLeft:14,marginRight:14},container:{marginLeft:12,marginRight:12},lastSyncText:{fontSize:c?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:F.Z.fontWeight.regular,textAlign:"left",marginLeft:14,lineHeight:F.Z.lineHeight.UISmall.desktop},captionText:{fontSize:c?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:F.Z.fontWeight.regular,textAlign:"left",marginLeft:14},sourceSectionTitle:{textAlign:"left",color:e.text.secondary},siteButtonContainer:{margin:"6px 14px 6px 14px",gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.deemphasized},siteButton:{padding:"4px 30px 4px 8px",borderRadius:4,gap:8,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:c?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop,fontWeight:F.Z.fontWeight.regular,lineHeight:"18px",letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:c?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:e.text.secondary,fontWeight:F.Z.fontWeight.regular,textAlign:"left",lineHeight:c?F.Z.lineHeight.UISmall.mobile:F.Z.lineHeight.UISmall.desktop},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[c]);if(!d||!S)return null;const x=(null==u?void 0:u.app_config_uri)===R.wW;return(0,b.jsxs)(I.ZP,{collectionSettingsStore:n,title:l.formatMessage(Il.CollectionSettingsExternalSourceTitle),children:[(0,b.jsx)(ne.Z,{disableMobileBorders:!0,children:(0,b.jsx)("div",{style:y.collectionSettingsExternalSourceTitle,children:(0,b.jsx)(s.FormattedMessage,{...Il.CollectionSettingsExternalSourceDescription})})}),(0,b.jsx)("div",{style:y.preview,children:Dl({projectCollectionStore:x?d:S,taskCollectionStore:x?S:d,integrationIconUrl:m})}),(0,b.jsxs)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.sourceSite"}),style:y.sourceSectionTitle,children:[(0,b.jsx)("div",{style:y.lastSyncText,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{lastSyncedAt}",id:"database.viewSettings.collectionSettingsExternalSource.lastSynced",values:{lastSyncedAt:null!=u&&null!==(t=u.sync_state)&&void 0!==t&&t.last_synced_at?`Last synced at ${new Date(null==u||null===(o=u.sync_state)||void 0===o?void 0:o.last_synced_at).toLocaleString()}`:"Not synced yet"}})}),(0,b.jsx)("div",{style:y.siteButtonContainer,children:(0,b.jsx)(O.Z,{style:y.siteButton,disallowTabbing:!0,disabled:!0,children:(0,b.jsxs)("div",{style:y.siteButtonTextContainer,children:[Rl({iconStyle:{width:20,height:20,marginTop:6},srcUrl:m}),(0,b.jsxs)("div",{style:{display:"flex",flexFlow:"column",gap:1},children:[(0,b.jsx)("span",{style:y.siteNameText,children:Ol(null==u?void 0:u.synced_collection_external_url)}),(0,b.jsx)("span",{style:y.siteNameSecondaryText,children:null==u?void 0:u.synced_collection_external_url})]})]})})})]}),(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Data synced from jira",id:"database.viewSettings.collectionSettingsExternalSource.titleStringForSyncedData"}),children:Ll({taskCollectionStore:x?S:d,collectionSettingsStore:n})})]})}function Ol(e){var t;const o=null==e?void 0:e.split("/");return(null==o||null===(t=o[2])||void 0===t||null===(t=t.split("."))||void 0===t?void 0:t[0])||""}function Dl(e){const{projectCollectionStore:t,taskCollectionStore:o,integrationIconUrl:n}=e,i=(0,f.yK)((e=>({iconContainer:{display:"flex",alignItems:"center"},sourceIcon:{width:26,height:26,padding:"3.5px 3.5px 2.5px 2.5px",borderRadius:6,gap:10,borderColor:e.stroke.regular,borderStyle:"solid",borderWidth:1,boxShadow:"0px 2px 4px 0px #161D1B05"},taskArrow:{width:87,height:26,top:26},projectArrow:{width:87,height:26,top:2,border:1},arrowContainer:{display:"flex",flexFlow:"column",justifyContent:"center"},collectionIconContainer:{display:"flex",flexFlow:"column",justifyContent:"space-around",gap:12},collectionIcon:{width:88,padding:"4px 6px 6px 6px",borderRadius:6,gap:6,display:"flex",alignItems:"center",borderColor:e.stroke.regular,borderWidth:1,borderStyle:"solid",background:`linear-gradient(0deg, ${e.text.contrast}, ${e.text.contrast})`},title:{fontSize:Al,fontWeight:F.Z.fontWeight.medium,lineHeight:F.Z.lineHeight.UISmall.desktop,letterSpacing:0}})),[]),r=(0,a.VK)((()=>t.getIcon()),[t]),s=(0,a.VK)((()=>o.getIcon()),[o]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:i.iconContainer,children:Rl({iconStyle:i.sourceIcon,srcUrl:n})}),(0,b.jsxs)("div",{style:i.arrowContainer,children:[Rl({iconStyle:i.projectArrow,srcUrl:y.Z.images.externalIntegrations.externalAppToProjectsArrowPng}),Rl({iconStyle:i.taskArrow,srcUrl:y.Z.images.externalIntegrations.externalAppToTasksArrowPng})]}),(0,b.jsxs)("div",{style:i.collectionIconContainer,children:[(0,b.jsxs)("div",{style:i.collectionIcon,children:[r?(0,b.jsx)(ii.Z,{icon:r,isEmptyPage:!1,size:20,disabled:!0}):(0,Fl.t)({height:20,width:20}),(0,b.jsx)(qa.Z,{store:t,style:i.title})]}),(0,b.jsxs)("div",{style:i.collectionIcon,children:[s?(0,b.jsx)(ii.Z,{icon:s,isEmptyPage:!1,size:20,disabled:!0}):(0,Fl.t)({height:20,width:20}),(0,b.jsx)(qa.Z,{store:o,style:i.title})]})]})]})}function Rl(e){const{iconStyle:t,srcUrl:o,altString:n}=e;return(0,b.jsx)("img",{style:t,src:o,alt:n})}function Ll(e){let{taskCollectionStore:t,collectionSettingsStore:o}=e;const n=(0,a.VK)((()=>t.getSchema()),[t]),i=(0,a.VK)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.syncing}),[t]);let r=0;for(const a in n){var l;null!==(l=n[a])&&void 0!==l&&l.derived_property_record_metadata&&r++}return(0,b.jsx)(ln.ZP,{disableTooltip:!Boolean(i),renderTooltip:e=>(0,b.jsx)("div",{...e,style:Bl.F6,children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalSource.displayMessageToDisallowEdits",defaultMessage:"Can not be edited while sync is in progress"})}),render:e=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.Z,{...e,icon:Zl.D,disabled:Boolean(i),onClick:()=>{d.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}})},right:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalSource.projectsSettings",defaultMessage:"Settings"})}),showChevron:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Projects",id:"database.viewSettings.collectionSettingsExternalSource.projects"})}),(0,b.jsx)(A.Z,{...e,icon:wn.N,disabled:Boolean(i),onClick:()=>{d.H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:Jt.K6.SyncAdditionalProperties,selectedProjectKeys:[],projectIssueCounts:{}}})},right:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.collectionSettingsExternalSource.syncedPropertiesCount",defaultMessage:"{syncedPropertiesCountString}",values:{syncedPropertiesCountString:r.toString()}})}),showChevron:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Task Properties",id:"database.viewSettings.collectionSettingsExternalSource.taskProperties"})})]})})}function Hl(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n}}=e;if("external_source"===n)return(0,b.jsx)(Kl,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_projects"===n)return(0,b.jsx)(fl,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_task_properties"===n){const{action:n,selectedProjectKeys:i,projectIssueCounts:r}=e.tabSettings;return(0,b.jsx)(Vl,{collectionSettingsStore:t,collectionContextStore:o,action:n,selectedProjectKeys:i,projectIssueCounts:r})}return(0,b.jsx)(b.Fragment,{})}var zl=o(59862),El=o(17515),Ul=o(26263),Nl=o(28410),Wl=o(20669),Gl=o(3791),ql=o(10910),$l=o(79474),Xl=o(52423),Yl=o(44866),Ql=o(30905),Jl=o(73420),ec=o(91839),tc=o(19124),oc=o(83212),nc=o(88280),ic=o(91965);const rc=(0,s.defineMessages)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function ac(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,doesUserHaveAIAddOn:a}=e;const c=(0,n.useRef)((0,l.ZP)()),d=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(a||null!=r&&r.auto_update_on_edit))return void Yl.triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,a,i,o]);return r?(0,b.jsx)(ln.ZP,{renderTooltip:()=>(0,b.jsxs)("div",{style:{width:159},children:[(0,b.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,b.jsx)(s.FormattedMessage,{...rc.autoUpdateExplanationMessage})}),!a&&(0,b.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,b.jsx)(s.FormattedMessage,{...rc.onlyWithAiAddOnMessage})})]}),render:e=>(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{...rc.updateOnPageEdits}),showChevron:!1,right:(0,b.jsx)(sn.Z,{inputId:c.current,on:!!r.auto_update_on_edit,onClick:d,disabled:!1,noColor:!1}),onClick:d,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var sc=o(1743);const lc=(0,s.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function cc(e){var t;let{environment:o,aiInference:i,setAiInference:r,collectionContextStore:l,isAutofillSetupEnabled:c,shouldShowUserPromptIsInvalidError:d,setShouldShowUserPromptIsInvalidError:u}=e;const p=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:lc.extractPromptSectionTitle,inputPlaceholder:lc.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:lc.customPromptSectionTitle,inputPlaceholder:lc.customPromptInputPlaceholder,value:e.prompt};default:(0,N.t1)(e)}}(i),g=(0,a.VK)((()=>(0,fo.k4)()),[]),m=(0,n.useCallback)((e=>{if(l.collectionStore()&&p)switch(e.target.value&&e.target.value.length<=Nl.Th?u(!1):e.target.value.length>Nl.Th&&u(!0),p.aiInferenceType){case"extract":case"custom":r({type:p.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g});break;case"select":case"multi_select":r({type:p.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g,add_options:((null==i?void 0:i.type)===p.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,N.t1)(p.aiInferenceType)}}),[i,l,g,p,r,u]);return p?(0,b.jsxs)(ne.Z,{title:yo.default.formatMessage(p.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,b.jsx)(sc.Z,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,b.jsx)(mo.ZP,{inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:d?"1px solid red":void 0},type:"text",value:p.value||"",onChange:m,placeholder:yo.default.formatMessage(p.inputPlaceholder),textarea:!0,disabled:!c,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},p.aiInferenceType)}),d&&(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,Ma.t)({width:12,height:12,fill:"#D34F43"}),(0,b.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=p.value)||void 0===t?void 0:t.length)??0)>Nl.Th?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function dc(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:s,doesUserHaveAIAddOn:l}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.Z,{style:{marginBottom:10},children:[(0,b.jsx)(ac,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,doesUserHaveAIAddOn:l}),(0,b.jsx)(ic.Z,{setAiInference:i,aiInference:n})]}),n&&(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(cc,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:a,setShouldShowUserPromptIsInvalidError:s})})]}):null}o(30541);var uc=o(87205),pc=o(5257),gc=o(43765),mc=o(99417);const Sc=new xt.Z,fc=(0,s.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function yc(e){const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:a,setDraftAiInference:s,environment:l,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p,doesUserHaveAIAddOn:g}=e,m=(0,f.Fg)(),S=(0,n.useMemo)((()=>[new xt.Z,new xt.Z]),[]),y=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:a,theme:s,optionsButtonPopupStores:l}=e;if(!n||!(0,Jt.MD)(n.type))return[];switch(n.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=Mt.oA((0,N.Yd)(i).map((e=>{if(e===a)return;const t=i[e];if(t&&(0,uc.K9)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,b.jsx)(la.ZP,{icon:t.icon,type:t.type,theme:s,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;l.length<2;)l.push(new xt.Z);return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:fc.whatToTranslate,selectAllTitle:fc.allProperties,buttonPopupStore:l[0]},{type:"single",options:uc.nI.map((e=>{let{key:t,name:o}=e;return{id:t,option:yo.default.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:fc.translateTo,buttonPopupStore:l[1]}];default:(0,N.t1)(n)}}({environment:l,aiInference:a,collectionSchema:d,setAiInference:s,property:c,theme:m,optionsButtonPopupStores:S})),[l,a,d,s,c,m,S]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.Z,{style:{marginBottom:10},children:[(0,b.jsx)(xc,{propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:a,setDraftAiInference:s,environment:l}),(0,Jt.by)(a,"text")&&(0,b.jsx)(ac,{collectionContextStore:t,environment:l,setAiInference:s,aiInference:a,doesUserHaveAIAddOn:g})]}),(0,Jt.by)(a,"text")&&(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(cc,{environment:l,aiInference:a,setAiInference:s,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p}),(0,b.jsx)(Cc,{environment:l,optionProps:y})]})]})}function xc(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:i,setDraftAiInference:r,environment:l}=e;const c=(0,a.VK)((()=>(0,fo.k4)()),[]),d=(0,n.useCallback)((e=>{var n,i,a,s,l,d,u,p;if(!t||!(0,Jt.qQ)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:c};break;case"translate":g={type:e,auto_update_on_edit:c,targetProperties:(null===(n=t.ai_inference)||void 0===n?void 0:n.type)===e?null===(i=t.ai_inference)||void 0===i?void 0:i.targetProperties:["title"],toLanguage:(null===(a=t.ai_inference)||void 0===a?void 0:a.type)===e?null===(s=t.ai_inference)||void 0===s?void 0:s.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(l=t.ai_inference)||void 0===l?void 0:l.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:c};break;case"custom":g={type:e,prompt:(null===(u=t.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=t.ai_inference)||void 0===p?void 0:p.prompt:o[e]??"",auto_update_on_edit:c};break;default:(0,N.t1)(e)}r(g)}),[c,o,t,r]),u=(0,f.Fg)();return t&&(0,Jt.qQ)(t)?(0,b.jsx)(Y.ZP,{popupType:l.device.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,buttonPopupStore:Sc,render:e=>{const t={key:"section",render:e=>(0,b.jsx)(ne.Z,{...e}),items:Mt.oA(Object.keys(mc.OE.text).map((t=>{if((0,Jt.MD)(t))return{key:t,render:e=>{const o=mc.OE.text[t];return(0,b.jsx)(X.Z,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:u.aiPurpleColor}),title:yo.default.formatMessage(o.name),checkState:(null==i?void 0:i.type)===t})},action:()=>{e.close(),d(t)}}})))};return(0,b.jsx)(J.Z,{menuType:so.og.Popup,minWidth:260,maxWidth:"100vw",children:(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginLeft:4,marginRight:4,marginTop:8,paddingLeft:12,paddingRight:12,cursor:"pointer",height:28},onClick:t,children:[(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),(0,b.jsx)(hc,{aiActionType:null==i?void 0:i.type})]})}}):null}function hc(e){let{aiActionType:t}=e;const o=(0,f.Fg)(),n=t&&(0,Jt.MD)(t)?mc.OE.text[t]:{name:fc.noAiAutofillSelected,svg:()=>null};return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,b.jsx)("div",{style:{color:o.lightIconColor},children:n.svg({height:16,width:16,marginRight:2})}),(0,b.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,b.jsx)(s.FormattedMessage,{...n.name})}),(0,b.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,pc.o)({height:12,width:12})})]})}function Cc(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,b.jsx)(ne.Z,{title:yo.default.formatMessage(fc.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,b.jsx)(vc,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,b.jsx)(bc,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function vc(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:r,selectorTitle:l,selectAllTitle:c,buttonPopupStore:d}=e;const[u,p]=(0,n.useState)(""),g=(0,f.Fg)(),m=o.filter((e=>i.includes(e.id))),S=(0,a.VK)((()=>Mt.jj(Mt.MR(o.map((e=>e.id)))).join(",")===Mt.jj(Mt.MR(i)).join(",")),[o,i]),y=e=>{i.includes(e)?r(i.filter((t=>t!==e))):r(Mt.jj([...i,e]))},x=()=>{i.length<o.length?r(o.map((e=>e.id))):r(["title"])},h=(0,b.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,b.jsx)(mo.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:u,onChange:e=>{p(e.target.value)},placeholder:yo.default.formatMessage(fc.selectorSearchPlaceholder)})});return(0,b.jsx)(Y.ZP,{popupType:t.device.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,buttonPopupStore:d,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(u.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,b.jsx)(X.Z,{focused:!1,onClick:e.onClick,left:(0,b.jsx)(ml.Z,{checked:i.includes(t),size:14,checkSize:8,onClick:e=>{y(t)}}),icon:n,title:o}),action:()=>{y(t)}}})),n={key:"section",render:e=>(0,b.jsx)(ne.Z,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,b.jsx)(ne.Z,{...e}),items:[{key:"all-items",render:e=>(0,b.jsx)(X.Z,{focused:!1,onClick:()=>{x()},left:(0,b.jsx)(ml.Z,{checked:S,size:14,checkSize:8,onClick:()=>{x()}}),title:yo.default.formatMessage(c)}),action:()=>{x()}}]};return(0,b.jsxs)(J.Z,{menuType:so.og.Popup,minWidth:260,maxWidth:"100vw",children:[h,0===t.length?(0,b.jsx)(ne.Z,{children:(0,b.jsx)(gc.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,b.jsx)(A.Z,{title:yo.default.formatMessage(l),showChevron:!0,right:(0,b.jsx)("div",{style:{color:g.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:Mt.oA(m.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:d.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function bc(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:a,buttonPopupStore:l}=e;const[c,d]=(0,n.useState)(""),u=o.find((e=>e.id===i)),p=(0,f.Fg)(),g=(0,b.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,b.jsx)(mo.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:c,onChange:e=>{d(e.target.value)},placeholder:yo.default.formatMessage(fc.selectorSearchPlaceholder)})});return(0,b.jsx)(Y.ZP,{popupType:t.device.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,buttonPopupStore:l,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(c.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:a}=t;return{key:o,render:e=>(0,b.jsx)(X.Z,{focused:!1,onClick:e.onClick,icon:a,title:n,checkState:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,b.jsx)(ne.Z,{...e}),items:t};return(0,b.jsxs)(J.Z,{menuType:so.og.Popup,minWidth:260,maxWidth:"100vw",children:[g,0===t.length?(0,b.jsx)(ne.Z,{children:(0,b.jsx)(gc.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,b.jsx)(A.Z,{title:yo.default.formatMessage(a),showChevron:!0,right:u&&(0,b.jsxs)(b.Fragment,{children:[u.icon,(0,b.jsx)("div",{style:{color:p.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:u.option})]}),rightStyle:{flexShrink:1},rotateChevron:l.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const jc=(0,s.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling “{propertyName}” with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function wc(e){const{property:t,collectionContextStore:o,collectionSettingsStore:i}=e,l=(0,a.VK)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),c=(0,a.VK)((()=>o.collectionStore()),[o]),u=(0,a.VK)((()=>o.normalizedSchemaStore.getState()),[o]),g=l&&(0,Jt.qQ)(l)?(0,Jt.q3)(l):void 0,S=(0,r.O7)(),f=_c(),y=(0,a.VK)((()=>{const e=o.collectionStore();return e&&(0,tc.mX)(S,oc.Z.getMode(S,e),e)}),[S,o]),x=Si.default.createValue({stage:"not_started"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new Ul.Z({name:"CollectionSettingsPropertyAiAutofill"});S.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),a=o.getPropertyFormatKey();return r&&a&&p.createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:S,perform:e=>{rt.er({formatStore:r,formatKey:a,property:t,update:{visible:!0},transaction:e})}}),()=>{S.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,S,t]);const h=(0,n.useRef)({}),C=(0,a.VK)((()=>(0,fo.k4)()),[]),[v,j]=(0,n.useState)(l&&Yl.getDefaultAiInference(l,C)),[w,M]=(0,n.useState)(!1),_=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!l||!(0,Jt.qQ)(l))return;const n=(0,Jt.q3)(l);n&&"prompt"in n&&(h.current={...h.current,[n.type]:n.prompt}),Yl.saveOrRemovePropertyAiInference({environment:S,propertySchema:l,collectionStore:e,property:t,draftAiInference:v})}),[o,l,v,t,S]),k=(0,a.VK)((()=>{var e;return(null===(e=o.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString())||""}),[o]),V=(0,n.useCallback)((async()=>{if(l&&(0,Jt.qQ)(l)&&Mt.Xy(v,(0,Jt.q3)(l)))d.E3({collectionSettingsStore:i});else if(v){var e;if("prompt"in v)if((0,Jt.DS)(v)&&0===(null===(e=v.prompt)||void 0===e?void 0:e.length)||(0,N.$K)(v.prompt)&&v.prompt.length>Nl.Th)return void M(!0);(null==g||!g.auto_update_on_edit)&&null!=v&&v.auto_update_on_edit&&C&&l?await $l.r({sourceAction:"auto_update",propertyName:l.name,collectionName:k})&&_():_()}}),[k,i,g,v,_,C,l]),T=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&g&&l&&(Yl.saveOrRemovePropertyAiInference({environment:S,propertySchema:l,collectionStore:e,property:t,draftAiInference:null}),d.z$({collectionSettingsStore:i}))}),[o,g,S,l,t,i]),F=l&&(0,Jt.qQ)(l)&&Mt.Xy(v,(0,Jt.q3)(l)),B=(0,n.useCallback)((async()=>new Promise((e=>{Z.showDialog({showCancel:!1,keepFocus:!1,message:(0,b.jsxs)(Jl.sg,{alignItems:"center",gap:8,children:[(0,Wl.y)(f.confirmDiscardChangesDialogIconStyle),(0,b.jsx)("div",{style:f.confirmDiscardChangesDialogMessageStyle,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[f]),K=(0,n.useCallback)((async()=>{(F||await B())&&d.z$({collectionSettingsStore:i})}),[F,i,B]),O=(0,n.useCallback)((async()=>{(F||await B())&&d.E3({collectionSettingsStore:i})}),[F,i,B]),D=(0,a.VK)((()=>{var e;const t=(null===(e=nc.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Gl.de)(t)}),[]);return l&&(0,Jt.qQ)(l)&&c?(0,b.jsx)(m.Z,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:O,children:(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:l.name}}),handleBackArrowClick:K,handleClose:O,children:[!y&&(0,b.jsx)(ne.Z,{style:f.menuItemStyle,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===l.type&&(0,b.jsx)(yc,{collectionContextStore:o,propertySchema:l,previousPromptByAiInferenceType:h.current,isAutofillSetupEnabled:Boolean(y),draftAiInference:v,setDraftAiInference:j,environment:S,propertyId:t,collectionSchema:u,shouldShowUserPromptIsInvalidError:w,setShouldShowUserPromptIsInvalidError:M,doesUserHaveAIAddOn:D}),(0,Jt.cu)(l)&&(0,b.jsx)(dc,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(y),draftAiInference:v,setDraftAiInference:j,environment:S,shouldShowUserPromptIsInvalidError:w,setShouldShowUserPromptIsInvalidError:M,doesUserHaveAIAddOn:D}),(0,Jt.by)(v,l.type)&&(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(Mc,{environment:S,isAutofillSetupEnabled:y,collectionContextStore:o,tryAutofillStore:x,propertySchema:l,property:t,aiInference:v}),(0,b.jsx)(oe.Z,{style:{...f.buttonStyle,margin:"8px 12px 12px 12px",display:F?"none":"flex"},onClick:V,disabled:!y,children:F?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,b.jsxs)(ne.Z,{topBorder:!0,title:S.device.isMobile&&yo.default.formatMessage(jc.toggleFillWithAiSectionLabel),children:[(0,Jt.by)(g,l.type)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ql.TB,{environment:S,collectionContextStore:o,collectionStore:c,property:t,propertySchema:l,doesUserHaveAIAddOn:D,isAutofillSetupEnabled:Boolean(y)}),(0,b.jsx)(A.Z,{icon:P.y,isRed:!0,focused:!1,title:yo.default.formatMessage(jc.removeAutofillButton),onClick:T,disabled:!y})]}),(0,b.jsx)(kr.Z,{href:(0,_r.UY)("guides.aiAutofill"),title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function Mc(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:r,propertySchema:c,property:d,aiInference:u}=e;const[p,g]=(0,n.useState)((0,l.ZP)()),m=(0,n.useRef)((0,l.ZP)()),S=(0,a.VK)((()=>r.state.stage),[r]),f=(0,a.VK)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:Mt.oA([(0,Wi.np)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),y=(0,n.useCallback)((()=>{var e;ql.qG(t,{ai_inference_type:u.type,type:"undo_from_collection_settings",inference_id:p,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:m.current}),"not_started"!==S&&(Xl.Yw(t,!1),r.setState({stage:"not_started"}))}),[t,u,p,i,S,r]),x=(0,N.Of)(f.candidateBlockStores),h=_c({isTryAutofillEnabled:o&&x});if(t.device.isMobile)return null;let C;return C=x?"collection"===f.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:c.name}}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,b.jsx)(n.Fragment,{children:(0,b.jsx)("div",{style:{margin:"8px 12px"},children:(0,b.jsxs)(Jl.X2,{gap:8,children:[(0,b.jsx)(ni.Z,{disabled:!o||!x,style:{...h.buttonStyle,...h.undoButtonStyle,..."not_started"===S&&{display:"none"}},onClick:y,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,b.jsx)(ln.ZP,{renderTooltip:()=>(0,b.jsx)("div",{children:C}),render:e=>(0,b.jsx)(ni.Z,{...e,disabled:!o||!x,style:{...h.buttonStyle,...h.tryButtonStyle},hoveredStyle:h.tryButtonHoveredStyle,pressedStyle:h.tryButtonPressedStyle,onClick:async()=>{if((0,N.Of)(f.candidateBlockStores)){const e=(0,l.ZP)();g(e),r.setState({stage:"in_progress"}),await Yl.autofillPropertyForBlocks({environment:t,stores:f.candidateBlockStores,property:d,propertySchema:c,aiInferenceOverride:u,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:m.current,collectionContextStore:i,from:"ai_autofill_settings"}),r.setState({stage:"complete"})}},children:"in_progress"===S?(0,b.jsx)(ec.Z,{}):(0,b.jsxs)(b.Fragment,{children:[(0,Wl.y)({width:16,..."not_started"!==S&&{display:"none"}}),"not_started"!==S?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===f.type?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})})}function _c(e){const t=(0,f.Fg)();return(0,f.yK)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[50],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var kc=o(90559),Vc=o(77657),Tc=o(42853),Pc=o(54119),Fc=o(15560),Zc=o(36596),Bc=o(14976),Ic=o(4850),Ac=o(32363);const Kc=[Vc.U9,Vc.f3,Vc.mQ,Vc.Dv,Vc.Nw];var Oc=o(33954),Dc=o(12205);function Rc(e){const{collectionContextStore:t,onAccept:o,propertySchema:i,disableSuggestions:l}=e,c=(0,r.Fy)(),[d,g]=n.useState(""),m=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:i,searchInput:l,disableSuggestions:c}=e;const[d,g]=(0,n.useState)(!1),m=(0,s.useIntl)(),S=(0,r.O7)(),x=(0,a.VK)((()=>{const e=t.collectionStore();return Boolean(e&&(0,tc.mX)(S,oc.Z.getMode(S,e),e))}),[S,t]),h=(0,a.VK)((()=>{var e;if(!t)return;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,le.YB)((0,Ns.appConfigs)(),o):void 0}),[t]),C=(0,a.VK)((()=>{var e,o;if(!x)return!1;if(void 0!==h)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const n=null===(o=t.collectionStore())||void 0===o?void 0:o.getSchema();return!(n&&Object.keys(n).length>Jt.ci)&&(0,tc.kL)()}),[x,h,t]),v=function(e){let{collectionContextStore:t,propertySchema:o,disableSuggestions:i,hasAiEnabled:l,showAiSuggestions:c,onAccept:d}=e;const g=(0,r.O7)(),m=(0,f.Fg)(),S=(0,s.useIntl)(),y=(0,a.VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,le.YB)((0,Ns.appConfigs)(),o):void 0}),[t]),x=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),h=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat()}),[t]),C=function(e){let{collectionContextStore:t,showAiSuggestions:o}=e;const i=(0,r.O7)(),[a,s]=(0,n.useState)("loading");return(0,n.useEffect)((()=>{o&&"loading"===a&&(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSchema(),n=o?Mt.oA(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[],r=null==e?void 0:e.getFormat(),a=null==e?void 0:e.getSpaceId(),l=null==e?void 0:e.id,c=[];if(null!=r&&r.ai_suggested_properties&&(null==r?void 0:r.ai_suggested_properties.length)>0)null==r||r.ai_suggested_properties.forEach((e=>c.push(e)));else if(a&&l&&e.getName()){const t=await se.getAiSuggestedProperties(i,{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:Mt.oA(Object.values(e.getSchema())),collectionName:(0,Bc.Xh)(e.getName(),e),numSuggestion:Hc});if("success"===t.type){const o=t.data.properties.filter((e=>!n.includes(e.name.toLocaleLowerCase())));c.push(...o),p.createAndCommit({environment:i,perform:t=>{u.FH({stores:[e],update:{ai_suggested_properties:o},transaction:t})},userAction:"propertyType.generateAiSuggestion"})}}const d=c.filter((e=>!n.includes(e.name.toLocaleLowerCase())));s(d)})()}),[t,i,a,o]),a}({collectionContextStore:t,showAiSuggestions:c}),v=(0,a.VK)((()=>(0,tc.kL)()),[]),b=(0,a.VK)((()=>{if(o||i)return[];if(y){const e=Wc({appConfig:y,collectionFormat:h,collectionSchema:x,hasAiEnabled:l});return(v?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(c)return"loading"===C?"loading":C.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!v){return $c((0,fo.W3)({environment:g,collectionContextStore:t}),x)}return[]}),[o,i,y,c,v,h,x,l,C,g,t]),j=(0,a.VK)((()=>"loading"===b?"loading":Object.fromEntries(b.map((e=>{switch(e.type){case"ai_suggestion":return[e.propertySchema.name.toLowerCase(),Ec({collectionContextStore:t,propertyType:e.propertySchema.type,propertyName:e.propertySchema.name,disablePropertyTooltip:!0,intl:S,onAccept:d,isSuggestedProperty:!0})];case"typed":return[e.appConfigFeature.name.toLowerCase(),zc({appConfig:y,suggestedProperty:e.appConfigFeature,isDisabled:!1,environment:g,collectionContextStore:t,theme:m})];case"derived_ai_property":return[fo.SO[e.propertyType].toLowerCase(),Ec({collectionContextStore:t,propertyType:e.propertyType,propertyName:fo.SO[e.propertyType],disablePropertyTooltip:!0,intl:S,iconFill:m.aiPurpleColor,onAccept:d,isSuggestedProperty:!0})]}})))),[y,t,g,S,b,m,d]);return j}({hasAiEnabled:x,showAiSuggestions:C,collectionContextStore:t,propertySchema:o,onAccept:i,disableSuggestions:c}),j=function(e){let{collectionContextStore:t,onAccept:o}=e;const n=(0,r.O7)(),i=(0,f.Fg)(),l=(0,s.useIntl)(),c=(0,a.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),d=(0,a.VK)((()=>(0,tc.kL)()),[]),u=(0,a.VK)((()=>{if(d){return $c((0,fo.W3)({environment:n,collectionContextStore:t}),c)}return[]}),[t,c,n,d]),p=(0,a.VK)((()=>Object.fromEntries(u.map((e=>[fo.SO[e.propertyType].toLowerCase(),Ec({collectionContextStore:t,propertyType:e.propertyType,propertyName:fo.SO[e.propertyType],disablePropertyTooltip:!0,intl:l,iconFill:i.aiPurpleColor,onAccept:o,isSuggestedProperty:!0})])))),[t,l,o,i.aiPurpleColor,u]);return p}({collectionContextStore:t,onAccept:i}),w=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:n,intl:i}=e;const r=(0,a.VK)((()=>Object.fromEntries((0,fo.TP)(t).map((e=>[fo.SO[e].toLowerCase(),Ec({propertyType:e,propertyName:fo.SO[e],collectionContextStore:t,onAccept:n,intl:i,propertySchema:o,isSuggestedProperty:!1})])))),[t,i,n,o]);return r}({propertySchema:o,onAccept:i,intl:m,collectionContextStore:t}),M=function(e){let{collectionContextStore:t,propertySchema:o}=e;const i=(0,r.O7)(),l=(0,s.useIntl)(),c=(0,a.VK)((()=>Dn.Z.bots.state),[]),d=(0,a.VK)((()=>t.collectionStore()),[t]),u=(0,a.VK)((()=>(null==d?void 0:d.getSchema())??{}),[d]),p=(0,a.VK)((()=>!(null==d||!d.isPageTreeCollection())),[d]),g=(0,a.VK)((()=>t.databaseType),[t]),m=(0,a.VK)((()=>{var e;return null===(e=ei.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),S=(0,a.VK)((()=>{if(void 0===o)return function(e,t){if(!e)return[];const o=Qe.default.checkGate("google_drive_connected_relation"),n=Qe.default.checkGate("figma_connected_relation"),i=Qe.default.checkGate("zendesk_connected_relation"),r=Qe.default.checkGate("cron_connected_relation"),a=Qe.default.checkGate("connected_relation"),s=e.getDatabaseType()===R.iS,l=Dn.Z.state;if(!l.loaded)return[];const c=l.integrations,d={};if(!s){const e=c.find((e=>e.id===Vc.U9)),t=(0,Ws.GT)();var u;e&&(d[t.name]={name:t.name,pattern:Ic.x,integration:e,tooltipImage:{img:y.Z.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage}})}const p=[];if(t&&(o&&p.push(Vc.f3),n&&p.push(Vc.mQ),i&&p.push(Vc.Nw)),r&&p.push(Vc.Dv),p.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(d[n.name]||(d[n.name]={name:(0,Ac.ni)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!a)return Object.values(d);for(const m of c)if(m.info.original_url_patterns&&t&&![...Kc,Vc.Ff].includes(m.id))for(const e of m.info.original_url_patterns){var g;null!==(g=e.additional_types)&&void 0!==g&&g.connectedRelation&&(d[e.name]||(d[e.name]={name:(0,Ac.ni)({pattern:e,integration:m}),pattern:e,integration:m}))}return Object.values(d)}(d,m)}),[d,o,m]),f=(0,a.VK)((()=>Boolean(null==d?void 0:d.isSyncedCollection())),[d]),x=(0,Dc.J)(),h=(0,n.useMemo)((()=>{if(null!=S&&S.length)return Object.fromEntries(S.map((e=>{const{isDisabled:o,propertyDisabledTooltip:n}=function(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:a,isSyncedCollection:s,schema:l,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var u;if((0,sa.gi)({isAuthed:Boolean(n.find((e=>e.integration_id===d))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(d===Vc.U9){if(Gc(l,Vc.U9))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(Xc.duplicateGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(Xc.wikiGithubPropertyTooltip)};if(s)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(Xc.syncedDatabaseGithubPropertyTooltip)}}else if(d===Vc.Dv){if(Gc(l,Vc.Dv),o!==R.Fi)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(Xc.nonMeetingsCronPropertyTooltip)};if(Gc(l,Vc.Dv))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(Xc.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:e,bots:c,isSpaceAdmin:x,environment:i,isWikiCollection:p,databaseType:g,isSyncedCollection:f,schema:u,intl:l,isMobile:i.device.isMobile});return[e.name.toLowerCase(),Uc({connectedRelationProperty:e,isDisabled:o,propertyDisabledTooltip:n,environment:i,intl:l,collectionContextStore:t})]})).filter(N.$K))}),[S,c,x,i,p,g,f,u,l,t]);return h}({collectionContextStore:t,propertySchema:o}),_=(0,n.useMemo)((()=>Object.keys(v).splice(0,d?1/0:Lc)),[d,v]),k=!d&&Object.keys(v).length>Lc,V=(0,n.useMemo)((()=>"loading"===v?[]:co().filter(l,_).filter((e=>0===l.length||!w.hasOwnProperty(e.original)&&!(null!=M&&M.hasOwnProperty(e.original)))).flatMap((e=>v[e.original]))),[v,l,_,w,M]),T=(0,n.useMemo)((()=>co().filter(l,Object.keys(j)).flatMap((e=>j[e.original]))),[j,l]),P=(0,n.useMemo)((()=>co().filter(l,Object.keys(w)).flatMap((e=>w[e.original]))),[l,w]),F=(0,n.useMemo)((()=>M?co().filter(l,Object.keys(M)).flatMap((e=>M[e.original])):[]),[M,l]),Z=function(e){let{hasMoreSuggestions:t,filteredSuggestedPropertyItems:o,showAiSuggestions:i,setIsShowingMoreSuggestions:r,hasSearchInput:a,disableSuggestions:l,isLoading:c}=e;const d=(0,f.yK)((e=>({loadingShimmer:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},moreSuggestionsButtonContainer:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.mediumTextColor,fontSize:12}})),[]),u=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,b.jsxs)(ne.Z,{...e,title:yo.default.formatMessage(Xc.suggestedSectionTitle),disableMobileBorders:!0,children:[(0,b.jsx)(Zc.Z,{style:{width:"80%",...d.loadingShimmer}}),(0,b.jsx)(Zc.Z,{style:{width:"50%",...d.loadingShimmer}}),(0,b.jsx)(Zc.Z,{style:{width:"60%",...d.loadingShimmer}}),(0,b.jsx)(Zc.Z,{style:{width:"50%",...d.loadingShimmer}})]}),items:[]})),[d.loadingShimmer]),p=(0,n.useMemo)((()=>({key:"more-suggestions",render:e=>(0,b.jsx)(ne.Z,{disableDesktopPadding:!0,disableMobilePadding:!0,children:(0,b.jsx)(X.Z,{...e,title:(0,b.jsxs)("div",{style:d.moreSuggestionsButtonContainer,children:[(0,b.jsx)(s.FormattedMessage,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,Tc.i)({fill:Nn.ZP.uiGray,width:12,height:12,marginLeft:4})]})})}),action:e=>{r(!0),e.event&&"stopPropagation"in e.event&&e.event.stopPropagation()}})),[r,d.moreSuggestionsButtonContainer]),g=(0,n.useMemo)((()=>l?{key:"suggested",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}:o.length?{key:"suggested",render:e=>(0,b.jsx)(ne.Z,{...e,title:yo.default.formatMessage(Xc.suggestedSectionTitle)}),items:t&&!a?[...o,p]:o}:c&&i&&!a?u:{key:"suggested",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}),[l,o,a,p,c,i,u,t]);return g}({hasMoreSuggestions:k,filteredSuggestedPropertyItems:V,hasSearchInput:l.length>0,showAiSuggestions:C,setIsShowingMoreSuggestions:g,disableSuggestions:Boolean(c||o),isLoading:"loading"===v}),B=function(e){let{filteredAiDerivedPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"autofill",render:e=>(0,b.jsx)(ne.Z,{...e,title:yo.default.formatMessage(Xc.autofillSectionTitle)}),items:t}:{key:"autofill",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}),[t])}({filteredAiDerivedPropertyItems:T}),I=function(e){let{filteredStandardPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"standard",render:e=>(0,b.jsx)(ne.Z,{...e,title:yo.default.formatMessage(Xc.typesSectionTitle)}),items:t}:{key:"standard",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}),[t])}({filteredStandardPropertyItems:P}),A=function(e){let{filteredConnectedPropertyItems:t}=e;const o=(0,n.useMemo)((()=>t.length?{key:"connected",render:e=>(0,b.jsx)(ne.Z,{...e,title:yo.default.formatMessage(Xc.connectedRelationSectionTitle)}),items:t}:{key:"connected",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}),[t]);return o}({filteredConnectedPropertyItems:F}),K=(0,n.useMemo)((()=>o||!l.length||j.hasOwnProperty(l.toLowerCase())||null!=v&&v.hasOwnProperty(l.toLowerCase())||null!=w&&w.hasOwnProperty(l.toLowerCase())||null!=M&&M.hasOwnProperty(l.toLowerCase())?{key:"custom",render:()=>(0,b.jsx)(b.Fragment,{}),items:[]}:{key:"custom",render:e=>(0,b.jsx)(ne.Z,{...e,title:yo.default.formatMessage(Xc.selectToAddNewProperty)}),items:[Ec({collectionContextStore:t,onAccept:i,propertyType:"text",propertyName:l,disablePropertyTooltip:!0,intl:m,isSuggestedProperty:!1})]}),[o,l,j,v,w,M,t,i,m]),O=(0,n.useMemo)((()=>[Z,B,I,A,K]),[Z,B,I,A,K]);return O}({collectionContextStore:t,propertySchema:i,onAccept:o,disableSuggestions:l,searchInput:d}),S=(0,a.VK)((()=>{const e=null==t?void 0:t.collectionStore();if(e)return(0,Bc.Xh)(e.getName(),e)}),[t]),x=(0,a.VK)((()=>t.permissionScopes.state),[t]);return null!=x&&x.isExternallyImportedAndSyncedCollection?null:(0,b.jsxs)(I.ZP,{...e,title:i?yo.default.formatMessage(Xc.changePropertyType):c.isDesktop&&S?yo.default.formatMessage(Xc.newPropertyWithDatabaseName,{databaseName:S}):yo.default.formatMessage(Xc.newProperty),children:[(0,b.jsx)(ne.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,b.jsx)(mo.ZP,{focusInitial:!c.isMobile||void 0,focus:!c.isMobile||void 0,value:d,onChange:e=>{g(e.target.value)},placeholder:yo.default.formatMessage(i?Xc.searchToChangePlaceholder:Xc.searchPlaceholder)})}),(0,b.jsx)(ee.Z,{disableInitialScroll:!0,type:ee.i.Vertical,initialFocus:0,sections:m,resetInitialFocusOnSectionChange:!0})]})}const Lc=4,Hc=10;function zc(e){let{appConfig:t,suggestedProperty:o,isDisabled:n,propertyDisabledTooltip:i,environment:r,collectionContextStore:a,theme:s}=e;const l=a.collectionStore(),c=Es.aQ.deriveTypeUris((null==l?void 0:l.getSchema())??{},null==l?void 0:l.getPropertyMapping()),u=(e,t,o,i)=>{const r=o.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==l||null===(t=l.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,R.jP)(e.uri)&&!c.has(e.uri)})),a=o.dependencies.find((e=>"property"===e.type&&(0,Jt.qQ)(e.propertySchema)&&(0,Jt.q3)(e.propertySchema)));if(r)return(0,b.jsx)(X.Z,{...e,disabled:n,disabledFeedback:n,title:(0,b.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,a?(0,b.jsx)(Pc.Z,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,b.jsx)(Fc.Z,{}):null]}),icon:(0,b.jsx)(la.ZP,{type:r.propertySchema.type,theme:s,icon:i,size:16,style:{fill:s.regularIconColor}})})},p=new xt.Z;return{key:o.name,render:e=>{var n,s;return(0,b.jsx)(dn,{showImage:!i,caption:i??o.description,tooltipImage:i||null===(n=o.tooltipImage)||void 0===n?void 0:n.img,tooltipImageScale:null===(s=o.tooltipImage)||void 0===s?void 0:s.scale,render:n=>{if((0,le.oX)(o))return u({...(0,On.Z)(e,n)},o.name,o,o.icon);{const i=Mt.oA(o.variants.map((e=>{const o=null==t?void 0:t.allFeatures.find((t=>t.uri===e));if(o&&(0,le.oX)(o))return o})));return(0,b.jsx)(Gs.Z,{buttonPopupStore:p,items:i,getKey:e=>e.name,onSelect:async e=>{await Us.G0({environment:r,feature:e,collectionContextStore:a}),d.E3({collectionSettingsStore:a.settingsStore})},selectedItem:void 0,renderOrigin:t=>u({focused:Boolean(e.focused),...(0,On.Z)(Mt.CE(e,"onClick","focused"),(0,On.Z)(n,t))},o.name,i[0],o.icon),renderItem:e=>(0,b.jsx)(X.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{(0,le.oX)(o)?(await Us.G0({environment:r,feature:o,collectionContextStore:a}),d.E3({collectionSettingsStore:a.settingsStore})):p.setState({open:!0})}}}function Ec(e){let{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:a,onAccept:s,iconFill:l,isSuggestedProperty:c}=e;const d={key:n,render:e=>{const s=o&&(null==o?void 0:o.type)===i,c=function(e,t,o){if("auto_increment_id"===t){var n;if(null!=o&&o.type)return yo.default.formatMessage(Oc.zU.convert_to_auto_increment_id_property);const t=e.collectionStore();if(null==t?void 0:t.isPageTreeCollection())return yo.default.formatMessage(Oc.zU.wiki_forbidden_auto_increment_id_property);if(Boolean(null==t?void 0:t.isSyncedCollection()))return yo.default.formatMessage(Oc.zU.synced_database_forbidden_auto_increment_id_property);const i=t&&t.id,r=t&&t.getFormat(),a=t&&(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id),s=t&&t.getSchema(),l=t&&t.getDeletedSchema();if(!(i&&r&&a&&s&&l))return;if(t&&(0,kc.cj)({id:i,format:r,space_id:a,schema:s,deleted_schema:l}))return yo.default.formatMessage(Oc.zU.duplicate_auto_increment_id_property)}}(t,i,o),d=void 0!==c,u=!r&&Yc.hasOwnProperty(i)&&"on"===Qe.default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?a.formatMessage(Yc[i]):void 0;return(0,b.jsx)(Nc,{checkState:s,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:d,tooltip:c??u,badge:"button"===i&&(0,b.jsx)(Ui.Z,{}),iconFill:l})},action:()=>{s(i,c,n)}};return d}function Uc(e){let{connectedRelationProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,intl:a}=e;return{key:t.name,render:e=>(0,b.jsx)(Nc,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:o,tooltip:n,icon:t.integration.info.icon}),action:async()=>{await Us.Jw({environment:i,connectedRelationProperty:t,collectionContextStore:r,intl:a})}}}const Nc=n.memo((e=>{let{buttonMenuItemProps:t,checkState:o,propertyName:i,propertyType:r,isDisabled:a,badge:s,tooltip:l,tooltipImage:c,tooltipImageScale:d,icon:u,iconFill:p}=e;const g=(0,f.Fg)(),m=(0,n.useCallback)((e=>(0,b.jsx)(X.Z,{...e?(0,On.Z)(t,e):t,disabled:a,disabledFeedback:a,title:(0,b.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[i,s]}),checkState:o,icon:(0,b.jsx)(la.ZP,{type:r,theme:g,icon:u,size:16,style:{fill:p??g.regularIconColor}})})),[t,a,i,s,o,r,g,u,p]);return l?(0,b.jsx)(dn,{showImage:!a,caption:l,tooltipImage:a?void 0:c,tooltipImageScale:d,render:e=>m(e)}):m(void 0)}));function Wc(e){let{appConfig:t,collectionFormat:o,collectionSchema:n,hasAiEnabled:i}=e;if(!o||!n)return[];const r=e=>{const t=o.app_config_uri,r=Es.aQ.deriveTypeUris(n??{},o.app_uri_map);if(e.collectionUri!==t)return!1;let a=!0;e.uri===(0,Ws.GT)().uri&&r.has(R.Es.GithubPrsRelation)&&(a=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===t&&(0,R.jP)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||i)&&a},a={};t.allFeatures.forEach((e=>{(0,le.FW)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,le.oX)(t)&&r(t))))))&&(a[e.uri]=e.variants)}));const s=Object.values(a).flat();return t.allFeatures.filter((e=>(0,le.oX)(e)&&!s.find((t=>t===e.uri))?r(e):!!(0,le.FW)(e)&&Boolean(a[e.uri]))).sort(((e,t)=>(0,le.FW)(e)?-1:(0,le.FW)(t)?1:e.dependencies.length-t.dependencies.length))}function Gc(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}Nc.displayName="PropertyButtonMenuItem";const qc=["ai_summary"];function $c(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!qc.includes(e.propertyType)||!o.has(e.propertyType)))}const Xc=(0,s.defineMessages)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI Autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"}}),Yc=(0,s.defineMessages)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"}});var Qc=o(34296),Jc=o(32628);function ed(e){const{collectionContextStore:t,collectionSettingsStore:o,property:i,formatKey:c}=e,u=(0,r.O7)(),p=(0,n.useMemo)((()=>Si.default.createValue("")),[]),g=(0,n.useMemo)((()=>(0,l.ZP)()),[]),m=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]);return m?(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>{no.tW({environment:u,eventName:"abandoned_search",queryLength:p.state.length,sessionId:g,source:Qc.S.Relation}),d.E3({collectionSettingsStore:o})},children:(0,b.jsx)(Jc.Z,{collectionContextStore:t,onAccept:e=>function(e,t,o,n,i,r){const a=o.collectionStore();if(!a)return;no.wd({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:s}=n.state,l=s[s.length-2];l&&"setupRelation"===l.type&&d.z$({collectionSettingsStore:n});d.FK({collectionSettingsStore:n,item:{type:"setupRelation",property:i,formatKey:r,targetCollectionPointer:e.pointer}})}(e,u,t,o,i,c),parentStore:m,context:Qc.S.Relation,searchSessionId:g,inputStore:p})}):null}ed.displayName="CollectionSettingsSelectRelationSource";var td=o(57842),od=o(71268),nd=o(34532);function id(e){const{collectionContextStore:t,collectionSettingsStore:o,property:i,formatKey:l,targetCollectionPointer:c,from:g}=e,m=(0,a.VK)((()=>t.collectionStore()),[t]),S=(0,a.VK)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?q.NW.createChildStore(n,t):void 0}({targetCollectionPointer:c,collectionStore:m,collectionViewBlockStore:e})}),[t,m,c]),f=(0,a.VK)((()=>i?ft.KV(t,i):void 0),[t,i]),y=Boolean(m&&S&&m.id===S.id),x=Boolean("relation"===(null==f?void 0:f.type)&&f.connectedRelation),h=Boolean("subitem"===g),C=Boolean("timeline_arrows_by"===g),v=(0,a.VK)((()=>t.contextType),[t]),j=(0,r.O7)(),w=(0,s.useIntl)(),M=(0,a.VK)((()=>{const e=null==m?void 0:m.getSchema();return void 0===(null==f?void 0:f.name)&&S&&e?ft.m8(w,{targetCollectionStore:S,isSelfRelation:y,sourceSchema:e,createUnique:!0,from:g}):(null==f?void 0:f.name)||""}),[m,null==f?void 0:f.name,S,w,y,g]),[_,k]=(0,n.useState)(M),[V,T]=(0,n.useState)("no_limit"),[P,F]=(0,n.useState)(h||C?{hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1}}:{hasInverseRelation:!1,inverseName:void 0,autoRelate:{enabled:!1}}),Z=_===M,B=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:i,formatKey:l}})}),[o,i,l]),A=(0,n.useCallback)((()=>{if(!P)return;const{hasInverseRelation:e,inverseName:n,autoRelate:r}=P,a=t.collectionStore(),s=t.collectionViewStore();if(!a||!S)return;const{performResult:c}=p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:j,perform:o=>{const c=i??rt.G3({environment:j,collectionStore:a,collectionViewArgs:s&&l?{collectionViewStore:s,format:s.getFormat(),formatKey:l}:void 0,propertyType:"relation",transaction:o});if(Vo.n7({environment:j,collectionContextStore:t,collectionStore:a,property:c,propertyName:_,targetCollectionStore:S,hasInverseRelation:e,inverseName:n,autoRelate:r,propertyLimit:V,intl:w,transaction:o,from:g}),s){var d;const e=(null===(d=s.getFormat().table_properties)||void 0===d?void 0:d.find((e=>e.property===c)))??{property:c,visible:!0};u.FH({stores:[s],update:{table_properties:[...s.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===g&&s?at.km({environment:j,collectionContextStore:t,relationPropertyId:c,transaction:o}):"timeline_arrows_by"===g&&s&&(To.tF({collectionViewStore:s,newProperty:c,transaction:o}),To._p({collectionContextStore:t,relationPropertyId:c,transaction:o})),c}});"subitem"===g||"timeline_arrows_by"===g?(d.z$({collectionSettingsStore:o}),d.H4({collectionSettingsStore:o,item:{type:"main"}})):d.qU({collectionSettingsStore:o,property:c,formatKey:l}),no._H({environment:j,collectionContextStore:t,from:"collectionPage"===v?"page_properties":"view_settings",property_type:"relation"})}),[P,t,S,j,o,i,l,v,_,V,w,g]);return(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,b.jsx)(ne.Z,{children:(0,b.jsx)(mo.ZP,{value:_||"",placeholder:"Property name",onChange:e=>k(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,b.jsx)(nd.Z,{isSelfRelation:y,collectionStore:S,showAs:"chevron",onClick:B,disabled:h}),!g&&(0,b.jsx)(od.U,{selectedKey:V,propertyType:"relation",onChange:e=>T(e)}),S&&!x&&(0,b.jsx)(td.Z,{collectionContextStore:t,targetCollectionStore:S,property:i,propertyName:_,buttonContents:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Add relation",id:"database.viewSettings.setupRelationTab.addButton.title"}),temporaryInverseState:P,setTemporaryInverseState:F,isInitialPropertyName:Z,onSubmit:A,from:g}),(0,b.jsx)(ne.Z,{children:(0,b.jsx)(kr.Z,{href:(0,_r.UY)("guides.relations"),title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var rd=o(72141),ad=o(19584),sd=o(13659),ld=o(29551),cd=o(46978),dd=o(46654),ud=o(88893);function pd(e){let{collectionSettingsStore:t,collectionContextStore:o,integrationName:i,integrationIcon:l,fullHeight:u}=e;const g=(0,r.O7)(),m=(0,f.yK)((e=>({promptTitle:md(e)})),[]),[S,y]=(0,n.useState)(!1),x=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]),{numberOfGuests:h,numberOfUsers:C,isPublic:v}=(0,a.VK)((()=>{const e=nc.subscriptionDataStoreInstance.state?ud.CM(nc.subscriptionDataStoreInstance.state):[],t=(0,ad.m8)(Mt.oA(e.map((e=>[e.userId,e.role]))));if(!x)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const o=(0,dd.YO)(x).map((e=>e.permissionItem));let n=!1,i=!1;for(const l of o)rd.$D(l)?n=!0:rd.ix(l)&&!rd.Wi(l.role)&&(i=!0);const r=Mt.jj(Mt.oA([...o.map((e=>"user_permission"===e.type?e.user_id:void 0)),...i?Object.keys(t):[]])),a=r.filter((e=>"none"!==t[e])).length,s=r.filter((e=>{const n=t[e],i=Boolean(o.filter(rd.jg).find((t=>t.user_id===e)));return Boolean(n&&i&&!rd.YX(n))})).length;return{numberOfGuests:s,numberOfUsers:a+s,isPublic:n}}),[x]);(0,n.useEffect)((()=>{v||1!==C||d.E3({collectionSettingsStore:t})}),[t,v,C]);const j=(0,n.useCallback)((()=>{x&&(S&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;p.createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,perform:e=>{sd.Pk({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:g,store:x}),c.KI(g,{type:S?"restrict":"share"}),d.E3({collectionSettingsStore:t}))}),[t,x,g,S]);if(!x)return null;const w=(0,b.jsx)("div",{style:m.promptTitle,children:(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),M=(0,b.jsxs)(b.Fragment,{children:[0!==h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:C,numberOfGuests:h}})," "]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:C}})," "]}),v&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:i}})]}),_=(0,b.jsx)(ld.gq,{style:{marginTop:10},children:(0,b.jsx)(oe.Z,{style:{flex:"0 0 100%"},isLarge:!0,onClick:j,children:(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),k=(0,b.jsx)(ld.gq,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,b.jsx)("img",{style:{width:40},src:l})}),V=(0,b.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,b.jsx)(X.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:M,icon:(0,b.jsx)(cd.Z,{isSelected:!S}),onClick:()=>{y(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,b.jsx)(X.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,b.jsx)(s.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,b.jsx)(cd.Z,{isSelected:S}),onClick:()=>{y(!0)}})}],render:e=>(0,b.jsx)(ne.Z,{...e})}]});return(0,b.jsx)(I.ZP,{collectionSettingsStore:t,fullHeight:u,children:(0,b.jsxs)(ld.gq,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[k,(0,b.jsxs)("div",{children:[w,V]}),_]})})}const gd=n.memo(pd,al.Z);function md(e){return{color:e.regularTextColor,fontWeight:F.Z.fontWeight.semibold,fontSize:14}}var Sd=o(76205),fd=o(21197),yd=o(34993);const xd=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});function hd(e){var t;const{context:o,collectionSettingsStore:i,collectionContextStore:c}=e,u=(0,r.O7)(),p=(0,a.VK)((()=>c.normalizedSchemaStore.state),[c]),g=(0,a.VK)((()=>c.normalizedFormatStore.state),[c]),m=(0,a.VK)((()=>c.permissionScopes.state),[c]),S=(0,a.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(c)),[c]),f=(0,a.VK)((()=>{const e=c.collectionViewStore();return e?(0,gt.qd)({schema:p,filters:jd(c),getRecordModel:e.getRecordModel}):[]}),[c,p]),y=(0,n.useCallback)((e=>{if(!e)return;const t=c.collectionViewStore(),n=f.find((t=>t.property===e));if(!n||!t)return;const r={id:(0,l.ZP)(),filter:n};yd.iU({environment:u,collectionContextStore:c,temporaryState:{...c.temporaryState.state,propertyFilters:{value:[...jd(c),r]}}}),function(e,t,o,n,i){if(no.wd({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===ll.HV.FilterBar||o===ll.HV.TopbarFilterPopup){vd(t,n);const o=t.getFilterBarItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===ll.HV.ViewSettings){bd(n);const o=t.getFilterOptionsItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}}(r,c,o,i,u)}),[c,i,o,u,f]),x=(0,n.useCallback)((()=>{c.collectionViewStore()&&(S||yd.iU({environment:u,collectionContextStore:c,temporaryState:{...c.temporaryState.state,combinatorFilter:{value:Sd.TI}}}),wd(c,o,i,u))}),[c,i,S,o,u]);return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:m.canConfigureBlock&&(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(A.Z,{icon:S?fd.Q:An.R,isGray:!0,title:S?(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:S&&(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=S.filters)||void 0===t?void 0:t.length)||1}}),onClick:x})}),children:(0,b.jsx)(wo.Z,{schema:p,format:g,getProperties:()=>f.map((e=>e.property)),onAccept:y,inputPlaceholder:yo.default.formatMessage(xd.inputPlaceholder)})})}const Cd=n.memo(hd,al.Z);function vd(e,t){e.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:t})}function bd(e){d.wl({collectionSettingsStore:e,item:{type:"main"}}),d.H4({collectionSettingsStore:e,item:{type:"filters"}})}function jd(e){return e.currentPropertyFiltersStore.state}function wd(e,t,o,n){no.wd({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===ll.HV.FilterBar||t===ll.HV.TopbarFilterPopup?(vd(e,o),d.wl({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===ll.HV.ViewSettings&&(bd(o),d.wl({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const Md=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const _d=function(e){const{context:t,collectionContextStore:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),l=(0,s.useIntl)(),c=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),u=(0,a.VK)((()=>o.normalizedFormatStore.state),[o]),p=(0,a.VK)((()=>kd(o)),[o]);return(0,b.jsx)(I.ZP,{...e,collectionSettingsStore:n,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,b.jsx)(wo.Z,{schema:c,format:u,getProperties:()=>Object.entries(c).filter((e=>{let[t,o]=e;return!p.find((e=>e.property===t))&&(0,sa.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const a=o.collectionViewStore(),s=o.normalizedSchemaStore.state;if(!a||!s)return;const l=null===(r=s[e])||void 0===r?void 0:r.type;no.wd({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:a.getType(),property_type:l});const c={property:e,direction:"ascending"},u=[...kd(o),c];if(yd.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,sorts:{value:u}}}),n===ll.HV.TopbarSortPopup||n===ll.HV.FilterBar){o.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;d.wl({collectionSettingsStore:e,item:{type:"sort"}})}else n===ll.HV.ViewSettings&&(d.wl({collectionSettingsStore:i,item:{type:"main"}}),d.H4({collectionSettingsStore:i,item:{type:"sort"}}))}(e,i,o,t,n),inputPlaceholder:l.formatMessage(Md.inputPlaceholder)})})};function kd(e){return e.currentSortsStore.state}var Vd=o(6758),Td=o(8982),Pd=o(18245);const Fd=function(e){const{collectionContextStore:t,context:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),l=(0,a.VK)((()=>t.collectionViewStore()),[t]),c=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),u=(0,a.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),p=(0,a.VK)((()=>null==l?void 0:l.getType()),[l]);return l&&u&&p?(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,b.jsx)(Td.D,{children:(0,b.jsx)(Vd.Pq,{index:0,level:0,combinatorFilter:u,schema:c,onChange:(e,o)=>function(e,t,o,n){var i;const r=null===(i=n.remoteResult.state)||void 0===i?void 0:i.sizeHint,a=Pd.default.mark("collections.update_filter_lag");Pd.default.measureAfterNextFlush(a,{environment:o,getData:()=>Jn.Y5({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:r})}),yd.iU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryState.state,combinatorFilter:{value:t}}}),no.wd({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,i,t),collectionViewType:p,collectionViewId:l.id,parentStore:l})}),(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),isRed:!0,icon:P.y,onClick:()=>function(e,t,o,n){yd.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryState.state,combinatorFilter:{value:void 0}}}),o===ll.HV.FilterBar&&d.E3({collectionSettingsStore:n});no.wd({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(i,t,o,n)})})]}):null};var Zd=o(57820),Bd=o(1456),Id=o(52387),Ad=o(86650);function Kd(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,i=(0,r.O7)(),[l,c,u,p]=(0,a.VK)((()=>[o.currentPropertyFiltersStore.state,o.currentPropertyFiltersStore.state.map((e=>e.id)),o.permissionScopes.state,(0,gt.yU)(o)]),[o]),g=(0,a.VK)((()=>u.canConfigureBlock?o.currentCombinatorFilterStore.state:void 0),[o,u]),m=(0,n.useCallback)((()=>{d.E3({collectionSettingsStore:o.filterOptionsCombinatorFilterSettingsStore}),l.forEach((e=>{const t=o.getFilterOptionsItemSettingsStore(e);d.E3({collectionSettingsStore:t})}))}),[o,l]);(0,n.useEffect)((()=>m()),[]);const S=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.mediumIconColor},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,b.jsx)("div",{onClick:e=>{(0,$e.ZP)({event:e,context:$e.Af.CollectionSettingsClick,callback:m})},children:(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:p&&(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(Dd,{collectionContextStore:o})}),unconstrainedWidth:!0,children:(0,b.jsxs)(ne.Z,{children:[(c.length>0||g)&&(0,b.jsxs)("div",{style:i.device.isMobile?S.mobile:void 0,children:[g&&(0,b.jsx)(Ld,{collectionContextStore:o}),Rd(i)?(0,b.jsx)(vr.ZP,{direction:"vertical",keys:c,renderKey:e=>{const t=c.indexOf(e);return(0,b.jsx)(Hd,{collectionContextStore:o,filter:l[t],onClick:m})},onDrop:e=>function(e,t,o){const n=o.collectionViewBlockStore();if(!n)return;const i=o.currentPropertyFiltersStore.state,r=Mt.oA(e.map((e=>i.find((t=>t.id===e)))));yd.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,propertyFilters:{value:r}}}),no.wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,i,o),disabled:!u.canConfigureBlock}):c.map((e=>{const t=c.indexOf(e);return(0,b.jsx)(Hd,{collectionContextStore:o,filter:l[t],onClick:m},e)}))]}),(0,b.jsx)(X.Z,{focused:!1,icon:(0,An.R)(S.menuItemIcon),style:S.menuItem,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{m(),function(e,t,o){no.wd({environment:e,collectionContextStore:o,action:"click_new_filter"}),d.H4({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpen.setState(!0)}(i,t,o)}})]})})})}const Od=n.memo(Kd,al.Z);function Dd(e){let{collectionContextStore:t}=e;return(0,b.jsx)(Ad.ZP,{context:Ad.R1.SettingsFilters,collectionContextStore:t})}function Rd(e){return!e.device.isMobile}function Ld(e){let{collectionContextStore:t}=e;const o=(0,r.O7)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Rd(o)&&(0,b.jsx)(br.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,b.jsx)(Bd.B,{context:Zd.P.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function Hd(e){let{filter:t,collectionContextStore:o,onClick:n}=e;const i=(0,r.O7)(),s=(0,a.VK)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Rd(i)&&(0,b.jsx)(br.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,b.jsx)(Id.Z,{id:t.id,context:Zd.P.SettingsFilters,collectionContextStore:o,collectionSettingsStore:s,onClick:n},t.id)]})}const zd=Mt.Ds(((e,t)=>{void 0!==e&&t(e)}),300);function Ed(e){let{value:t,onChange:o}=e;const i=(0,f.yK)((e=>({input:{background:e.contentBackground}})),[]),[r,a]=(0,n.useState)("");return(0,n.useEffect)((()=>{a(t.toString())}),[t]),(0,b.jsx)(g.Z,{type:"number",value:r,inputClassName:"input-hide-arrows",style:i.input,onChange:e=>{const t=e.target.value,n=parseFloat(t);isNaN(n)?zd(void 0,o):zd(n,o),a(t)}})}const Ud=function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;const r=(0,f.Fg)(),l=n[t.property];return(0,a.VK)((()=>o.collectionStore()),[o])&&l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),isTitleUppercase:!1,children:(0,b.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,b.jsx)(Nd,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,b.jsx)("span",{style:{color:r.mediumTextColor,margin:"0 8px"},children:"–"}),(0,b.jsx)(Nd,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,b.jsx)(ne.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),isTitleUppercase:!1,children:(0,b.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,b.jsx)(Nd,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,b.jsxs)("span",{style:{color:r.mediumTextColor,fontSize:12},children:[(0,b.jsx)(hr.Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,b.jsx)(hr.Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null};function Nd(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,b.jsx)(Ed,{value:t[o],onChange:e=>{"size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}})}})}const Wd=function(e){return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(Gd,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,b.jsx)(qd,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})};function Gd(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,a.VK)((()=>(0,Ye.n)(t)),[t]),i=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),r=(0,a.VK)((()=>o.normalizedFormatStore.state),[o]);if(!n||"groupByNumber"!==n.type)return null;const s=r[n.groupByKey];return s?Ir({groupBy:s,schema:i})??null:null}function qd(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;const i=(0,r.O7)(),s=(0,a.VK)((()=>n.collectionViewStore()),[n]),l=(0,a.VK)((()=>n.normalizedSchemaStore.state),[n]),c=(0,a.VK)((()=>function(e,t){return e.normalizedFormatStore.state[t]}(n,t)),[n,t]);if(!c||!s)return null;const d=Or(c);return d?(0,b.jsx)(Ud,{numberGroupBy:d,schema:l,onChange:e=>{if("number"===c.type)p.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:n=>{u.FH({stores:[s],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===c.type){const n=Mt.CE(e.newNumberGroupBy,"property"),r={...c,groupBy:n};p.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:e=>{u.FH({stores:[s],update:{[t]:r,[o]:void 0},transaction:e})}})}no.wd({environment:i,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:c.type})},collectionContextStore:n}):null}const $d=function(e){const{collectionContextStore:t,collectionSettingsStore:o,groupByKey:n,groupsFormatKey:i}=e,s=(0,r.O7)(),l=(0,a.VK)((()=>(0,Ye.n)(o)),[o]),c=(0,a.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,a.VK)((()=>t.collectionViewStore()),[t]),m=(0,a.VK)((()=>null==g?void 0:g.getType()),[g]),S=(0,a.VK)((()=>function(e,t){const o=e.normalizedFormatStore.state;return o[t]}(t,n)),[t,n]),f=(0,a.VK)((()=>t.normalizedSchemaStore.state),[t]),y=(0,a.VK)((()=>t.normalizedFormatStore.state),[t]),x=(0,a.VK)((()=>void 0!==m&&(0,Mr._1)({viewType:m,groupByKey:n})),[n,m]),h=(0,a.VK)((()=>function(e){const t=e.normalizedSchemaStore.state,o=Object.entries(t).sort(Xd).map((e=>e[0]));return o.filter((e=>{const o=t[e];return o&&(0,mr.LG)(o)}))}(t)),[t]);return c&&g&&l&&m&&"groupByProperty"===l.type?(0,b.jsx)(I.ZP,{...e,collectionSettingsStore:o,title:Fr(l.groupByKey,m),children:(0,b.jsx)(wo.Z,{schema:f,format:y,currentProperty:null==S?void 0:S.property,showNoneOption:x,getProperties:()=>h,onAccept:e=>function(e,t,o,n,i,r){const a=o.collectionViewStore(),s=o.normalizedSchemaStore.state;if(!a)return;if(e){const n=s[e];if(!n||!(0,mr.LG)(n))return;const l=(0,mr.fw)(e,n,"collectionTypedView"===o.contextType);p.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{u.FH({stores:[a],update:{[i]:l,[r]:void 0},transaction:e})}}),no.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else p.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{u.FH({stores:[a],update:{[i]:void 0,[r]:void 0},transaction:e})}}),no.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept"});d.wl({collectionSettingsStore:n,item:{type:"main"}}),d.H4({collectionSettingsStore:n,item:{type:"group",groupByKey:i,groupsFormatKey:r}})}(e,s,t,o,n,i)})}):null};function Xd(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return i&&r?i.localeCompare(r,void 0,{sensitivity:"base"}):i?1:r?-1:0}const Yd=(0,s.injectIntl)((function(e){return(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:290,children:(0,b.jsx)(mi.Z,{...e})})}));var Qd=o(8306);const Jd=110,eu=210,tu=223,ou=25,nu=87;function iu(e){const{propertyName:t}=e,o=(0,f.Fg)(),n=(0,f.yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:_t.lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(ne.Z,{children:(0,b.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,b.jsxs)("svg",{style:n.svgContainer,children:[(0,b.jsx)(kt.Z,{startPoint:{x:Jd,y:ou},endPoint:{x:Jd,y:nu},style:n.svgArrowTheme,showArrowHead:!0}),(0,b.jsx)(kt.Z,{startPoint:{x:eu,y:nu},endPoint:{x:tu,y:nu},style:n.svgArrowTheme,showArrowHead:!1}),(0,b.jsx)("circle",{cx:tu,cy:nu,r:_t.Wk,style:n.svgArrowTheme,fill:o.white})]}),(0,b.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,b.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,b.jsx)("span",{children:"🌱"})}),(0,b.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,b.jsx)("span",{children:"🌳"})})]})})})}const ru=(0,s.defineMessages)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const au=(0,s.injectIntl)((function(e,t){const{collectionContextStore:o,collectionSettingsStore:i,formatSetting:l}=e,c=(0,r.Fy)(),g=(0,s.useIntl)(),m=(0,r.O7)(),S="collection_page_properties",[x]=(0,n.useState)("no_limit"),h="subitem"===l,C="timeline_arrows_by"===l,v=(0,a.VK)((()=>o.databaseType),[o]),j=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),w=(0,a.VK)((()=>o.collectionStore()),[o]),M=(0,a.VK)((()=>(null==w?void 0:w.getFormat())??{}),[w]),_=(0,a.VK)((()=>o.collectionViewStore()),[o]),k=(0,a.VK)((()=>null==_?void 0:_.getFormat()),[_]),V=(null==k?void 0:k.subitem_display_mode)??"show",T=(0,a.VK)((()=>{var e;return h?null===(e=o.currentSubitemFormatStoreForCollection.state)||void 0===e?void 0:e.property:C?o.currentArrowsByFormatStore.state:void 0}),[o,h,C]),F=(0,a.VK)((()=>{var e,t;return h?null===(e=o.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:C?null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[o,h,C]),Z=(0,a.VK)((()=>o.permissionScopes.state),[o]),B=(0,a.VK)((()=>ft.NA(o,j)),[o,j]),K=(0,a.VK)((()=>o.normalizedSchemaStore.state),[o]),O=(0,a.VK)((()=>{var e;const t=o.currentSubitemFormatStoreForCollection.state,n=o.currentArrowsByFormatStore.state;let i;return h?i=t?j[t.property]:void 0:C&&(i=n?j[n]:void 0),null===(e=i)||void 0===e?void 0:e.name}),[o,j,h,C]),D=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?ft.m8(g,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:K,createUnique:!0,from:l}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[o,K,g,l]),[R,L]=(0,n.useState)(O||D),H=R===D,z=(0,a.VK)((()=>{const e=o.currentSubitemFormatStoreForCollection.state,t=o.currentArrowsByFormatStore.state;let n;if(h?n=e?j[e.property]:void 0:C&&(n=t?j[t]:void 0),n&&"relation"===n.type){var i;const e=n.property;return e?null===(i=j[e])||void 0===i?void 0:i.name:void 0}}),[o,j,h,C]),E=(0,a.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?ft.aI(g,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:l}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,g,l]),U=(0,a.VK)((()=>"title"===o.normalizedFormatStore.state.table_subitem_toggle_column),[o]),[N,W]=(0,n.useState)({hasInverseRelation:!0,inverseName:z,autoRelate:{enabled:!1}}),[G,q]=(0,n.useState)(0===B.length),$=(0,a.qz)(void 0,xt.Z),X=(0,a.Kw)($),Q=(0,n.useCallback)((()=>ft.NA(o,j)),[o,j]),ee=(0,n.useCallback)((e=>{if(e){const t=j[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=j[e];if(t&&N){const e=t.name;W({hasInverseRelation:null==N?void 0:N.hasInverseRelation,inverseName:e,autoRelate:null==N?void 0:N.autoRelate})}}L(t.name)}}}),[j,N,L]),oe=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;h?(0,Mt.o8)(t.getFormat().table_subitem_toggle_column)&&u.FH({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n}):C&&To.tF({collectionViewStore:t,newProperty:o,transaction:n})}),[h,C]),ie=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:n}=e;h&&at.km({environment:m,collectionContextStore:o,relationPropertyId:t,transaction:n}),C&&To._p({collectionContextStore:o,relationPropertyId:t,transaction:n})}),[h,C,m,o]),re=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,perform:o=>{oe({collectionViewStore:t,newProperty:e,transaction:o}),ie({relationPropertyId:e,transaction:o})}}),ee(e),q(!1),d.E3({collectionSettingsStore:i}),no.wd({action:h?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,q,ee,i,h,oe,ie]),ae=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(p.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,perform:o=>{oe({collectionViewStore:t,newProperty:e,transaction:o})}}),ee(e),q(!1),d.E3({collectionSettingsStore:i}),no.wd({action:h?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,ee,i,h,oe]),se=(0,n.useCallback)((()=>{et.default.afterNextFlush((()=>{q(!0),W({hasInverseRelation:!0,inverseName:E,autoRelate:{enabled:!1}}),L(D)}))}),[E,D]),le=(0,n.useCallback)((()=>{if(!N)return;const{hasInverseRelation:e,inverseName:t,autoRelate:n}=N,r=o.collectionStore(),a=r,s=o.collectionViewStore();r&&a&&(p.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,perform:i=>{const c=rt.G3({environment:m,collectionStore:r,collectionViewArgs:s&&S?{collectionViewStore:s,format:s.getFormat(),formatKey:S}:void 0,propertyType:"relation",transaction:i});return Vo.n7({environment:m,collectionContextStore:o,collectionStore:r,property:c,propertyName:R,targetCollectionStore:a,hasInverseRelation:e,inverseName:t,autoRelate:n,propertyLimit:x,intl:g,transaction:i,from:l}),s&&(oe({collectionViewStore:s,newProperty:c,transaction:i}),ie({relationPropertyId:c,transaction:i})),c}}),d.z$({collectionSettingsStore:i}),d.H4({collectionSettingsStore:i,item:{type:"main"}}),no._H({environment:m,collectionContextStore:o,from:l,property_type:"relation"}))}),[o,m,i,S,g,x,R,N,l,oe,ie]),ce=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(an.d1({environment:m,collectionViewStore:e,currentValue:o.normalizedFormatStore.state.table_subitem_toggle_column}),no.wd({environment:m,collectionContextStore:o,action:"toggle_table_subitem_toggle_on_title"}))}),[o,m]),de=!Z.canConfigureBlock,ue=(0,f.yK)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12}})),[]);if(!w)return null;const pe=h&&Z.canConfigureBlock&&O,ge=Z.canConfigureCollection,me=(e,t,n,i)=>(0,b.jsx)(_o,{version:"v1",menuProps:e,property:t,defaultProperty:F,checkState:n,propertySchema:i,collectionContextStore:o,handleDefaultPropertySelect:re,handlePropertySelect:ae});return(0,b.jsxs)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{...(0,St.Gt)({feature:l,databaseType:v})}),footer:(0,b.jsxs)(ne.Z,{topBorder:B.length>0&&!G,children:[pe&&!G&&(0,b.jsx)(dn,{showImage:!de,caption:yo.default.formatMessage(St.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,b.jsx)(A.Z,{...e,icon:e=>(0,rn.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,b.jsx)(sn.Z,{disallowTabbing:!0,on:U,onClick:ce,disabled:de}),disabled:de,isGray:!0,onClick:ce})}),ge&&B.length>0&&!G&&(0,b.jsx)(A.Z,{icon:An.R,title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:se}),!G&&(0,b.jsx)(b.Fragment,{children:Z.canConfigureBlock&&!Z.canConfigureCollection?(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ae(void 0)}):Z.canConfigureBlock&&(0,b.jsx)(Y.ZP,{popupType:c.isPhone?te.kQ.SlideUp:te.kQ.Popup,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0,renderOrigin:e=>(0,b.jsx)(b.Fragment,{children:!(!Z.canConfigureBlock||!T)&&(0,b.jsx)(A.Z,{isGray:!0,icon:P.y,title:(0,b.jsx)(s.FormattedMessage,{...(0,St.nB)({feature:l,databaseType:v})}),isRed:!0,...e})}),render:e=>{let t;return t=c.isPhone?{menuType:so.og.ActionSheet}:{menuType:so.og.Popup,width:300},(0,b.jsx)(J.Z,{...t,footer:(0,b.jsxs)(ne.Z,{topBorder:!0,children:[Z.canConfigureBlock&&(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ae(void 0)}),Z.canConfigureCollection&&(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{re(void 0)}})]})})}})})]}),children:[h&&(0,b.jsx)(jt,{propertyName:R||D,inversePropertyName:(null==N?void 0:N.inverseName)||E,newDesign:!1,subitemsDisplayMode:V}),C&&(0,b.jsx)(iu,{propertyName:R||D}),!G&&(0,b.jsx)("div",{style:ue.useExistingTitle,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),B.length>0&&!G?(0,b.jsx)("div",{style:{paddingBottom:"6px"},children:(0,b.jsx)(ne.Z,{children:(0,b.jsx)(Y.ZP,{buttonPopupStore:$,render:e=>{let t;return t=c.isPhone?{menuType:so.og.ActionSheet}:{menuType:so.og.Popup,width:300},(0,b.jsx)(J.Z,{...t,footer:(0,b.jsx)(wo.Z,{schema:j,format:M,getProperties:Q,onAccept:Z.canConfigureBlock&&!Z.canConfigureCollection?ae:()=>{},inputPlaceholder:yo.default.formatMessage(h?ru.subitemInputPlaceholder:ru.timelineArrowsByInputPlaceholder),currentProperty:T,defaultShowPropertyCount:5,renderProperty:Z.canConfigureBlock&&!Z.canConfigureCollection?void 0:me})})},renderOrigin:e=>{var t;return(0,b.jsx)(A.Z,{title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:T?null===(t=j[T])||void 0===t?void 0:t.name:void 0,rotateChevron:X.open,disabled:!1,icon:ao.v,...e})},popupType:c.isPhone?te.kQ.SlideUp:te.kQ.Popup,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0})})}):ge&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{children:(0,b.jsx)("div",{style:ue.emptyStateText,children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,b.jsx)(ne.Z,{children:(0,b.jsx)(mo.ZP,{value:R,placeholder:R,onChange:e=>L(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,b.jsx)(td.Z,{collectionContextStore:o,targetCollectionStore:w,property:void 0,buttonContents:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Create",id:"database.viewSettings.relationsPropertyTab.createButton.title"}),temporaryInverseState:N,setTemporaryInverseState:W,isInitialPropertyName:H,onSubmit:le,from:l}),B.length>0&&(0,b.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,b.jsx)(ni.Z,{onClick:()=>{et.default.afterNextFlush((()=>{q(!1)}))},isGray:!0,style:{margin:"6px 12px 6px 12px",width:"auto"},children:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})})),su=(0,v.IU)("collectionDeleteRule",{viewBox:"0 0 14 14",svg:(0,b.jsx)("path",{d:"M12 3.27273L10.7273 2L7 5.72727L3.27273 2L2 3.27273L5.72727 7L2 10.7273L3.27273 12L7 8.27273L10.7273 12L12 10.7273L8.27273 7L12 3.27273Z"})});var lu=o(31339),cu=o(60246),du=o(62045),uu=o(50542);const pu=function(e){let{schema:t,sort:o,disabled:i,onChange:r,index:a,collectionViewType:s,collectionContextStore:l}=e;const c=t[o.property];return c?(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(mu,{disabled:i,schema:t,sort:o,onChange:r,index:a,collectionViewType:s,collectionContextStore:l,propertySchema:c}),(0,b.jsx)(gu,{sort:o,index:a,onChange:r,collectionViewType:s,collectionContextStore:l,disabled:i})]}):null};function gu(e){let{sort:t,index:o,onChange:n,collectionViewType:i,collectionContextStore:a,disabled:l}=e;const d=(0,r.O7)(),u=(0,s.useIntl)(),p=t.direction,g={ascending:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})},m={menuTitle:u.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",defaultMessage:"Sort"}),items:[...cu.C6],getKey:e=>e,selectedItem:p,disabled:l,onSelect:e=>{const r={...t,direction:e};n(o,r),a?no.wd({environment:d,action:"set_sort_direction",collectionContextStore:a}):i&&c.wd(d,{view_type:i,action:"set_sort_direction"})},renderItem:e=>(0,b.jsx)(X.Z,{title:g[e.value],...e}),renderOrigin:e=>(0,b.jsx)(du.Z,{...e,placeholder:u.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",defaultMessage:"Empty"}),title:p&&g[p],disabled:l,desktopStyle:{opacity:1}})};return(0,b.jsx)(Gs.Z,{...m,mobileActionSheet:!0},"direction")}function mu(e){let{propertySchema:t,disabled:o,schema:n,sort:i,onChange:a,index:s,collectionViewType:l,collectionContextStore:d}=e;const u=(0,r.O7)(),{device:p}=u;return(0,b.jsx)(Y.ZP,{popupType:p.isMobile?Y.Z4.SlideUp:Y.Z4.Popup,renderOrigin:e=>(0,b.jsx)(uu.Z,{...e,propertySchema:t,disabled:o,textWrapperStyle:{opacity:1}}),render:e=>(0,b.jsx)(fr.Z,{isRelationProperty:!1,schema:n,onAccept:e=>function(e,t,o,n,i,r,a){n(i,{...o,property:e}),a?no.wd({environment:t,action:"set_sort_property",collectionContextStore:a}):r&&c.wd(t,{view_type:r,action:"set_sort_property"})}(e,u,i,a,s,l,d),onClose:e.close,allowProperty:sa.bA}),disabled:o})}const Su=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"},deleteButtonTooltip:{defaultMessage:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"}});const fu=function(e){let{schema:t,format:o,sorts:n,showDeleteAll:i,disabled:a,parentStore:l,collectionViewStore:d,collectionContextStore:u,onChange:p,onDeleteAll:g}=e;const m=(0,r.O7)(),{device:S}=m,f=!!Object.keys(t).some((e=>!n.find((t=>t.property===e)))),y=i&&n.length>0;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ju,{sorts:n,schema:t,disabled:a,parentStore:l,collectionViewStore:d,collectionContextStore:u,onChange:p}),(f||y)&&(0,b.jsxs)(ne.Z,{children:[f&&(0,b.jsx)(Y.ZP,{popupType:S.isMobile?te.kQ.SlideUp:te.kQ.Popup,renderOrigin:e=>(0,b.jsx)(A.Z,{icon:An.R,isGray:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",defaultMessage:"Add sort"}),...e}),render:e=>{let i;return i=S.isMobile?{menuType:so.og.ActionSheet}:{menuType:so.og.Popup,width:280,height:287},(0,b.jsx)(J.Z,{...i,children:(0,b.jsx)(wo.Z,{schema:t,format:o,getProperties:()=>Object.entries(t).filter((e=>{let[t,o]=e;return!n.find((e=>e.property===t))&&(0,sa.bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:o=>{!function(e,t,o,n,i,r,a){var s;if(!e)return;const l=null===(s=o[e])||void 0===s?void 0:s.type,d=[...n,{property:e,direction:"ascending"}];i(d),a&&no.wd({environment:t,action:"create_sort_accept",collectionContextStore:a,property_type:l});const u=yu(r);u&&c.wd(t,{action:"create_sort_accept",view_type:u,property_type:l})}(o,m,t,n,p,d,u),e.close()},inputPlaceholder:yo.default.formatMessage(Su.inputPlaceholder)})})}}),y&&(0,b.jsx)(A.Z,{icon:P.y,isRed:!0,isGray:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",defaultMessage:"Delete sort"}),onClick:()=>function(e,t,o,n,i){if(t([]),null==i||i(),n)return void no.wd({environment:e,action:"delete_all_sorts",collectionContextStore:n});const r=yu(o);r&&c.wd(e,{action:"delete_all_sorts",view_type:r})}(m,p,d,u,g)})]})]})};function yu(e){return null==e?void 0:e.getType()}function xu(e,t,o,n,i,r,a){if(n(i.map(((o,n)=>n===e?t:o))),a)return void no.wd({environment:o,collectionContextStore:a,action:"update_sort"});const s=yu(r);s&&c.wd(o,{action:"update_sort",view_type:s})}function hu(e,t,o,n,i,r){if(o(n.filter(((t,o)=>o!==e))),r)return void no.wd({environment:t,action:"delete_sort",collectionContextStore:r});const a=yu(i);a&&c.wd(t,{action:"delete_sort",view_type:a})}function Cu(e){let{index:t,onChange:o,sorts:n,collectionViewStore:i,collectionContextStore:a}=e;const l=(0,r.O7)();return(0,b.jsx)(X.Z,{title:(0,b.jsx)("div",{style:{color:Nn.ZP.red},children:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})}),icon:(0,b.jsx)(lu.Z,{icon:P.y,styles:{color:Nn.ZP.red}}),onClick:()=>hu(t,l,o,n,i,a),focused:!1})}function vu(e){let{index:t,onChange:o,sorts:n,collectionViewStore:i,collectionContextStore:a}=e;const l=(0,s.useIntl)(),c=(0,r.O7)();return(0,b.jsx)(ln.ZP,{render:e=>(0,b.jsx)(Di.Z,{ariaLabel:l.formatMessage(Su.deleteButtonTooltip),icon:su,onClick:()=>hu(t,c,o,n,i,a),style:{marginRight:-6},...e}),renderTooltip:()=>l.formatMessage(Su.deleteButtonTooltip)})}function bu(e){let{sort:t,index:o,schema:n,disabled:i,parentStore:s,collectionViewStore:l,collectionContextStore:c,onChange:d,sorts:u}=e;const p=(0,r.O7)(),{device:g}=p,m=(0,a.VK)((()=>yu(l)),[l]);return g.isMobile?(0,b.jsxs)(ne.Z,{children:[(0,b.jsx)(pu,{index:o,sort:t,schema:n,parentStore:s,collectionViewType:m,collectionContextStore:c,onChange:(e,t)=>xu(e,t,p,d,u,l,c)}),!i&&(0,b.jsx)(Cu,{onChange:d,sorts:u,collectionViewStore:l,collectionContextStore:c,index:o})]}):(0,b.jsx)(ne.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"},children:(0,b.jsx)(jr.Z,{showDragHandle:!g.isMobile&&!i,title:(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",flexGrow:1,whiteSpace:"nowrap"},onMouseDown:$e.$0,children:(0,b.jsx)(pu,{index:o,sort:t,schema:n,parentStore:s,collectionViewType:m,collectionContextStore:c,onChange:(e,t)=>xu(e,t,p,d,u,l,c)})}),right:!i&&(0,b.jsx)(vu,{onChange:d,sorts:u,collectionViewStore:l,collectionContextStore:c,index:o}),rightStyle:{marginRight:19}})})}function ju(e){let{sorts:t,schema:o,disabled:n,parentStore:i,collectionViewStore:a,collectionContextStore:s,onChange:l}=e;const d=(0,r.O7)(),{device:u}=d;if(u.isMobile)return(0,b.jsx)(b.Fragment,{children:t.map(((e,r)=>(0,b.jsx)(bu,{schema:o,disabled:n,parentStore:i,collectionViewStore:a,collectionContextStore:s,onChange:l,sorts:t,sort:e,index:r},r)))});{const e=t.map(((e,t)=>t.toString()));return e.length>0?(0,b.jsx)("div",{style:{marginBottom:2},children:(0,b.jsx)(vr.ZP,{direction:"vertical",keys:e,renderKey:e=>(0,b.jsx)(bu,{schema:o,disabled:n,parentStore:i,collectionViewStore:a,collectionContextStore:s,onChange:l,sorts:t,sort:t[parseInt(e)],index:parseInt(e)}),onDrop:e=>function(e,t,o,n,i,r){if(o(Mt.oA(e.map((e=>n[parseInt(e)])))),r)return void no.wd({environment:t,action:"reorder_sorts",collectionContextStore:r});const a=yu(i);a&&c.wd(t,{action:"reorder_sorts",view_type:a})}(e,d,l,t,a,s)})}):null}}function wu(e){let{context:t,collectionContextStore:o,collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:l}=e;const c=(0,r.O7)(),[u,p,g,m,S,f]=(0,a.VK)((()=>[o.collectionViewStore(),(0,gt.Mj)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopes.state,Mu(o)]),[o]),y=t===ll.HV.ViewSettings&&p;return u?(0,b.jsx)(I.ZP,{collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:l,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{paddingTop:24}}),(0,b.jsx)(ne.Z,{topBorder:!0,children:(0,b.jsx)(_u,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,b.jsx)(fu,{collectionContextStore:o,collectionViewStore:u,schema:g,format:m,sorts:f,disabled:!S.canConfigureBlock,parentStore:u,onChange:e=>function(e,t,o){!function(e,t,o){const n=t.collectionViewStore();if(!n)return;yd.iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryState.state,sorts:{value:e}}})}(e,o,t)}(e,c,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===ll.HV.FilterBar&&d.E3({collectionSettingsStore:e})}(n,t)})}):null}function Mu(e){return e.currentSortsStore.state}function _u(e){let{collectionContextStore:t}=e;return(0,b.jsx)(Ad.ZP,{context:Ad.R1.SettingsSort,collectionContextStore:t})}wu.displayName="CollectionSettingsViewSort";var ku=o(75553),Vu=o(1436),Tu=o(16011);const Pu=2e4,Fu=100;var Zu=o(59753),Bu=o(47425);var Iu=o(23512);const Au={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function Ku(e){let{collectionContextStore:t}=e;const o=(0,s.useIntl)(),{isMobile:i}=(0,r.Fy)(),l=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:i?4:8},warningIcon:{fill:(0,Nn.fi)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[i]),c=(0,a.VK)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),d=(0,a.VK)((()=>ei.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>function(e){if(!e)return Pu;const t=Zu.kk.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,Bu.QM)(t.getSubscriptionTier())?Fu:Pu}(null==d?void 0:d.getModel())),[d]),p=(0,a.VK)((()=>(0,Bu.QM)(null==d?void 0:d.getSubscriptionTier())),[d]),g=(0,n.useMemo)((()=>(0,b.jsx)(Cr.Z,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:Au,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const n={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(u,t.aggregationResult.value)};return(0,Iu.uf)(n.value,"number_with_commas",o)}})),[t,o,u]);return(0,b.jsx)(jr.Z,{title:(0,b.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c&&d&&p&&(0,b.jsx)(ln.ZP,{placement:ln.ug.Left,alignment:ln.v2.Center,renderTooltip:()=>(0,b.jsx)(s.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,b.jsx)("div",{...e,children:(0,Ma.t)(l.warningIcon)})}),(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:g,limit:(0,Iu.uf)(u,"number_with_commas",o)}}),style:l.menuItem})}const Ou=n.memo(Ku,al.Z);var Du=o(60291),Ru=o(69619),Lu=o(15157),Hu=o(16402);function zu(e){let{collectionContextStore:t}=e;const o=(0,r.O7)(),{isMobile:i}=o.device,l=(0,f.yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:i?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[i]),c=(0,a.VK)((()=>t.collectionStore()),[t]),[u,p]=(0,a.VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[c]),g=(0,a.VK)((()=>ei.default.state.currentSpaceStore),[]),m=(0,a.VK)((()=>{var e;const o=t.numberChildrenUnfurled.state,n=t.numberChildrenReceived.state,r=o/n,a=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&n&&r<1&&!i||a&&i}),[t,i]),S=(0,a.VK)((()=>({defaultMessage:g&&(0,Bu.QM)(g.getSubscriptionTier())?"Clear and sync database":"Sync database"})),[g]),[y,x]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{if(u&&p){const e=`${p}:${u}`,t=Lu.Z.get({userId:o.currentUser.id,key:e});x(t)}}),[p,o,u]);const h=!y||y<Date.now();return u&&p?m?(0,b.jsx)(jr.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,Du.b)(l.menuItemIcon,"sync-spinner"),style:l.menuItem}):h?(0,b.jsx)(A.Z,{isGray:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:S.defaultMessage,description:S.description}}),icon:Du.b,onClick:async()=>{const e=null==c?void 0:c.id,t=!0===(null==c?void 0:c.getFormat().stale);e&&await d.R0({environment:o,uri:u,botId:p,collectionId:e,nextSync:y,setNextSync:x,isStale:t})}}):(0,b.jsx)(jr.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,Hu.hH)(Date.now(),y)}}),icon:(0,Ru.T)(l.menuItemIcon),style:l.menuItem}):null}const Eu=n.memo(zu,al.Z);function Uu(e){var t;let{collectionContextStore:o}=e;const n=(0,r.O7)(),{isMobile:i}=n.device,l=(0,f.yK)((()=>({menuItemTitle:{paddingLeft:i?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[i]),c=(0,a.VK)((()=>o.collectionStore()),[o]),[d,u,p]=(0,a.VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[c]),g=null==c||null===(t=c.pointer)||void 0===t?void 0:t.spaceId,m=(0,a.VK)((()=>(0,Ac.wY)(p,g)),[g,p]),S=(0,a.VK)((()=>o.collectionViewBlockStore()),[o]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ne.Z,{title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,b.jsx)(ln.ZP,{placement:ln.ug.Left,alignment:ln.v2.Center,renderTooltip:()=>S&&(0,b.jsx)(Tu.Z,{store:S,compactFormat:!0}),render:e=>(0,b.jsx)(jr.Z,{...e,title:m,icon:(0,b.jsx)(ii.Z,{disabled:!0,icon:null==c?void 0:c.getIcon(),isEmptyPage:!1,size:20,style:l.menuItemIcon}),style:l.menuItemTitle})}),style:{paddingBottom:0}}),(0,b.jsx)(ne.Z,{children:(0,b.jsx)(Ou,{collectionContextStore:o})}),(0,b.jsxs)(ne.Z,{topBorder:!0,children:[(0,b.jsx)(Eu,{collectionContextStore:o}),(0,b.jsx)(A.Z,{isGray:!0,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:ku.U,onClick:()=>{const e={uri:d,botId:u,spaceId:g};qn.RD({environment:n,stringValue:JSON.stringify(e,null,2),copiedMessage:qn.tq.copiedToClipboard})}}),(0,b.jsx)(Q.Z,{href:`${Da.default.domainBaseUrl}?target=connected_apps`,children:(0,b.jsx)(A.Z,{icon:Vu.g,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,b.jsx)(kr.Z,{href:(0,_r.UY)("guides.syncedDatabases"),title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const Nu=n.memo(Uu,al.Z);function Wu(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,r.O7)(),c=(0,n.useRef)((0,l.ZP)()),[u,g]=(0,a.VK)((()=>{var e;return[t.collectionViewBlockStore(),Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore())]}),[t]),m=(0,n.useMemo)((()=>Si.default.createValue("")),[]);return u?(0,b.jsx)(I.ZP,{...e,title:(0,b.jsx)(s.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>{no.tW({environment:i,eventName:"abandoned_search",sessionId:c.current,source:Qc.S.Source,queryLength:m.state.length}),d.E3({collectionSettingsStore:o})},children:g?(0,b.jsx)(Nu,{collectionContextStore:t}):(0,b.jsx)(Jc.Z,{collectionContextStore:t,parentStore:u,onAccept:e=>function(e,t,o,n){p.createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,perform:n=>{ro.yc({environment:t,collectionContextStore:o,collectionStore:e,transaction:n})}}),d.z$({collectionSettingsStore:n})}(e,i,t,o),context:Qc.S.Source,searchSessionId:c.current,inputStore:m})}):null}Wu.displayName="CollectionSettingsViewSource";const Gu=n.memo(Wu);class qu extends i.Z{constructor(){super(...arguments),this.lastTab=void 0}didMountOrUpdate(){const{collectionSettingsStore:e,collectionContextStore:t}=this.props,o=(0,Ye.n)(e),n=function(e){return e.getViewType()}(this.props.collectionContextStore);var i,r,a,s,l,d,u;o&&this.lastTab!==o&&("propertyType"===o.type?c.r5(this.environment,{view_type:n,menu:o.type,is_database_name_empty:!Boolean(null==t||null===(i=t.collectionStore())||void 0===i||null===(i=i.getName())||void 0===i?void 0:i.toString()),collection_id:null===(r=t.collectionStore())||void 0===r?void 0:r.id,collection_view_id:null===(a=t.collectionViewStore())||void 0===a?void 0:a.id,collection_view_block_id:null===(s=t.collectionViewBlockStore())||void 0===s?void 0:s.id}):c.r5(this.environment,{view_type:n,menu:o.type,collection_id:null===(l=t.collectionStore())||void 0===l?void 0:l.id,collection_view_id:null===(d=t.collectionViewStore())||void 0===d?void 0:d.id,collection_view_block_id:null===(u=t.collectionViewBlockStore())||void 0===u?void 0:u.id}));this.lastTab=o}renderComponent(){var e;const{collectionSettingsStore:t}=this.props,o=(0,Ye.n)(t),n=(i=this.props,{main:e=>(0,b.jsx)(Xu,{tab:e,...i}),source:()=>(0,b.jsx)(Gu,{...i}),createViewSource:()=>(0,b.jsx)(zs.m,{...i}),createSyncedViewSource:e=>(0,b.jsx)(Qu,{tab:e,...i}),selectAccountForExternalSource:e=>(0,b.jsx)(Ju,{tab:e,...i}),shareSyncedView:e=>(0,b.jsx)(ep,{tab:e,...i}),propertyType:e=>(0,b.jsx)(tp,{tab:e,...i}),propertyAiAutofill:e=>(0,b.jsx)(op,{tab:e,...i}),createView:()=>(0,b.jsx)(Ls,{...i}),duplicateExistingView:()=>(0,b.jsx)(pl.Z,{...i}),properties:e=>(0,b.jsx)(np,{tab:e,...i}),property:e=>(0,b.jsx)(ip,{tab:e,...i}),deletedProperties:e=>(0,b.jsx)(rp,{tab:e,...i}),selectRelationSource:e=>(0,b.jsx)(ap,{tab:e,...i}),setupRelation:e=>(0,b.jsx)(sp,{tab:e,...i}),layout:()=>(0,b.jsx)(Yd,{...i}),group:e=>(0,b.jsx)(lp,{tab:e,...i}),groupByProperty:e=>(0,b.jsx)(cp,{tab:e,...i}),subitem:e=>(0,b.jsx)(up,{tab:e,...i}),arrowsBy:e=>(0,b.jsx)(gp,{tab:e,...i}),githubConfig:e=>(0,b.jsx)(fp,{tab:e,...i}),filters:()=>(0,b.jsx)(Od,{...i}),groupByNumber:e=>(0,b.jsx)(dp,{tab:e,...i}),filter:e=>(0,b.jsx)(yp,{tab:e,...i}),createFilter:()=>(0,b.jsx)(Cd,{...i}),createSort:()=>(0,b.jsx)(_d,{...i}),sort:()=>(0,b.jsx)(wu,{...i}),page:()=>(0,b.jsx)(Yu,{...i}),automationSettings:e=>(0,b.jsx)(xp,{tab:e,...i}),externalProjectsSyncSettings:e=>(0,b.jsx)(hp,{tab:e,...i}),automationCreateSettings:e=>(0,b.jsx)(Cp,{tab:e,...i}),automationEditSettings:e=>(0,b.jsx)(vp,{tab:e,...i}),dependencies:e=>(0,b.jsx)(mp,{tab:e,...i}),relationFeaturesAdvancedSettings:e=>(0,b.jsx)(Sp,{tab:e,...i}),subitemV2:e=>(0,b.jsx)(pp,{tab:e,...i}),sprintSettings:e=>(0,b.jsx)(bp,{tab:e,...i}),chartStyle:e=>(0,b.jsx)(jp,{tab:e,...i}),customize:e=>(0,b.jsx)(wp,{tab:e,...i})});var i;if(o)return(0,b.jsx)(qe.Z,{capture:!0,preventType:Xe.Z.Y,children:(0,b.jsx)(m.Z,{debugName:"CollectionSettings",capture:!0,onEsc:e=>function(e,t){(0,$e.ZP)({event:e,context:$e.Af.CollectionSettingsClick,callback:()=>{d.E3({collectionSettingsStore:t})}})}(e,this.props.collectionSettingsStore),children:null===(e=n[o.type])||void 0===e?void 0:e.call(n,o)})})}}qu.displayName="CollectionSettings";const $u=(0,s.injectIntl)(qu);function Xu(e){const{collectionContextStore:t,tab:o}=e,n=(0,a.VK)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,a.VK)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,b.jsx)(ds,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function Yu(e){const{collectionContextStore:t}=e,o=(0,r.O7)(),n=(0,a.VK)((()=>t.collectionViewStore()),[t]);return n?(0,b.jsx)(I.ZP,{...e,title:"Select page to display",children:(0,b.jsx)("div",{style:{margin:12},children:(0,b.jsx)(g.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Je.Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=Je.Z.state.pageId;if(!t)return null;p.createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,perform:e=>{u.FH({stores:[n],update:{page_pointer:{id:(0,l.Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})})}):null}function Qu(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,b.jsx)(si,{...e,...t})}function Ju(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,b.jsx)(Rn,{...e,...t})}function ep(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,b.jsx)(gd,{...e,...t})}function tp(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,b.jsx)(Rc,{...e,...t})}function op(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,b.jsx)(wc,{...e,...t})}function np(e){const{tab:t}=e;return"properties"!==t.type?null:(0,b.jsx)(Qd.Z,{...e,timelineViewTab:t.timelineViewTab})}function ip(e){const{tab:t}=e;return"property"!==t.type?null:(0,b.jsx)(El.Z,{...e,...t},t.property)}function rp(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,b.jsx)(ul,{...t,...e})}function ap(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,b.jsx)(ed,{...e,...t})}function sp(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,b.jsx)(id,{...e,...t})}function lp(e){const{tab:t}=e;return"group"!==t.type?null:(0,b.jsx)(Nr,{...e,...t})}function cp(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,b.jsx)($d,{...e,...t})}function dp(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,b.jsx)(Wd,{...e,...t})}function up(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,b.jsx)(au,{...e,...t,formatSetting:"subitem"})}function pp(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,b.jsx)($o,{...e,feature:"subitem"})}function gp(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,b.jsx)(au,{...e,...t,formatSetting:"timeline_arrows_by"})}function mp(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,b.jsx)($o,{...e,feature:"timeline_arrows_by"})}function Sp(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,b.jsx)(Sn,{...e,feature:t.feature})}function fp(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,b.jsx)(zl.Z,{...e,property:t.property})}function yp(e){const{tab:t}=e;return"filter"!==t.type?null:(0,b.jsx)(Fd,{...e})}function xp(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,b.jsx)(Ge,{...e,tabSettings:t})}function hp(e){const{tab:t}=e;return"externalProjectsSyncSettings"!==t.type?null:(0,b.jsx)(Hl,{...e,tabSettings:t})}function Cp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"automationCreateSettings"!==t.type?null:(0,b.jsx)(Ue,{collectionContextStore:o,collectionSettingsStore:n,mode:"create"})}function vp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("automationEditSettings"!==t.type)return null;const{automationId:i}=t;return(0,b.jsx)(Ne,{automationId:i,collectionContextStore:o,collectionSettingsStore:n,mode:"update"})}function bp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,b.jsx)(je,{collectionContextStore:o,collectionSettingsStore:n})}function jp(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;const i=(0,a.VK)((()=>Qe.default.checkGate("charts_mvp")),[]);return"chartStyle"===t.type&&i?(0,b.jsx)(In,{collectionContextStore:o,collectionSettingsStore:n}):null}function wp(e){const{tab:t}=e;return"customize"!==t.type?null:(0,b.jsx)($s,{...e})}var Mp=o(9015),_p=o(17501),kp=o(58564);var Vp=o(74404),Tp=o(68910);const Pp=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});function Fp(e){const{collectionContextStore:t,propertySchema:o}=e,i=(0,a.VK)((()=>t.collectionStore()),[t]),r=(0,a.VK)((()=>null==i?void 0:i.getSpaceId()),[i]),s=(0,n.useMemo)((()=>{const e=o.automation_id;if(e&&r)return{id:e,spaceId:r,table:rl.cv}}),[o.automation_id,r]),l=function(e,t){return(0,a.VK)((()=>!(!e||!t)&&(0,kp.k)(e,t)),[t,e])}(i,s);return l?(0,b.jsx)(Zp,{...e}):(0,b.jsx)(Bp,{})}function Zp(e){const{collectionContextStore:t,propertySchema:o,propertyId:i}=e,l=(0,r.O7)().currentUser.id,[c,d]=(0,n.useState)([]),u=(0,a.VK)((()=>t.permissionScopes.state),[t]),p=(0,a.VK)((()=>t.collectionStore()),[t]),g=(0,a.VK)((()=>null==p?void 0:p.getSpaceId()),[p]),{maybePersistedAutomationStore:m,maybePersistedTransactionActions:S}=(0,Vp.$)({automationId:o.automation_id,spaceId:g,defaultValue:void 0,persist:!0}),f=(0,a.VK)((()=>null==m?void 0:m.getTrigger()),[m]),y=(0,n.useMemo)((()=>{if(m)return new Tp.L({type:"button_property",persisted:!0,automationStore:m,collectionContextStore:t,propertyId:i,propertySchema:o,intl:yo.default.getIntl(),parentRecordStore:m,currentUserId:l})}),[i,o,m,t,l]),x=(0,_p.C)({automationStore:m,propertyId:i,propertySchema:o}),h=(0,a.VK)((()=>{var e;return"sufficient"===(null==x||null===(e=x.state)||void 0===e?void 0:e.executionPermissionStatus)}),[x]),C=(0,a.VK)((()=>(null==m?void 0:m.getNameStore().getValue())??""),[m]),v=(0,n.useCallback)((e=>{if(!m)return;const t=e.currentTarget.value;S.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",perform:e=>{io.sO({store:m.getNameStore(),transaction:e,value:t})}})}),[m,S]),j=(0,n.useCallback)((e=>{d((t=>[...t,e.id]))}),[]);return p&&m&&f&&"button"===f.type&&y?(0,b.jsxs)(Mp.Z.Provider,{value:{automationContextStore:y,collectionStore:p,disabled:!h,editorPlacement:{type:"inline"},editorWidth:I.nJ,maybePersistedTransactionActions:S,onActionAdded:j,suppressActionErrors:c},children:[(0,b.jsx)(ne.Z,{topBorder:!0,title:(0,b.jsx)(s.FormattedMessage,{id:"database.buttonProperty.label",defaultMessage:"Label"}),children:(0,b.jsx)(mo.ZP,{disabled:!u.canConfigureCollection,placeholder:yo.default.formatMessage(Pp.inputPlaceholder),value:C,onChange:v})}),(0,b.jsx)(ne.Z,{style:{paddingInline:12},children:(0,b.jsx)(sl.IQ,{areActionsEditable:!0,areTriggersEditable:!1})})]}):null}function Bp(){return(0,b.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,b.jsx)(Le.Z,{})})}},46978:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(67294),i=o(24405),r=o(85893);function a(e,t){let{isSelected:o}=e;const{radioButtonStyle:n,dotStyle:a}=(0,i.yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:8,background:o?e.blueColor:e.whiteButtonBackground,border:o?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.regularInvertedTextColor,transition:"opacity 100ms ease-out",opacity:o?1:0}})),[o]);return(0,r.jsx)("div",{ref:t,style:n,children:(0,r.jsx)("div",{style:a})})}const s=n.forwardRef(a)},60442:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var n=o(37810),i=o(47853),r=o(85893);const a=function(e){let{imageURL:t,imageWidth:o,imageHeight:n,caption:a,title:l}=e;if(t){const e=(0,i.D)(t);return(0,r.jsxs)("div",{style:{width:o||200,marginTop:4,marginBottom:4},children:[(0,r.jsx)("div",{style:{width:"100%",height:n||100,borderRadius:4,backgroundImage:`url(${e})`,backgroundSize:"cover",marginBottom:6}}),(0,r.jsx)(s,{caption:a,title:l})]})}return(0,r.jsx)(s,{caption:a,title:l,style:{width:o}})};function s(e){let{style:t,caption:o,title:i}=e;return(0,r.jsxs)("div",{style:{whiteSpace:"normal",lineHeight:1.4,...t},children:[i&&(0,r.jsx)("header",{style:{fontWeight:n.Z.fontWeight.bold,marginBottom:4},children:i}),o]})}},90683:(e,t,o)=>{o.d(t,{a:()=>l});o(67294);var n=o(66897),i=o(1898),r=o(70301),a=o(45653),s=o(85893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,n.YU)(t)?(0,s.jsx)(r.Z,{botValue:t.asActor,...o}):(0,n.$S)(t)?(0,s.jsx)(a.Z,{userValue:t.asActor,...o}):(0,n.Iq)(t)?(0,s.jsx)(a.Z,{userValue:void 0,...o}):void(0,i.t1)(t)}},44496:(e,t,o)=>{o.d(t,{q:()=>i});const n={greeting:!0,tasks:!1,tips:!1,templates:!1,calendar:!1};function i(e){const t=(null==e?void 0:e.getHomeEnabledFeatures())??{};return{...n,...t}}},51741:(e,t,o)=>{o.d(t,{NW:()=>a,Qi:()=>i,Rt:()=>n,WO:()=>s,wI:()=>r});let n=function(e){return e[e.SelectedPage=0]="SelectedPage",e[e.SearchPage=1]="SearchPage",e[e.NewPage=2]="NewPage",e}({});const i=4,r=32,a=400,s=20},1018:(e,t,o)=>{o.d(t,{NW:()=>n.NW,Qi:()=>n.Qi,ev:()=>i.LazyRelationPropertyMenu,pG:()=>i.LazyRelationPropertyMenuOld,wI:()=>n.wI});var n=o(51741),i=o(77907)},28410:(e,t,o)=>{o.d(t,{Q4:()=>a,R8:()=>c,SQ:()=>g,Th:()=>i,jl:()=>s,v8:()=>u});o(57658);var n=o(1898);const i=12e3,r=["exploratory","wild_west"],a=(0,n.AO)((e=>(0,n.DE)(r,e)?{true:e}:{false:e})),s="Fine-tuning data generator",l={"ft:gpt-4-0613:makenotion:dbq-2:8tSPk6YG":{name:"DBQ v2 2k",createdTime:Date.parse("2024-02-17T17:55:00-05:00"),description:"DBQ v2 model trained on 2.1k examples",variants:["exploratory"],minimalPromptVersion:1,provider:"openai"},"ft:gpt-3.5-turbo-1106:makenotion:turbo-v3-20k-1ep:8qvz03p0":{name:"Assistant Fast Model",createdTime:Date.parse("2023-12-14T02:27:00-04:00"),description:"Speedy gpt-3.5-turbo assistant model",variants:["exploratory"],minimalPromptVersion:1,provider:"openai"},"ft:gpt-4-0613:makenotion::8SDS0jPI":{name:"JavaScript Assistant",createdTime:Date.parse("2023-12-03T10:58:00-04:00"),description:"JavaScript assistant",variants:["wild_west"],minimalPromptVersion:1,provider:"openai"},"finetuning-data-generator":{name:s,createdTime:Date.parse("2023-01-26T02:27:00-04:00"),description:"Calls the 'slow' API used to generate fine-tuning data",variants:["exploratory"],minimalPromptVersion:1,provider:"openai"},"gpt-4-turbo-preview":{name:"GPT-4 Turbo",createdTime:Date.parse("2024-03-05T02:27:00-04:00"),description:"gpt-4-turbo",variants:["exploratory"],provider:"openai",minimalPromptVersion:1}},c={name:"Default model",description:"Default assistant model for this mode"},d=((0,n.qP)(l).reduce(((e,t)=>{let[o,{name:n}]=t;return e[n]=o,e}),{}),Object.values(l).map((e=>{let{name:t}=e;return t})));function u(e){return d.some((t=>t===e))}const p=function(){const e={};for(const o of Object.values(l))for(const t of o.variants)e[t]||(e[t]=[]),e[t].push(o);const t={};for(const[o,i]of(0,n.qP)(e))t[o]=i.sort(((e,t)=>e.createdTime-t.createdTime));return t}();function g(e){return(0,n.qg)(p,e)?p[e]:[]}const m=["openai-1.1","openai-2","openai-4","openai-5","openai-6","openai-7","openai-8","openai-10","openai-11",...d];const S=["anthropic-1","anthropic-2","anthropic-qa-alpha","anthropic-3"]},22771:(e,t,o)=>{o.d(t,{J:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("arrowsConverging",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.47949 13.2667C4.27441 13.2667 4.11263 13.2006 3.99414 13.0684C3.88021 12.9408 3.82324 12.7881 3.82324 12.6104C3.82324 12.3552 3.9349 12.1569 4.1582 12.0157L4.70508 11.667C4.94206 11.5075 5.20866 11.2956 5.50488 11.0313C5.80566 10.7624 6.09277 10.4594 6.36621 10.1221C6.64421 9.78488 6.87207 9.42485 7.0498 9.04204C7.22754 8.65923 7.31641 8.27414 7.31641 7.88677V4.46196H8.67676V7.88677C8.67676 8.27414 8.76562 8.65923 8.94336 9.04204C9.12109 9.42485 9.34668 9.78716 9.62012 10.129C9.89355 10.4662 10.1807 10.767 10.4814 11.0313C10.7822 11.2956 11.0511 11.5075 11.2881 11.667L11.835 12.0157C12.0583 12.1569 12.1699 12.3552 12.1699 12.6104C12.1699 12.7972 12.1107 12.9522 11.9922 13.0752C11.8737 13.2028 11.7119 13.2667 11.5068 13.2667C11.3109 13.2667 11.1195 13.2051 10.9326 13.0821L10.5771 12.8428C10.3447 12.6879 10.0941 12.4942 9.8252 12.2618C9.56087 12.0248 9.30339 11.7741 9.05273 11.5098C8.80208 11.2455 8.58333 10.9903 8.39648 10.7442C8.20964 10.4981 8.07975 10.2839 8.00684 10.1016H7.98633C7.91341 10.2839 7.78125 10.5004 7.58984 10.751C7.40299 10.9971 7.18424 11.2523 6.93359 11.5167C6.68294 11.7764 6.42318 12.0248 6.1543 12.2618C5.88997 12.4942 5.64388 12.6879 5.41602 12.8428L5.06055 13.0821C4.8737 13.2051 4.68001 13.2667 4.47949 13.2667ZM6.29102 5.36431C6.02669 5.36431 5.86263 5.28228 5.79883 5.11821C5.73503 4.95415 5.77832 4.76502 5.92871 4.55083L7.5625 2.26079C7.68555 2.08306 7.83138 1.99647 8 2.00103C8.16862 2.00103 8.31445 2.08761 8.4375 2.26079L10.0576 4.55767C10.2126 4.7673 10.2559 4.95415 10.1875 5.11821C10.1237 5.28228 9.96191 5.36431 9.70215 5.36431H6.29102Z"})})},80881:(e,t,o)=>{o.d(t,{I:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})})},96451:(e,t,o)=>{o.d(t,{k:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("collectionNumberType",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.73457,9.90096 L1.73457,4.54339 L1.65064,4.54339 L0,5.68112 L0,4.37087 L1.73923,3.17252 L3.14274,3.17252 L3.14274,9.90096 L1.73457,9.90096 Z M3.59633,5.22882 C3.59633,3.90925 4.62215,3 6.0956,3 C7.52242,3 8.43633,3.82532 8.43633,4.96304 C8.43633,5.75106 8.09128,6.29195 6.97221,7.34108 L5.57337,8.64667 L5.57337,8.7306 L8.52959,8.7306 L8.52959,9.90096 L3.6756,9.90096 L3.6756,8.91711 L6.03498,6.66031 C6.87429,5.85364 7.05614,5.5459 7.05614,5.0936 C7.05614,4.55738 6.67379,4.13306 6.01633,4.13306 C5.3309,4.13306 4.90192,4.58536 4.90192,5.22882 L3.59633,5.22882 Z M10.4889,6.96805 L10.4889,5.93757 L11.3282,5.93757 C11.967,5.93757 12.4007,5.55988 12.4007,5.00967 C12.4007,4.50609 12.0043,4.12374 11.3469,4.12374 C10.6661,4.12374 10.2464,4.47345 10.1998,5.07495 L8.89888,5.07495 C8.94551,3.83464 9.90139,3 11.4168,3 C12.9089,3 13.7389,3.82532 13.7342,4.80917 C13.7296,5.62516 13.2166,6.16139 12.4939,6.33857 L12.4939,6.42717 C13.4311,6.56239 14,7.15923 14,8.05915 C14,9.23884 12.8903,10.0735 11.3702,10.0735 C9.8501,10.0735 8.81495,9.24351 8.75434,7.97056 L10.1019,7.97056 C10.1439,8.53942 10.6288,8.90312 11.3515,8.90312 C12.0649,8.90312 12.5639,8.51611 12.5639,7.93326 C12.5639,7.33642 12.0976,6.96805 11.3422,6.96805 L10.4889,6.96805 Z"})})},37694:(e,t,o)=>{o.d(t,{u:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})})},6637:(e,t,o)=>{o.d(t,{I:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("filterCircled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})},13495:(e,t,o)=>{o.d(t,{M:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("layoutPadded",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M3.94727 11.832H10.2295C11.3574 11.832 11.9248 11.2715 11.9248 10.1504V7.30664C11.9248 6.18555 11.3574 5.625 10.2295 5.625H3.94727C2.81934 5.625 2.25195 6.18555 2.25195 7.30664V10.1504C2.25195 11.2715 2.81934 11.832 3.94727 11.832ZM15.6572 17.5811H20.0459C21.1738 17.5811 21.7412 17.0273 21.7412 15.8994V8.33203C21.7412 7.21094 21.1738 6.65723 20.0459 6.65723H15.6572C14.5361 6.65723 13.9688 7.21094 13.9688 8.33203V15.8994C13.9688 17.0273 14.5361 17.5811 15.6572 17.5811ZM4.11133 10.5469C3.73535 10.5469 3.53711 10.3486 3.53711 9.95898V7.49805C3.53711 7.10156 3.73535 6.91016 4.11133 6.91016H10.0586C10.4414 6.91016 10.6396 7.10156 10.6396 7.49805V9.95898C10.6396 10.3486 10.4414 10.5469 10.0586 10.5469H4.11133ZM15.8213 16.3027C15.4521 16.3027 15.2471 16.1045 15.2471 15.7148V8.52344C15.2471 8.12695 15.4521 7.93555 15.8213 7.93555H19.875C20.2578 7.93555 20.4561 8.12695 20.4561 8.52344V15.7148C20.4561 16.1045 20.2578 16.3027 19.875 16.3027H15.8213ZM5.66309 18.4629H10.9951C12.1162 18.4629 12.6904 17.9092 12.6904 16.7812V14.8535C12.6904 13.7324 12.1162 13.1787 10.9951 13.1787H5.66309C4.53516 13.1787 3.96777 13.7324 3.96777 14.8535V16.7812C3.96777 17.9092 4.53516 18.4629 5.66309 18.4629ZM5.82715 17.1846C5.45117 17.1846 5.25293 16.9863 5.25293 16.5967V15.0449C5.25293 14.6553 5.45117 14.4639 5.82715 14.4639H10.8242C11.2002 14.4639 11.4053 14.6553 11.4053 15.0449V16.5967C11.4053 16.9863 11.2002 17.1846 10.8242 17.1846H5.82715Z"})})},27714:(e,t,o)=>{o.d(t,{N:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("link",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})},14177:(e,t,o)=>{o.d(t,{y:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("product",{viewBox:"0 0 18 14",svg:(0,i.jsx)("path",{d:"M9.6084 13.8457C12.4863 13.8457 14.4072 12.8271 14.4072 11.3232C14.4072 9.97656 13.2588 9.67578 13.2588 8.88281C13.2588 7.78906 17.2305 7.57031 17.2305 4.76074C17.2305 1.98535 14.3662 0.15332 10.1143 0.15332C4.5293 0.15332 0.762695 2.94238 0.762695 7.11914C0.762695 11.1387 4.33789 13.8457 9.6084 13.8457ZM9.6084 12.6768C4.98047 12.6768 1.93164 10.4482 1.93164 7.11914C1.93164 3.63281 5.17188 1.32227 10.1143 1.32227C13.7031 1.32227 16.0615 2.7168 16.0615 4.76074C16.0615 7.14648 12.0625 6.8252 12.0625 8.88965C12.0625 10.0586 13.2383 10.4277 13.2383 11.2344C13.2383 12.1025 11.8096 12.6768 9.6084 12.6768ZM10.1758 4.76074C10.8184 4.76074 11.3242 4.24805 11.3242 3.60547C11.3242 2.96973 10.8184 2.45703 10.1758 2.45703C9.54688 2.45703 9.02051 2.96973 9.02051 3.60547C9.02051 4.24805 9.54688 4.76074 10.1758 4.76074ZM6.70996 5.86816C7.50293 5.86816 8.14551 5.23242 8.14551 4.42578C8.14551 3.63965 7.49609 3.01074 6.70996 3.01074C5.91016 3.01074 5.26758 3.63965 5.26758 4.42578C5.26758 5.23242 5.91016 5.86816 6.70996 5.86816ZM13.2998 5.19824C13.8125 5.19824 14.2227 4.78125 14.2227 4.26172C14.2227 3.74902 13.8125 3.33203 13.2998 3.33203C12.7803 3.33203 12.3564 3.74902 12.3564 4.26172C12.3564 4.78125 12.7803 5.19824 13.2998 5.19824ZM4.21484 8.05566C4.84375 8.05566 5.34961 7.53613 5.34961 6.90723C5.34961 6.27832 4.84375 5.77246 4.21484 5.77246C3.59277 5.77246 3.08008 6.27832 3.08008 6.90723C3.08008 7.53613 3.59277 8.05566 4.21484 8.05566ZM9.04785 11.0635C10.0869 11.0635 10.9414 10.209 10.9414 9.16309C10.9414 8.13086 10.0869 7.27637 9.04785 7.27637C8.00879 7.27637 7.1543 8.13086 7.1543 9.16309C7.1543 10.209 8.00879 11.0635 9.04785 11.0635ZM9.04785 10.2705C8.43945 10.2705 7.94727 9.77832 7.94727 9.16309C7.94727 8.48633 8.4668 8.08301 9.03418 8.07617C9.61523 8.06934 10.1484 8.46582 10.1484 9.16309C10.1484 9.77832 9.66309 10.2705 9.04785 10.2705Z"})})},84199:(e,t,o)=>{o.d(t,{N:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("properties",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})},37888:(e,t,o)=>{o.d(t,{U:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("unlocked",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.49023 14.7227H8.89551C9.94824 14.7227 10.4746 14.1963 10.4746 13.0479V8.20801C10.4746 7.22363 10.085 6.69727 9.29883 6.57422V4.83105C9.29883 3.22461 10.3174 2.35645 11.541 2.35645C12.7646 2.35645 13.79 3.22461 13.79 4.83105V6.28711C13.79 6.76562 14.0703 7.01855 14.4395 7.01855C14.8018 7.01855 15.082 6.7793 15.082 6.28711V4.96094C15.082 2.36328 13.3525 1.1123 11.541 1.1123C9.72949 1.1123 8 2.36328 8 4.96094V6.54004H2.49023C1.43066 6.54004 0.911133 7.06641 0.911133 8.20801V13.0479C0.911133 14.1963 1.43066 14.7227 2.49023 14.7227ZM2.68848 13.5059C2.3877 13.5059 2.2373 13.3623 2.2373 13V8.25586C2.2373 7.89355 2.3877 7.76367 2.68848 7.76367H8.7041C9.00488 7.76367 9.14844 7.89355 9.14844 8.25586V13C9.14844 13.3623 9.00488 13.5059 8.7041 13.5059H2.68848ZM7.99316 21.1123C6.5918 21.1123 5.2793 21.8779 4.75293 23.375L5.78516 24.4141C5.94922 23.0811 6.87891 22.3564 7.99316 22.3564C9.2168 22.3564 10.2422 23.2246 10.2422 24.8311V26.54H7.9248L9.1416 27.7637H11.0078C11.3086 27.7637 11.4521 27.8936 11.4521 28.2559V30.0742L12.7783 31.4072V28.208C12.7783 27.2031 12.3682 26.6768 11.541 26.5674V24.9609C11.541 22.3633 9.81152 21.1123 7.99316 21.1123ZM13.749 35.126C13.9609 35.3379 14.3164 35.3379 14.5215 35.126C14.7266 34.9072 14.7334 34.5723 14.5215 34.3535L2.46973 22.3154C2.25781 22.1035 1.90918 22.0967 1.69043 22.3154C1.48535 22.5205 1.48535 22.876 1.69043 23.0811L13.749 35.126ZM4.79395 34.7227H11.1992C11.5 34.7227 11.7598 34.6816 11.9785 34.5928L10.8711 33.4922C10.8096 33.499 10.7549 33.5059 10.6865 33.5059H4.99219C4.69141 33.5059 4.54102 33.3623 4.54102 33V28.2559C4.54102 27.9004 4.68457 27.7637 4.97852 27.7637H5.14258L4.04883 26.6631C3.48828 26.8818 3.21484 27.3809 3.21484 28.208V33.0479C3.21484 34.1963 3.73438 34.7227 4.79395 34.7227Z"})})},69619:(e,t,o)=>{o.d(t,{T:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.IU)("unsync",{viewBox:"0 0 30 30",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,i.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})}}]);