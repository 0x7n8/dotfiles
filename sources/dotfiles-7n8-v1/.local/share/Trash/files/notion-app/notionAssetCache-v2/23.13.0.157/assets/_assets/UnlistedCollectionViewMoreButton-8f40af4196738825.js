"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[582],{95193:(e,t,o)=>{o.d(t,{F:()=>a,U:()=>r});var i=o(480),n=o(86628),l=o(60709);function r(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:l.og.ActionSheet}:{menuType:l.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function a(e){const t=(0,i.Fy)();return(0,n.VK)((()=>r({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},35294:(e,t,o)=>{o.d(t,{d:()=>r});var i=o(480),n=o(86628),l=o(53437);function r(e){const t=(0,i.Fy)();return(0,n.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?l.kQ.SlideUp:l.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},69258:(e,t,o)=>{o.r(t),o.d(t,{default:()=>F});var i=o(67294),n=o(480),l=o(86628),r=o(24405),a=o(15145),c=o(9999),d=o(56666),s=o(47453),u=o(9291),m=o(1898),p=o(11302),h=o(8055),g=o(21202),v=o(13493),x=o(75246),b=o(9953),f=o(13447);var C=o(81598),y=o(95193),w=o(35294),S=o(84210),_=o(31194),k=o(52275),B=o(73063),V=o(78140),T=o(32163),I=o(53437),R=o(31278),W=o(76798),j=o(72495),M=o(88077),A=o(85893);const Z=(0,u.defineMessages)({moreButtonAriaLabel:{id:"unlistedCollectionView.moreButton.icon",defaultMessage:"More"}});function F(e){const{collectionContextStore:t}=e,o=(0,u.useIntl)(),n=i.useRef(null),[a,c]=i.useState(!1),s=(0,l.VK)((()=>t.isInHomeWidget.state),[t]),m=i.useCallback((()=>{c(!a)}),[a]),p=(0,w.d)(),h=(0,r.yK)((e=>({icon:{width:18,height:void 0,fill:e.mediumIconColor},button:(0,M.C)({theme:e,isInHomeWidget:s})})),[s]);return(0,A.jsx)(I.ZP,{popupType:p,alignmentToOrigin:_.lU.End,placementToOrigin:_.Iw.Bottom,open:a,onDismiss:m,origin:(0,A.jsx)(B.Z,{ref:n,icon:d.o,ariaLabel:o.formatMessage(Z.moreButtonAriaLabel),onClick:m,iconStyle:h.icon,style:h.button}),render:()=>{var e;return(0,A.jsx)(H,{collectionContextStore:t,originRect:null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect()})}})}function H(e){const{collectionContextStore:t,originRect:o}=e,l=(0,n.O7)(),[r,a]=i.useState("origin"),c=i.useCallback((e=>{K({environment:l,blockStore:e})}),[l]),d=i.useCallback((()=>{a("copy");const e=function(e){const{environment:t,collectionContextStore:o}=e,i=t.currentUser.id,n=o.collectionViewStore(),l=o.collectionStore(),r=o.collectionViewBlockStore();if(!(i&&n&&r&&l))return;const a=l.getSpaceId(),c=n.getFormat(),d=n.getRawQuery(),s=l.pointer;return f.createAndCommit({environment:t,userAction:"copyCollectionViewToNewLinkedDatabase",perform:e=>{const o=b.j4({environment:t,transaction:e,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,type:"collection_view",useCrdt:r.useCrdt()}),n=b.ae({environment:t,table:v.np,value:{type:"table",parent_id:o.id,parent_table:g.iU,alive:!0,space_id:a,format:{table_properties:c.table_properties,timeline_arrows_by:void 0,table_subitem_toggle_column:"title",property_filters:c.property_filters,collection_pointer:s},query2:d},transaction:e,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});return b.sW({store:o,data:{alive:!1,parent_id:a,parent_table:x.bx,view_ids:[n.id],permissions:[{type:"user_permission",role:"editor",user_id:i}]},transaction:e}),o}}).performResult}({environment:l,collectionContextStore:t});e&&p.bA({environment:l,blocks:[e],originRect:o,moveToContext:"ai_ephemeral_view",isAddTo:!0,isDefaultPrivateLocation:!0,forceShowPrivatePageOption:!0,onAccept:()=>{c(e)}})}),[l,t,o,c]);return"origin"===r?(0,A.jsx)(P,{collectionContextStore:t,onAddViewToClick:d}):"copy"===r?null:(0,m.t1)(r)}function P(e){const{collectionContextStore:t,onAddViewToClick:o}=e,{isMobile:i}=(0,n.Fy)(),a=(0,n.O7)(),d=(0,l.VK)((()=>t.collectionStore()),[t]),m=(0,l.VK)((()=>null==d?void 0:d.getIcon()),[d]),p=(0,l.VK)((()=>t.collectionViewBlockStore()),[t]),h=(0,r.yK)((e=>({icon:{color:e.regularIconColor,width:12,height:12},title:{display:"flex",alignItems:"center"},collectionIcon:{marginLeft:4,marginRight:2}})),[]),g=(0,y.F)({maxWidth:250}),v={key:"options",render:e=>(0,A.jsx)(j.Z,{...e}),items:[{key:"save",render:e=>(0,A.jsx)(k.Z,{...e,icon:(0,s.R)(h.icon),title:(0,A.jsx)(u.FormattedMessage,{id:"unlistedCollectionView.moreButton.save",defaultMessage:"Save as view inâ€¦"})}),action:()=>{o()}},{key:"open",render:e=>(0,A.jsx)(k.Z,{...e,icon:(0,c.J)(h.icon),title:(0,A.jsx)("div",{style:h.title,children:(0,A.jsx)(u.FormattedMessage,{id:"unlistedCollectionView.moreButton.open",defaultMessage:"Open {databaseName}",values:{databaseName:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(R.Z,{isEmptyPage:!1,size:i?18:16,disabled:!0,icon:m,style:h.collectionIcon}),d&&(0,A.jsx)(W.Z,{store:d})]})}})})}),action:()=>{K({environment:a,blockStore:p})}}]};return(0,A.jsx)(V.Z,{...g,children:(0,A.jsx)(T.Z,{type:T.i.Vertical,initialFocus:0,sections:[v]})})}async function K(e){const{environment:t,blockStore:o}=e;if(!o)return;const i=(0,S.ZP)({store:o,pageVisitSource:a.tY.AIEphemeralView});h.c4({environment:t,url:i});const{modalOverlayCollectionListViewStore:n,assistantMenuActions:l}=await C.L6.loader();n.close(),await l.closeAssistantRightHandSideMenu({environment:t})}},88077:(e,t,o)=>{o.d(t,{C:()=>n});var i=o(37810);function n(e){const{theme:t,isInHomeWidget:o}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...o?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:i.Z.fontWeight.regular,lineHeight:1,borderRadius:4}}}}]);