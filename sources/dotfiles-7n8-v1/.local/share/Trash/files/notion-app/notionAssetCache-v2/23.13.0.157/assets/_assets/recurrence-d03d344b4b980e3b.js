"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[653],{81575:(e,t,n)=>{n.d(t,{AK:()=>p,Mc:()=>o,OS:()=>d,Td:()=>g,Uu:()=>s,XC:()=>c,ZK:()=>_,e8:()=>m,gV:()=>u,hc:()=>f,n0:()=>v,u0:()=>y,xi:()=>l});var a=n(97978),r=n(15010),i=n(35057);function o(e){a.j(e,"add_slack_integration")}function s(e){a.j(e,"remove_slack_integration")}function c(e,t){a.j(e,"slack_notification_create",t)}function l(e,t){a.j(e,"slack_notification_delete",t)}function d(e,t){a.j(e,"slack_notification_update",t)}function u(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_render_button",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function m(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_render_invite_popup",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function p(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_click_invite_button",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function y(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_completed",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id,error:t.error,invite_stage:t.invite_stage})}function g(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_dismiss_popup",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function f(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_click_select_all",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_user_count:t.invited_user_count,is_unselect:t.is_unselect,invite_token_query:t.invite_token_query})}function v(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_start_slack_integration",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,from:t.from})}function _(e,t){const n=i.zt(),o=r.JF();a.j(e,"slack_imports_invite_complete_slack_integration",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,from:t.from,is_success:t.is_success})}},3992:(e,t,n)=>{n.r(t),n.d(t,{addRecurrence:()=>f,createRecurrenceInner:()=>_,deleteRecurrence:()=>v});var a=n(40506),r=n(98963),i=n(18844),o=n(6287),s=n(7032),c=n(1898),l=n(43627),d=n(97978),u=n(80444),m=n(6258),p=n(96802),y=n(9953),g=n(13447);function f(e){let{environment:t,blockStore:n,recurrence:c}=e;const l=n.getAutomationId(),d=function(e){return{...e,start_date:(0,a.Io)(new Date(e.start_date))}}(c);l?function(e,t,n,a){const c=n.getParentStore();if(!c||c.table!==o.vF)return;const l=n.getSpaceId(),d={table:r.cv,id:t,spaceId:l},u=m.Mz.createChildStore(n,d),p=u.getTrigger();if(!p)return;const f=u.getActionStores()[0];g.createAndCommit({environment:e,userAction:"recurrenceActions.updateRecurrence",perform:t=>{const r=h({automationId:u.id,spaceId:l,collectionPointer:c.getSpaceShardedPointer(),templatePageId:n.id});let o;f?(o=f.id,y.sW({store:f,data:r,transaction:t})):(o=(0,s.ZP)(),y.ae({environment:e,table:i.Xj,inMemoryRecordCache:u.inMemoryRecordCache,transaction:t,value:{id:o,...r}})),y.sW({store:u,data:{alive:!0,status:"active",trigger:{id:p.id,type:"recurrence",recurrence:a},action_ids:[o]},transaction:t})}}),M(e,{type:"updated",frequency:a.frequency})}(t,l,n,d):function(e,t,n){g.createAndCommit({environment:e,userAction:"recurrenceActions.createRecurrence",perform:a=>{_(a,e,t,n)}})}(t,n,d)}function v(e){let{environment:t,blockStore:n}=e;const a=n.getAutomationStore();(0,c.$K)(a)&&(g.createAndCommit({environment:t,userAction:"recurrenceActions.deleteRecurrence",perform:e=>{l.disableAutomation({automationStore:a,environment:t,transaction:e}),l.deleteAutomation({automationStore:a,environment:t,transaction:e})}}),M(t,{type:"deleted"}))}function _(e,t,n,a){const{currentUserRootStore:c}=u.default.state;if(!c)return;const l=n.getParentStore();if(!l||l.table!==o.vF)return;if(!l.getParentBlockStore())return;const d=n.getSpaceId(),m=(0,s.ZP)(),g=(0,s.ZP)();y.ae({environment:t,table:r.cv,inMemoryRecordCache:n.inMemoryRecordCache,value:{id:m,parent_id:n.id,parent_table:n.table,alive:!0,space_id:d,status:"active",trigger:{id:(0,s.ZP)(),type:"recurrence",recurrence:a},action_ids:[g]},transaction:e}),p.FH({stores:[n],update:{automation_id:m},transaction:e}),y.ae({environment:t,table:i.Xj,inMemoryRecordCache:n.inMemoryRecordCache,transaction:e,value:{id:g,...h({automationId:m,spaceId:d,collectionPointer:l.getSpaceShardedPointer(),templatePageId:n.id})}}),M(t,{type:"created",frequency:a.frequency})}function h(e){const{automationId:t,spaceId:n,collectionPointer:a,templatePageId:i}=e;return{parent_id:t,parent_table:r.cv,type:"create_page",alive:!0,space_id:n,config:{collection:a,template_page_id:i}}}function M(e,t){d.j(e,"recurrence_saved",t)}},93289:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(67294),r=n(13991),i=n(77907),o=n(85893);const s=function(e){let{firstDayOfWeek:t,value:n,selectValue:s=!0,onChange:c,disabledDays:l}=e;const d=(0,a.useMemo)((()=>new Date(n)),[n]),[u,m]=(0,a.useState)(d),p=(0,a.useRef)(n);(0,a.useLayoutEffect)((()=>{p.current!==n&&(m(new Date(n)),p.current=n)}),[n]);const y=(0,a.useCallback)(((e,t,n)=>{c(e.getTime())}),[c]);return(0,o.jsx)(i.LazyDayPicker,{locale:r.SP,className:"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:s?{value:d}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:y,onMonthSelected:m,disabled:l,month:u})}},41532:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H,defaultRecurrenceConfig:()=>J});var a=n(30120),r=n(67294),i=n(480),o=n(24405),s=n(40506),c=n(53877),l=n(42853),d=n(53523),u=n(24211),m=n(81491),p=n(9291),y=n(53965),g=n(1898),f=n(19584),v=n(28020),_=n(60709),h=n(25498),M=n(77080),b=n(52275),k=n(31945),x=n(96525),R=n(88359),I=n(74194),j=n(3386),S=n(78140),w=n(28992),C=n(32163),P=n(89728),A=n(72495),F=n(7931),E=n(64369),D=n(93289),L=n(84795),T=n(26388),Z=n(85893);function q(e){const t=(0,i.O7)(),{device:n}=t,s=(0,p.useIntl)(),[c,l]=(0,r.useState)(e.value),[d,u]=(0,r.useState)(void 0),m=t=>{const n=(0,L.TD)(t,s),r=a.ou.fromFormat(n??"","T");return r.isValid?(u(void 0),e.onUpdate({hour:r.hour,minute:r.minute})):(u("invalid"),e.onError&&e.onError()),r},y=e=>{const t=e.target.value;l(t),m(t)},g=()=>{const e=m(c);e.isValid&&l(e.toLocaleString(a.ou.TIME_SIMPLE))},f=(0,o.yK)((e=>({input:{textAlign:"right"},error:{boxShadow:e.outlineRedInputBoxShadow}})),[]);return(0,Z.jsx)(T.ZP,{renderTooltip:()=>function(e){if("invalid"===e)return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Invalid time",id:"timeInput.invalid"})}(d),forceVisibleState:void 0!==d,placement:T.ug.Bottom,render:()=>(0,Z.jsx)(I.Z,{type:"text",onChange:y,onSubmit:g,onBlur:g,value:c,size:1,style:{...e.style,...d?f.error:{},fontSize:n.isMobile?16:14},inputStyle:f.input})})}var O=n(62069),U=n(67149),B=n(7057),N=n(64921);function z(e){const{weekdays:t,onChange:n}=e,a=e.minimumSelection??0,r=(0,p.useIntl)(),i=(0,o.yK)((e=>({wrapper:{display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"center"},selectedDay:{...W,background:e.blueButtonBackground,color:e.regularInvertedTextColor},unselectedDay:{...W,background:e.accentColors.gray[50],color:e.mediumTextColor},selectedDayHover:{background:e.blueButtonHoveredBackground},unselectedDayHover:{background:e.accentColors.gray[100]},selectedDayPressed:{background:e.blueButtonPressedBackground},unselectedDayPressed:{background:e.accentColors.gray[200]}})),[]);return(0,Z.jsx)(j.Z,{debugName:"WeekdaySelector",capture:!0,children:(0,Z.jsx)("div",{style:{...i.wrapper,...e.style},children:U.Z.map(((o,s)=>(0,Z.jsx)(N.Z,{...e,onClick:()=>{const e=t.includes(o)?t.length>a?t.filter((e=>e!==o)):t:[...t,o];n(e)},style:t.includes(o)?i.selectedDay:i.unselectedDay,hoveredStyle:t.includes(o)?i.selectedDayHover:i.unselectedDayHover,pressedStyle:t.includes(o)?i.selectedDayPressed:i.unselectedDayPressed,children:(0,B.er)(r,s+1)},o)))})})}const W={borderRadius:"50%",marginLeft:3,marginRight:3,height:25,width:25,fontSize:14,paddingTop:2};const H=(0,r.forwardRef)((function(e,t){const{recurrence:n,onChange:_,labelOnly:M}=e,w=(0,i.O7)(),{device:L}=w,T=(0,o.Fg)(),U=(0,p.useIntl)(),[B,N]=(0,r.useState)(void 0),[W,H]=(0,r.useState)(J()),[ne,re]=(0,r.useState)(!0),ie=Boolean(n);void 0===B&&(void 0!==n?(H({...n,hour:n.hour??0,minute:n.minute??0,start_date:(0,s.YL)(n.start_date)}),N(!0)):N(!1));const oe=e=>{const t="week"!==e||void 0!==W.weekdays&&0!==W.weekdays.length?W.weekdays:[(n=W.start_date,(0,g.Yd)(m.RRULE_WEEKDAYS_MAP)[a.ou.fromMillis(n).weekday-1])];var n;H({...W,weekdays:t,frequency:e}),N(!0)},se=()=>{_(W)},ce=L.isMobile?k.Z4.SlideUp:k.Z4.Popup,le=function(){const{isMobile:e}=(0,i.Fy)();return(0,o.yK)((t=>({iconStyle:{fill:t.regularIconColor,width:e?18:16},customFrequencySelectButton:{color:t.mediumTextColor,fill:t.lightIconColor,fontWeight:500,fontSize:12},weekdayWrapper:{padding:10},inputLabel:{display:"flex",alignItems:"center",...e?{padding:"10px 14px",fontSize:16,background:t.cardBackground}:{paddingLeft:8}},intervalFrequencyLabel:{color:t.lightTextColor},intervalInputWrapper:{width:70,marginLeft:10,marginRight:10},intervalInput:{textAlign:"right"},timeInputWrapper:{width:90,marginLeft:10,marginRight:10},inputSection:{...K,alignItems:"center",justifyContent:"flex-start",padding:8},chevron:{width:e?14:10,fill:t.lightIconColor,marginLeft:4}})),[e])}(),de=L.isMobile?"number":"text",ue=h.m.map((e=>{const t={key:e.frequency,action:()=>{oe(e.frequency)},render:t=>(0,Z.jsx)(b.Z,{...t,title:X(e.frequency)})};return t})),me=(0,Z.jsx)(j.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onLeft:y.yR,onRight:y.yR,onSelectAll:y.yR,onRedo:y.yR,onUndo:y.yR,onCut:y.yR,onCopy:y.yR,onPaste:y.yR,onKeypress:y.yR,onDelete:y.yR,onBackspace:y.yR,onTab:y.yR,children:(0,Z.jsx)(I.Z,{value:W.interval.toString(),style:le.intervalInputWrapper,inputStyle:le.intervalInput,type:de,maxlength:3,onChange:e=>{const t=parseInt(e.target.value);(0,f.hj)(t)&&t>0&&t<=m.MAX_RECURRENCE_INTERVAL&&H({...W,interval:t})},onBlur:e=>{e.target.value=W.interval.toString()}})});return(0,Z.jsx)(x.Z,{...e,disabled:e.disabled,popupType:ce,ref:t,stopClickPropagation:!0,renderOrigin:t=>M?(0,Z.jsxs)(P.Z,{...t,children:[te({isActive:ie,recurrence:n,intl:U}),(0,l.i)({width:10,marginLeft:4,fill:T.lightIconColor})]}):(0,Z.jsx)(R.Z,{...t,icon:(0,d.N)(le.iconStyle),title:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.actionMenu.repeat"}),focused:e.focused,showExtensionArrow:L.isMobile,right:te({isActive:ie,recurrence:n,intl:U})}),render:e=>(0,Z.jsx)(j.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onEnter:y.yR,children:(0,Z.jsxs)(S.Z,{...Q(e,L.isMobile,ne,se),children:[B?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(A.Z,{style:K,children:[(0,Z.jsx)(F.Z,{innerButtonStyle:{...!L.isMobile&&le.customFrequencySelectButton},selectedTitle:Y(W.frequency),renderMenuSections:t=>[{key:"repeatOptionsSection",render:e=>(0,Z.jsx)(A.Z,{...e}),items:[...$({parent:t,updateFrequencyFn:e=>{oe(e)}}),ee({environment:w,parent:t,onChange:_,onClose:()=>{N(!1),e.close()}})]}]}),!L.isMobile&&(0,Z.jsx)(P.Z,{isBlue:ne,isLightGray:!ne,onClick:t=>{se(),e.close()},disabled:!ne,children:V})]}),(0,Z.jsx)(A.Z,{style:le.inputSection,shouldShowBottomDivider:!0,children:(0,Z.jsx)(E.Z,{style:le.inputLabel,children:G(me,W.frequency,le.intervalFrequencyLabel)})}),"week"===W.frequency&&(0,Z.jsx)(A.Z,{children:(0,Z.jsx)(z,{style:le.weekdayWrapper,focused:!0,weekdays:W.weekdays||[],minimumSelection:1,onChange:e=>{H({...W,weekdays:e})}})}),(0,Z.jsx)(A.Z,{topBorder:!0,children:(0,Z.jsx)(k.ZP,{popupType:ce,renderOrigin:e=>(0,Z.jsx)(R.Z,{...e,title:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Starts",id:"database.templatePickerItem.repeatMenu.starts"}),focused:!1,showExtensionArrow:L.isMobile,right:a.ou.fromMillis(W.start_date).setLocale((0,u.E2)(U)).toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}),render:e=>(0,Z.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,Z.jsx)(D.Z,{firstDayOfWeek:v.AK.state,value:Math.max(W.start_date,Date.now()),onChange:t=>{H({...W,start_date:t}),e.close()},disabledDays:{before:new Date}})})})}),(0,Z.jsx)(A.Z,{style:le.inputSection,shouldShowBottomDivider:!0,children:(0,Z.jsxs)(E.Z,{style:le.inputLabel,children:[(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Create at",id:"database.templatePickerItem.repeatMenu.createAt"}),(0,Z.jsx)(j.Z,{debugName:"RecurrenceConfigMenu",capture:!0,onLeft:y.yR,onRight:y.yR,onSelectAll:y.yR,onRedo:y.yR,onUndo:y.yR,onCut:y.yR,onCopy:y.yR,onPaste:y.yR,onKeypress:y.yR,onDelete:y.yR,onBackspace:y.yR,onTab:y.yR,children:(0,Z.jsx)(q,{value:a.ou.local().set({hour:W.hour,minute:W.minute}).toLocaleString(a.ou.TIME_SIMPLE),style:le.timeInputWrapper,onUpdate:e=>{H({...W,...e}),re(!0)},onError:()=>{re(!1)}})}),(0,Z.jsx)(O.Z,{renderOrigin:e=>(0,Z.jsxs)(P.Z,{...e,children:[(0,c.er)(W.timezone),(0,l.i)(le.chevron)]}),onSelect:e=>{H({...W,timezone:e})}})]})})]}):(0,Z.jsx)(C.Z,{type:C.i.Vertical,sections:[{key:"repeatOptionsSection",render:e=>(0,Z.jsx)(A.Z,{...e}),items:[...ue,ee({environment:w,parent:e,onChange:_})]}],initialFocus:void 0}),B&&ae(U,W,T)]})})})})),K={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px"};function J(){return{start_date:a.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,c.Sv)(),hour:0,minute:0,frequency:"day",interval:1}}const V=(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Save",id:"database.templatePickerItem.customRecurrence.save"});function X(e){switch(e){case"day":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Daily",id:"database.templatePickerItem.quickOptionMenuItem.day"});case"week":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Weekly",id:"database.templatePickerItem.quickOptionMenuItem.week"});case"month":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Monthly",id:"database.templatePickerItem.quickOptionMenuItem.month"});case"year":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Yearly",id:"database.templatePickerItem.quickOptionMenuItem.year"});default:(0,g.t1)(e)}}function Y(e){switch(e){case"day":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat daily",id:"database.templatePickerItem.recurrenceFrequency.daily"});case"week":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat weekly",id:"database.templatePickerItem.recurrenceFrequency.weekly"});case"month":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat monthly",id:"database.templatePickerItem.recurrenceFrequency.monthly"});case"year":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat yearly",id:"database.templatePickerItem.recurrenceFrequency.yearly"});default:(0,g.t1)(e)}}function G(e,t,n){switch(t){case"day":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>days</label>",id:"database.templatePickerItem.recurrenceInterval.everyXdays",values:{label:e=>(0,Z.jsx)("label",{style:n,children:e}),interval:e}});case"week":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>weeks</label>",id:"database.templatePickerItem.recurrenceInterval.everyXweeks",values:{label:e=>(0,Z.jsx)("label",{style:n,children:e}),interval:e}});case"month":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>months</label>",id:"database.templatePickerItem.recurrenceInterval.everyXmonths",values:{label:e=>(0,Z.jsx)("label",{style:n,children:e}),interval:e}});case"year":return(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Every {interval} <label>years</label>",id:"database.templatePickerItem.recurrenceInterval.everyXyears",values:{label:e=>(0,Z.jsx)("label",{style:n,children:e}),interval:e}});default:(0,g.t1)(t)}}function Q(e,t,n,a){return t?{menuType:_.og.Modal,title:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.mobileRepeatModal.title"}),left:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Cancel",id:"database.templatePickerItem.customRecurrence.cancel"}),right:V,rightDisabled:!n,onClickRight:()=>{n&&(a(),e.close())},onClickLeft:()=>{e.close()}}:{menuType:_.og.Popup}}function $(e){let{parent:t,updateFrequencyFn:n}=e;return h.m.map((e=>({key:e.frequency,action:()=>{n(e.frequency),t.close()},render:t=>(0,Z.jsx)(b.Z,{...t,title:Y(e.frequency)})})))}function ee(e){let{environment:t,parent:n,onChange:a,onClose:r}=e;return{key:"disable",action:()=>{a(void 0),n.close(),r&&r()},render:e=>(0,Z.jsx)(b.Z,{...e,title:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.quickOptionMenuItem.off"})})}}function te(e){let{isActive:t,recurrence:n,intl:a}=e;return t?n?(0,Z.jsx)(Z.Fragment,{children:ne(n,a)}):void 0:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.recurrenceConfigMenuLabel.off"})}function ne(e,t){return(0,m.rruleFromRecurrence)({...e,weekdays:void 0,hour:0,minute:0}).toText((e=>{switch(e){case"every":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.every",defaultMessage:"every"});case"day":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.day",defaultMessage:"day"});case"days":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.days",defaultMessage:"days"});case"week":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.week",defaultMessage:"week"});case"weeks":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weeks",defaultMessage:"weeks"});case"month":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.month",defaultMessage:"month"});case"months":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.months",defaultMessage:"months"});case"year":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.year",defaultMessage:"year"});case"years":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.years",defaultMessage:"years"});default:return e.toString()}}))}function ae(e,t,n){const r=(0,m.rruleFromRecurrence)({...t,start_date:(0,s.Io)(new Date(t.start_date))}).after(new Date((0,s.Io)()));if(!r)return null;const i=a.ou.fromJSDate(r).toUTC().setLocale((0,u.E2)(e)).toLocaleString(a.ou.DATETIME_SHORT),o=a.ou.fromJSDate(r).toUTC().setLocale((0,u.E2)(e)).toLocaleString(a.ou.DATE_SHORT),c=M.default.checkGate("recurrence_queue_task_improvements");return 0===t.hour&&c?(0,Z.jsx)(A.Z,{topBorder:!0,children:(0,Z.jsx)(w.Z,{caption:(0,Z.jsx)("span",{style:{color:n.lightTextColor},children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Next: {dates} (between 12-3 AM)",id:"database.templatePickerItem.recurrenceConfigMenuLabel.nextAtMidnightMessage",values:{dates:o}})})})}):(0,Z.jsx)(A.Z,{topBorder:!0,children:(0,Z.jsx)(w.Z,{caption:(0,Z.jsx)("span",{style:{color:n.lightTextColor},children:(0,Z.jsx)(p.FormattedMessage,{defaultMessage:"Next: {dates}",id:"database.templatePickerItem.recurrenceConfigMenuLabel.next",values:{dates:i}})})})})}},25498:(e,t,n)=>{n.d(t,{m:()=>i,w:()=>o});n(57658);var a=n(81491),r=n(98165);const i=[{frequency:"day",interval:1},{frequency:"week",interval:1},{frequency:"month",interval:1},{frequency:"year",interval:1}];function o(e){const t=r.qA(e)??[],n=[];for(const a of t){if(!("block"===a.table&&!0===a.isTemplate()&&a.getFormat().automation_id&&a.id!==e.id))continue;const t=a.getAutomationStore();if(t){if(!t.isReady())return{automationStoresReady:!1};void 0!==t.getRecurrence()&&t.isDefined()&&n.push(t.getModel())}}return{automationStoresReady:!0,...(0,a.templateAncestorsViolateRecurrenceNesting)(n)}}},54983:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(49085);class r extends a.default{getInitialState(){return{}}}const i=r},53523:(e,t,n)=>{n.d(t,{N:()=>i});n(67294);var a=n(45238),r=n(85893);const i=(0,a.IU)("repeat",{viewBox:"0 0 16 14",svg:(0,r.jsx)("path",{d:"M1.185 7.317a.689.689 0 00.697-.704v-.601c0-1.19.806-1.942 2.064-1.942H9.23v1.573c0 .328.199.52.527.52a.66.66 0 00.403-.144l2.68-2.236c.253-.212.26-.547 0-.765L10.16.782A.62.62 0 009.757.64c-.328 0-.527.184-.527.52v1.53H4.05C1.875 2.69.48 3.9.48 5.875v.738c0 .397.308.704.705.704zm13.624-.649a.689.689 0 00-.698.704v.608c0 1.19-.806 1.942-2.064 1.942H6.763V8.35c0-.329-.199-.52-.527-.52a.66.66 0 00-.403.144l-2.68 2.242c-.26.212-.26.547 0 .759l2.68 2.242a.66.66 0 00.403.143c.328 0 .527-.191.527-.52v-1.544h5.181c2.174 0 3.569-1.21 3.569-3.179v-.745a.695.695 0 00-.704-.704z"})})},81491:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>p,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>d,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>l,MAX_RECURRENCE_INTERVAL:()=>s,RRULE_WEEKDAYS_MAP:()=>o,getRecurrenceAfter:()=>m,rruleFromRecurrence:()=>c,templateAncestorsViolateRecurrenceNesting:()=>u});var a=n(30120),r=n(84885);const i={day:r.Ci.DAILY,week:r.Ci.WEEKLY,month:r.Ci.MONTHLY,year:r.Ci.YEARLY},o={MO:r.Ci.MO,TU:r.Ci.TU,WE:r.Ci.WE,TH:r.Ci.TH,FR:r.Ci.FR,SA:r.Ci.SA,SU:r.Ci.SU},s=100;function c(e){const{start_date:t,frequency:n,interval:a,weekdays:s,timezone:c,hour:l,minute:d}=e,u="week"===n&&s?s.map((e=>o[e])):void 0;return new r.Ci({freq:i[n],dtstart:new Date(t),interval:a,byweekday:u,tzid:c,byhour:l??0,byminute:d??0,bysecond:0})}const l=1,d=1;function u(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),a=e.length,r=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=a>l,o=n.length>=d;return{violatesConstraint:i||o,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:o,nestedDepthOfAutomationAncestors:a,immediateAncestorRecurrenceType:r}}function m(e){const{recurrence:t,afterDate:n}=e,r=c({...t}).after(new Date(n));if(!r)return;return a.ou.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).toJSDate()}const p=100}}]);