"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9511],{15944:(e,t,n)=>{n.d(t,{o:()=>p,q:()=>h});var o=n(86628),i=n(68056),r=n(89086),s=n(28685),a=n(80444),l=n(24666),c=n(13447),d=n(37181);function u(){const e=l.default.state;if("editing"===e.mode){const t=(0,i.QY)(e.multiSelection);if(t&&(0,r.wd)(t.selection)){const e=t.store,n=s.E.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,o.VK)(u,[])}function h(e){const{currentUserSettingsStore:t}=a.default.state;t&&c.createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{d.d2({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},userId:t.id})}},20073:(e,t,n)=>{n.d(t,{I:()=>r,O:()=>i});var o=n(23883);function i(e){const{cursors:t,rootStore:n}=e,i={};for(const o of t)for(const e of o.stack)for(const t of e)i[t.id]=t.index;o.Z.setLimitParents(n,i)}function r(e){o.Z.removeLimitParents(e.rootStore)}},73966:(e,t,n)=>{n.d(t,{k2:()=>l,l6:()=>a,wk:()=>s});var o=n(42875),i=n(13447),r=n(37181);function s(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),r=null==i?void 0:i.time_zone,s=(0,o.r)();r!==s&&a({environment:t,userSettingsStore:n,timeZone:s})}function a(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;i.createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,perform:e=>{r.d2({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;i.createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,perform:e=>{r.d2({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},41464:(e,t,n)=>{n.d(t,{Z:()=>b});n(67294);var o=n(83355),i=n(36154),r=n(36610),s=n(68204),a=n(35328),l=n(77907),c=n(95802),d=n(8949),u=n(77080),p=n(22294),h=n(86486),g=n(27724),m=n(38870),f=n(85893);class v extends o.Z{constructor(){super(...arguments),this.prevX=void 0,this.prevY=void 0,this.handleWindowMouseMove=e=>{e.clientX===this.prevX&&e.clientY===this.prevY||(this.prevX=e.clientX,this.prevY=e.clientY,p.Z.setKeyboardMode(!1))}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),window.addEventListener("mousemove",this.handleWindowMouseMove)}willUnmount(){super.willUnmount(),window.removeEventListener("mousemove",this.handleWindowMouseMove)}renderComponent(){const e=function(e,t,n){const o={};for(const r of i.L6)for(const i of r.shortcuts)o[i]=o=>y(i,o,e,t,n);return o}(this.props.markdownLinkifyIt,this.props.tinyMceMicrosoftWordPasteFilter,this.environment);return(0,f.jsx)(m.Z,{debugName:this.props.debugName,priority:this.props.priority,enable:this.props.capture,shortcuts:e})}}function b(e){const{value:t}=(0,l.useDependency)(l.deps.markdownLinkifyIt),{value:n}=(0,l.useDependency)(l.deps.tinyMceMicrosoftWordPasteFilter);return(0,f.jsx)(v,{...e,markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n})}function S(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(d.Z.state.isActive&&!u.default.checkGate("block_menu_shortcut_fix"))}function y(e,t,n,o,l){if(!S())return;const m=g.default.state.stores,f=g.default.state.pivot||m[0],v=f&&c.C.getRectFromStore(f),b=i.L6.find((t=>!!t.shortcuts.some((t=>t===e))&&s.vG(t,{environment:l,blocks:m,originRect:v,publicEditMode:void 0})));if(b){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=d.Z.state.isActive;b.action({environment:l,blocks:m,originRect:v,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}},t);const i=m[0];let s,c,g,f;var y;if(i)s=i.getType(),c=s?(0,a._A)(s,i.getFormat()):void 0,g=null===(y=i.getCollectionViewCollectionStore())||void 0===y?void 0:y.id,f=i.getParentCollectionIdUpToTwoLevels();r.dh(l,{analyticsName:b.analyticsName,action_type:b.analyticsActionType,from:"keyboard_shortcut",block_id:null==i?void 0:i.id,block_type:s,is_toggleable:c,collection_id:g,parent_collection_id:f}),C={resetBlockMenuStore:e},p.Z.setKeyboardMode(!0),h.default.reset(),u.default.checkGate("block_menu_shortcut_fix")&&C.resetBlockMenuStore&&d.Z.reset()}var C}v.displayName="ActionRegistryShortcutListener"},3403:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(34232),i=n(68785),r=n(85893);function s(){const e=(0,o.Z)(!0,400);return(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e&&(0,r.jsx)(i.Z,{})})}},24085:(e,t,n)=>{n.d(t,{T:()=>Ce,Z:()=>ke});var o=n(67294),i=n(82540),r=n(480),s=n(97511),a=n(86628),l=n(24405),c=n(80503),d=n(51454),u=n(53965),p=n(1898),h=n(51787),g=n(47678),m=n(20073),f=n(61045),v=n(3898),b=n(72899),S=n(10906),y=n(7401),C=n(28020),w=n(43250),k=n(75079),x=n(19124),M=n(51783),R=n(52533),I=n(50627),P=n(46654),L=n(66430),T=n(45010),_=n(77907),A=n(18245);const Z=(0,_.lazyComponent)(_.deps.personalHome,(e=>e.PersonalHomeContainer));var j=n(94841),B=n(61931),V=n(16746),E=n(24646),q=n(38676),K=n(34859),O=n(80444),D=n(88632),N=n(24042),U=n(21051),F=n(17903),z=n(19111),W=n(56638),H=n(82136),$=n(88923),G=n(83212),J=n(87956),Y=n(23063),X=n(68785),Q=n(53336),ee=n(60651),te=n(9291),ne=n(47839),oe=n(73063),ie=n(34700),re=n(85893);const se=(0,te.defineMessages)({menu:{defaultMessage:"Menu",id:"topbar.appMenuButton.title"}});function ae(){const e=(0,te.useIntl)();return(0,re.jsx)(oe.Z,{style:{position:"absolute",top:"10px",left:"14px",width:24,height:24,zIndex:1e5,...(0,ie.X)({noDrag:!0})},iconStyle:{width:16,height:16},isDarkIconColor:!0,onClick:()=>{ne.openAppMenu()},icon:ee.h,ariaLabel:e.formatMessage(se.menu)})}var le=n(26957),ce=n(31701),de=n(36610),ue=n(58297);const pe=function(){const e=(0,r.O7)();let t;return(0,a.VK)((()=>D.Z.state.online),[])?t=(0,re.jsx)(te.FormattedMessage,{defaultMessage:"Oops, there was an error loading this page. Refresh to load it again.",id:"pageErrorIndicator.loadingError.message"}):(de.DC(e,{type:"page_error_indicator"}),t=e.defaultRecordCache.persistedRecordCache?(0,re.jsx)(te.FormattedMessage,{defaultMessage:"Please go online to load this page, then you'll be able to access it while offline.",id:"pageOfflineIndicator.hasLocalData.message"}):(0,re.jsx)(te.FormattedMessage,{defaultMessage:"Oops, you seem to be offline. Please go online to view this page.",id:"pageOfflineIndicator.noLocalData.message"})),(0,re.jsxs)("div",{style:me(e),children:[(0,re.jsx)("div",{style:ge(e),children:t}),(0,re.jsx)(ue.Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,re.jsx)(te.FormattedMessage,{defaultMessage:"Refresh",id:"pageErrorIndicator.reloadButton.label"})})]})};function he(e){return e.currentUser.isLoggedIn()}function ge(e){const{device:t}=e;return{fontSize:t.isMobile?18:32,marginBottom:8,textAlign:"center",color:ce.ZP.uiBlack,maxWidth:640,lineHeight:1.3}}function me(e){const{device:t}=e;return{height:"100%",minHeight:he(e)?`calc(100vh - ${2*c.R6(e.device.isElectronMac)}px)`:"100vh",paddingLeft:t.isMobile?16:32,paddingRight:t.isMobile?16:32,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}var fe=n(69206),ve=n(31192),be=n(78901),Se=n(3553),ye=n(99659);const Ce="1.375em",we=o.memo((function(e){let{store:t,routerState:n,collectionViewStore:s}=e;const u=(0,r.O7)(),{RouterStore:g}=u,f=(0,r.Fy)(),v=(0,o.useCallback)((e=>{J.Z.state&&("scroll"===e?J.Z.state.hadScroll||(J.Z.setState({...J.Z.state,hadScroll:!0}),h.Kk(u,{interactionType:e})):"click"===e?J.Z.state.hadClick||(J.Z.setState({...J.Z.state,hadClick:!0}),h.Kk(u,{interactionType:e})):"copy"===e?J.Z.state.hadCopy||(J.Z.setState({...J.Z.state,hadCopy:!0}),h.Kk(u,{interactionType:e})):(0,p.t1)(e))}),[u]);(0,o.useEffect)((()=>{if(v){const e=()=>{v("copy")};return addEventListener("copy",e),()=>removeEventListener("copy",e)}}),[v]),(0,o.useEffect)((()=>()=>m.I({rootStore:t})),[t]);const b=(0,a.SI)((()=>G.Z.getMode(u,t)),[u,t]),S=(0,a.VK)((()=>{const{presenceStore:e,pageVisitStore:n,currentSpaceStore:o,currentSpaceViewStore:i}=O.default.state;return{pageStore:t,spaceStore:o,spaceViewStore:i,presenceStore:e,pageVisitStore:n,publicEditModeStore:b}}),[b,t]),{pageVisitStore:y,presenceStore:k,spaceStore:x,spaceViewStore:M}=S,R=(0,a.VK)((()=>!t.isDefined()||!t.canRead()),[t]),I=(0,a.VK)((()=>u.currentUser.isLoggedIn()),[u]),P=(0,a.VK)((()=>O.default.state.mainEditorCurrentBlockStore),[]),L=(0,a.VK)((()=>C.h1(u)),[u]),T=(0,l.Fg)(),A=(0,a.VK)((()=>(0,j.WE)(P)),[P]),Z=(0,a.VK)((()=>{const e={flexGrow:0,flexShrink:1,display:"flex",flexDirection:"column",background:A?(0,B.$1)({theme:T,isPhone:f.isPhone}):T.contentBackground,zIndex:d.Wi,height:f.isMobile?"100vh":`calc(100vh - ${c.R6(f.isElectronMac)}px)`,maxHeight:"100%",...f.isTablet&&{position:"relative"},position:"relative",...A?{height:"100%",position:"absolute"}:{}};if(!(0,E.Jr)(u)){const t=q.sidebarOpenStore.state;(0,E.YR)(u)||(e.boxShadow=T.mediumBoxShadow),e.pointerEvents=t?"none":"auto",e.transform="translateX(0)"}return!L&&f.isMobileNative&&(e.pointerEvents="auto",e.transform="translateX(0px)"),e}),[f.isElectronMac,f.isMobile,f.isPhone,f.isTablet,f.isMobileNative,u,L,T,A]),K=(0,a.VK)((()=>"nativeTab"===g.state.route.name),[g]),F=(0,a.VK)((()=>!D.Z.state.online),[]),[z,W]=(0,a.VK)((()=>{const e=(0,E.$3)(u);return[e,e+(0,E.vJ)(u)]}),[u]),H=(0,a.VK)((()=>Boolean(t.getAppContainerBlockStore())),[t]),$=(0,a.VK)((()=>q.sidebarResizingStore.state),[]),X=(0,a.VK)((()=>t.getAppContainerBlockStore()),[t]),{isShowingTabBar:Q,isUnifiedTitleBarEnabled:ee}=(0,a.VK)((()=>{var e;return{isShowingTabBar:N.Z.state.isShowingTabBar,isUnifiedTitleBarEnabled:Boolean(null===(e=N.Z.state.preferences)||void 0===e?void 0:e.isUnifiedTitleBarEnabled)}}),[]),te=(0,a.VK)((()=>U.Z.state.banners),[]),ne=(0,a.VK)((()=>!Q&&!(0,E.in)(u)&&!V.Z.isVisible()),[u,Q]),oe=(0,a.VK)((()=>"personal_home_page"===t.getType()),[t]);return(0,re.jsx)(i.Mi,{value:S,children:(0,re.jsxs)("div",{className:K?"hidden":"",style:{display:"flex",flexDirection:"column",width:f.isTablet?"unset":"100%",overflow:f.isTablet?"unset":"hidden"},children:[!f.isMobile&&!H&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(ye.ZP,{store:t,spaceStore:x,spaceViewStore:M,pageVisitStore:y,presenceStore:k,showSidebarButton:ne,isElectron:f.isElectron,isInvalidPage:R,banners:te}),ee&&f.isElectronWindows&&!Q&&(0,re.jsx)(ae,{})]}),(0,re.jsx)(Y.Z,{isVisible:!0,animationStyle:{width:A?W:z},skipAnimation:Q&&$.isResizing,render:()=>(0,re.jsxs)("main",{style:Z,className:w.Wiy,children:[f.isMobile&&(0,re.jsx)(_.LazyTopbarMobile,{store:t,collectionViewStore:s,spaceStore:x,spaceViewStore:M,pageVisitStore:y,presenceStore:k,isInvalidPage:R,shouldShowAddTo:Boolean(n.route.showMoveTo&&t.canEdit()&&I),banners:te,isOffline:F}),X?(0,re.jsx)(xe,{appContainerStore:X}):oe?(0,re.jsx)(Re,{store:t}):(0,re.jsx)(Ie,{store:t,routerState:n,maybeLogSearchInteractionEvent:v}),I&&f.isMobile&&(0,re.jsx)(Me,{store:t}),f.isMobileNative&&I&&P&&(0,re.jsx)(_.LazyMobileBottomBar,{})]})})]})})})),ke=we;function xe(e){let{appContainerStore:t}=e;return(0,re.jsx)("div",{style:{position:"absolute",height:"100vh",width:"100%"},children:(0,re.jsx)(_.LazyAppInitializationOverlay,{collectionViewBlockStore:t})})}function Me(e){var t;let{store:n}=e;const i=(0,r.O7)(),s=(0,a.VK)((()=>{var e;return null===(e=i.mobileNative)||void 0===e?void 0:e.api.renderMobileActionBar}),[null===(t=i.mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar]),l=(0,o.useCallback)((e=>{const{isMobileNative:t}=i.device;return(0,re.jsx)(_.LazyMobileActionBar,{stores:e,position:t?R.nd.Bottom:R.nd.Floating,currentBlockStore:n})}),[i.device,n]);return(0,M.LQ)({environment:i})?(0,re.jsx)(_.LazyMobileActionBarWrapper,{currentBlockStore:n,makeActionBarComponent:e=>(0,re.jsx)(_.LazyNativeMobileActionBar,{renderApi:s,stores:e,currentBlockStore:n,fallbackRenderer:l})}):(0,re.jsx)(_.LazyMobileActionBarWrapper,{currentBlockStore:n,makeActionBarComponent:l})}const Re=o.memo((function(e){let{store:t}=e;return(0,re.jsx)(Se.Z,{disable:!0,store:t,isDefaultContainer:!0,render:()=>(0,re.jsx)(Z,{})})}));function Ie(e){let{store:t,routerState:n,maybeLogSearchInteractionEvent:i}=e;const s=(0,r.O7)(),{RouterStore:l}=s,{historyState:c}=n,{currentLoadingContainerStore:d,pageVisitStore:p}=(0,a.VK)((()=>O.default.state),[]),h=(0,a.VK)((()=>c&&u.hj(c.scrollTop)?c.scrollTop:void 0),[c]),m=(0,a.VK)((()=>Boolean((0,P.IJ)(s,t))),[s,t]),f=(0,a.VK)((()=>Boolean($.default.isCenterPeekOpen()||W.Z.state.open)),[]);return(0,re.jsx)(Se.Z,{store:t,isDefaultContainer:!0,droppable:!0,isRootContainer:!0,disableRectangularSelection:m,disable:f,render:e=>{let{selectableEvents:n,selectableHoverMenuOverlay:r}=e;return(0,re.jsx)(o.Suspense,{fallback:(0,re.jsx)(le.Z,{isVisible:!0,store:t}),children:(0,re.jsx)(fe.Z,{pageStore:t,pageVisitStore:p,scrollToBlockIds:v.uE(l),scrollToPosition:h,store:d,onReady:()=>{g.Y(s,{animateScrollToBlocks:!1})},onDone:()=>{t.isCollectionView()||"rendered"===O.default.state.renderPhase||O.default.setState({...O.default.state,renderPhase:"rendered"})},initialChunkSize:L.OZ,incrementChunkSize:30,render:e=>{let{error:o,ready:s,initialRequestCompleted:a,endOfResultsReached:l,isCollectionInPage:c}=e;return(0,re.jsx)(Pe,{store:t,error:o,ready:s,initialRequestCompleted:a,endOfResultsReached:l,isCollectionInPage:c,selectableEvents:n,selectableHoverMenuOverlay:r,maybeLogSearchInteractionEvent:i})}})})}},t.id)}const Pe=o.memo((function(e){let{store:t,error:n,ready:i,initialRequestCompleted:l,endOfResultsReached:c,isCollectionInPage:d,selectableEvents:u,selectableHoverMenuOverlay:p,maybeLogSearchInteractionEvent:h}=e;const g=(0,r.O7)(),m=(0,r.Fy)(),{publicEditModeStore:v}=(0,s.l)()??{},w=(0,a.VK)((()=>(0,x.GD)(null==v?void 0:v.state)),[v]),M=(0,o.useCallback)((e=>{let{startTime:n,endTime:o}=e;const i=S.fm(t);A.default.measure({metricName:"collections.max_scroll_lag_in_session",startTime:n,endTime:o},{environment:g,data:k.vS(i)})}),[g,t]),R=(0,o.useCallback)((e=>{T.Z.PageScroller=e}),[]),I=(0,o.useCallback)((()=>{h("scroll")}),[h]),P=(0,o.useCallback)((e=>{u.onClick(e),h("click")}),[h,u]),L=(0,a.VK)((()=>t.isCollectionView()),[t]),Z=(0,a.VK)((()=>({spinner:{zIndex:1,opacity:.5,width:Ce,height:Ce,marginTop:`calc(-${Ce} / 2 - ${_e(g)} / 2)`,marginBottom:24,marginLeft:"auto",marginRight:"auto"},scroller:{display:"flex",flexDirection:"column",zIndex:1,flexGrow:1,position:"relative",...i?{}:{opacity:0,pointerEvents:"none",height:0},...L?{}:{alignItems:"center"}}})),[g,L,i]),j=(0,a.VK)((()=>$.default.isSidePeekOpen()?void 0:i?f.Q7(g):K.Z.All),[g,i]),B=(0,a.VK)((()=>C.Zy({environment:g,store:t})),[g,t]);return(0,re.jsxs)(o.Fragment,{children:[(0,re.jsxs)(Q.Z,{ref:R,onScrollLagMeasure:d?M:void 0,onScroll:I,preventType:j,type:B,style:Z.scroller,store:F.Z,...u,onClick:P,children:[p,!m.isPhone&&w&&(0,re.jsx)(b.GC,{scrollerStore:F.Z}),(0,re.jsx)(y.vo,{scrollerStore:F.Z}),(0,re.jsx)(_.LazyScrollableSitesBannerContainer,{blockStore:t}),l&&(0,re.jsx)(Le,{store:t,error:n}),i&&!c&&!(l&&n)&&(0,re.jsx)(X.Z,{style:Z.spinner})]}),m.isPhone&&w&&(0,re.jsx)(b.GC,{scrollerStore:F.Z}),(0,re.jsx)(le.Z,{isVisible:!i,store:t})]})})),Le=o.memo((function(e){let{store:t,error:n}=e;const{pageVisitStore:i,presenceStore:s,currentLoadingContainerStore:c}=(0,a.VK)((()=>O.default.state),[]),d=(0,r.O7)(),{WindowSizeStore:u,device:p}=(0,r.O7)(),h=(0,a.VK)((()=>u.state.height),[u]),[g,m]=(0,a.VK)((()=>{const e=(0,E.$3)(d),n=Math.max(I.zL,e),o=e+(0,E.vJ)(d),i=(0,S.Ks)(t)&&!t.isFullWidth()?n:o,r=p.isMobile&&z.Z.state.open?h:0;return[i,ve.ZP.paddingBottom(d,f._4()+r)]}),[p.isMobile,h,d,t]),v=(0,a.VK)((()=>$.default.isSidePeekOpen()||$.default.isSidePeekClosing.state),[]),b=(0,l.yK)((()=>({pageViewBlockStyle:v?{width:g,position:"absolute",left:0}:Te})),[v,g]);return(0,a.VK)((()=>{const e=c&&!c.state.endOfResultsReached,o=t.isDefined()&&t.canRead();return e&&n||!o}),[t,c,n])?(0,re.jsx)(pe,{}):(0,re.jsxs)(o.Fragment,{children:[(0,re.jsx)(ve.ZP,{context:H.S.Frame,style:b.pageViewBlockStyle,store:t,paddingBottom:m,disabled:!1}),(0,re.jsx)(be.Z,{pageVisitStore:i,presenceStore:s,isPeekView:!1})]})})),Te={};function _e(e){return"number"==typeof ve.ZP.paddingBottom(e)?`${ve.ZP.paddingBottom(e)}px`:ve.ZP.paddingBottom(e)}},26957:(e,t,n)=>{n.d(t,{Z:()=>v});n(67294);var o=n(480),i=n(86628),r=n(24405),s=n(70096),a=n(80503),l=n(9291),c=(n(95477),n(34232)),d=n(36596),u=n(68785),p=n(31192),h=n(85893);const g="1.375em";function m(e){let{store:t,peekMode:n}=e;const a=(0,o.O7)(),l=(0,i.VK)((()=>t.hasCover()),[t]),c=(0,i.VK)((()=>t.hasIcon()),[t]),u=(0,i.VK)((()=>t.isCollectionView()),[t]),g=(0,i.VK)((()=>t.isFullWidth()),[t]),m=(0,i.VK)((()=>a.device.isMobile&&!a.device.isTablet),[a]),f=(0,i.VK)((()=>n===s.l?"20vh":p.ZP.defaultPageCoverHeight(a)),[a,n]),v=(0,r.yK)((()=>{const e=m?24:n===s.R?48:96,t=(()=>{switch(!0){case m:return 32;case c:return 96;case n===s.l&&!c:return 54;case!c:return 102}})(),o=(()=>{switch(!0){case m&&l&&c:return 22;case m&&l&&!c:return 54;case m&&!l&&c:return 56;case m&&!l&&!c:return 4;case!m&&l&&c:return 50;case!m&&l&&!c:return 58;case!m&&!l&&c:return 92;case!m&&!l&&!c:return 20}})();return{collectionCoverPhoto:{width:"100%",height:"20vh"},collectionTitleContainer:{display:"flex",alignItems:"center",paddingLeft:e,paddingRight:e,width:"100%",paddingTop:(()=>{switch(!0){case m&&l:return 50;case m&&!l:return 78;case!m&&l:return 48;case!m&&!l:return 36}})()},collectionIcon:{flexGrow:0,flexShrink:0,width:36,height:36,borderRadius:6,marginRight:10,marginLeft:3},collectionTitle:{height:m?24:30,width:600,marginTop:m?6:3,borderRadius:15},pageCoverPhoto:{width:"100%",height:f},pageCoverPadding:{width:"100%",height:t},pageIconContainer:{maxWidth:"100%",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:g?"100%":900,height:36},pageIcon:{position:"relative",top:l?-42:0,width:78,height:78,marginLeft:2,borderRadius:16},pageTitleContainer:{display:"flex",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:g?"100%":900,maxWidth:"100%",paddingTop:o},pageTitle:{marginTop:m?3:0,height:m?24:30,width:600,borderRadius:15}}}),[g,l,c,f,m,n]);return u||n===s.R?(0,h.jsxs)(h.Fragment,{children:[l&&(0,h.jsx)(d.Z,{style:v.collectionCoverPhoto}),(0,h.jsxs)("div",{style:v.collectionTitleContainer,children:[c&&(0,h.jsx)(d.Z,{emphasized:!0,style:v.collectionIcon}),(0,h.jsx)(d.Z,{style:v.collectionTitle})]})]}):(0,h.jsxs)(h.Fragment,{children:[l?(0,h.jsx)(d.Z,{style:v.pageCoverPhoto}):(0,h.jsx)("div",{style:v.pageCoverPadding}),c&&(0,h.jsx)("div",{style:v.pageIconContainer,children:(0,h.jsx)(d.Z,{emphasized:!0,style:v.pageIcon})}),(0,h.jsx)("div",{style:v.pageTitleContainer,children:(0,h.jsx)(d.Z,{style:v.pageTitle})})]})}const f=!1;function v(e){let{isVisible:t,peekMode:n,store:d}=e;const v=(0,o.O7)(),b=(0,o.Fy)(),S=(0,l.useIntl)(),y=b.isMobile&&!b.isTablet,C=b.isMobileNative,w=a.R6(b.isElectronMac),k=(0,r.yK)((()=>({root:{position:"absolute",top:n===s.l||n===s.R||y?`calc(${w}px + env(safe-area-inset-top))`:"env(safe-area-inset-top)",bottom:"env(safe-area-inset-bottom)",left:"env(safe-area-inset-left)",right:"env(safe-area-inset-right)",display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:"none"}})),[n,y,w]),x=(0,i.VK)((()=>p.ZP.paddingBottom(v)),[v]),M=!C||f;return(0,c.Z)(t,M?C?0:10:100,0)?(0,h.jsx)("div",{role:"progressbar","aria-valuetext":S.formatMessage({id:"frameLoadingState.loading",defaultMessage:"Loading..."}),style:{...k.root,...M?{}:{justifyContent:"center"}},children:M?(0,h.jsx)(m,{store:d,peekMode:n}):(0,h.jsx)(u.Z,{style:{zIndex:1,opacity:.5,width:g,height:g,...void 0===n&&{marginTop:`calc(-${g} / 2 - ${x}px / 2)`,marginBottom:24,marginLeft:"auto",marginRight:"auto"}}})},"shimmer"):null}},69206:(e,t,n)=>{n.d(t,{Z:()=>oe});n(21703);var o=n(73935),i=n(83355),r=n(1302),s=n(92996),a=n(41432),l=n(92595),c=n(62193),d=n(45953),u=n(23867),p=n(57347),h=n(53965),g=n(37850),m=n(32603),f=n(20073),v=n(25320),b=n(4408),S=n(3898),y=n(54642);var C=n(61202),w=n(4437),k=n(11599),x=n(92283),M=(n(57658),n(16691)),R=n(64572),I=n(92516),P=n(73360),L=n(606),T=n(98963),_=n(18844),A=n(21202),Z=n(6287),j=n(13493),B=n(70279),V=n(33709),E=n(19889),q=n(70203);var K=n(95477),O=n(45950),D=n(5659),N=n(32223),U=n(69151),F=n(83055);async function z(e){const{environment:t,request:n,abortSignal:o,prefetchCacheKey:i}=e;return(0,F.Bx)(),N.isConnected()||N.isConnecting()?y.loadCachedPageChunk(t,n,void 0,void 0,o,i):y.loadPageChunk(t,function(e){return{...e,page:{id:e.page.id,spaceId:(0,u.C)(void 0)}}}(n),void 0,void 0,o,i)}async function W(e){const{environment:t,request:n,prefetchPromise:o,abortSignal:i,useInMemoryCacheOnly:r,isRacingWithAnotherRequest:s}=e,l=d.PF.create(),c=await async function(e,t,n){let o;o=e.cursor?h.Xh(e.cursor.stack):[];const i=e.page.id,r=e.limit,s=d.Ak.create();0===o.length&&o.push([{table:A.iU,id:i,index:0}]);let l=0,c=0;const u=I.s.fromMonomorphicFunctionUnsafe((async e=>{const n=s.getModel(e);if(c+=1,n)return n;const o=await t(e);return s.setModel(e,o),o&&await g(o),o})),p=new Set,g=async function(t){const o=[];if((0,P.tz)(t)){const e=t.getParentPointer();o.push([e,"Block parent_id"])}if(t.table===A.iU){const n=t.getCollectionViewPointers();for(const e of n)o.push([e,"CollectionViewBlock view_id"]);const i=t.getCollectionPointer();i&&o.push([i,"CollectionViewBlock collection_id"]);const r=t.getDiscussionPointers();for(const e of r)o.push([e,"Discussion"]);const s=t.getProperties().title;if((0,a.XD)(t.getType())&&s){const n=q.lzi(s),i=h.G0(...n.map(q.hDy));for(const r of i){if(q.STW(r)&&o.push([{table:A.iU,id:q.TOT(r)},"page annotation"]),q.IWo(r)&&o.push([{table:E.KJ,id:q.zEN(r)},"user annotation"]),q.j0F(r)){const t=q.zW$(r),n=(0,R.A5)({url:t,baseUrl:e.baseUrl,publicDomainName:e.publicDomainName});n&&o.push([{table:A.iU,id:n},"link annotation"])}if(q.nSN(r)){const e=q.frW(r);e&&o.push([{table:A.iU,id:e,spaceId:t.space_id},"eoi annotation"])}}}if(t.getType()===a.Ti.alias){const e=t.getAliasTargetPointer();e&&o.push([e,"alias"])}else if(t.isExternalObjectInstanceType()){const e=t.getExternalObjectSubInstancePointers();for(const t of e)o.push([t,"eoi"])}else if(t.getType()===a.Ti.button){const e=t.getAutomationPointer();e&&o.push([e,"button_automation"])}}else if(t.table===V.qF){for(const e of t.getCommentPointers())o.push([e,"discussion table comment"]);for(const e of t.getReactionPointers())o.push([e,"discussion table reaction"])}else if(t.table===B.x_){for(const e of t.getContentPointers())o.push([e,"comment table attachment"]);for(const e of t.getReactionPointers())o.push([e,"comment table reaction"])}else if(t.table===j.np){const e=t.getFormatStore().getKeyStore("collection_pointer").getValue();e&&o.push([e,"CollectionView collection_id"])}else if(t.table===T.cv){const e=t.getActionPointers();for(const t of e)o.push([t,"Automation action_ids"])}else if(t.table===_.Xj)for(const e of t.getBlocks())o.push([{table:A.iU,id:e},"Automation action blocks"]);else if(t.table===Z.vF)for(const e of t.getAutomationPointers())o.push([e,"Collection automation_ids"]);await Promise.all(o.filter((e=>{let[t,n]=e;const o=(0,M.dn)(t);return!p.has(o)&&(p.add(o),!0)})).map((e=>{let[o,i]=e;return n&&n({table:t.table,id:t.id},o,i),o})).map(u))},m=async function(){const t=[],s=o[o.length-1];if(l>=r&&c>10*r||!s)return!1;const d=await Promise.all(s.map((async e=>{const{table:t,id:n}=e,o=L.dr.fromPointerLike({table:t,id:n});return await u(o)}))),p=[];for(let n=0;n<s.length;n++){const r=s[n],l=d[n];if(!l||l.table!==A.iU)continue;const c=null==l?void 0:l.getContentIds(),u=null==l?void 0:l.getFormat();if(!e.verticalColumns&&l&&c&&"column_list"===l.type&&0===r.index){for(let e=0;e<c.length;e++){const n=c[e];p.push([{table:A.iU,id:n},r,"column"]),t.push({table:A.iU,id:n,index:0})}r.index=c.length}else if(l&&"transclusion_reference"===l.type&&u&&u.transclusion_reference_pointer&&0===r.index)p.push([u.transclusion_reference_pointer,r,"transclusion reference"]),t.push({...u.transclusion_reference_pointer,index:0}),r.index=1;else if(l&&c&&(0,a.Um)(l.type,u)&&(l.id===i&&1===o.length||!(0,a.Pm)(l.type)&&!(0,a.BX)(l.type,u))&&c[r.index]){const e=c[r.index];p.push([{table:A.iU,id:e},r,"block content child"]),t.push({table:A.iU,id:e,index:0}),r.index++}}await Promise.all(p.map((e=>{let[t,o,i]=e;return n&&n(o,t,i),t})).map(u));const h=t.filter((e=>{for(let t=0;t<o.length;t++){const n=o[t];for(let t=0;t<n.length;t++){const o=n[t];if(o.table===e.table&&o.id===e.id)return!1}}return!0}));return h.length>0?(o.push(h),l++):o.pop(),!0};for(;await m(););return{recordMap:s,cursorValue:{stack:o}}}({...n,baseUrl:K.default.domainBaseUrl,publicDomainName:K.default.publicDomainName},I.s.fromMonomorphicFunctionUnsafe((async e=>{const n=await O.Ye({environment:t,pointer:e,prefetchPromise:o,useInMemoryCacheOnly:r,isRacingWithAnotherRequest:s});if(null!=i&&i.aborted)throw new Error("Abort signal received");if(n)return l.setModelAndRole(e,n.model,n.role),n.model;throw new Error(`Record not found: ${e.table},${e.id}`)})),D.A.enableLogging?(e,t,n)=>{console.log(`Spidering from ${e.table}:${e.id} to ${t.table}:${t.id} (${n})`)}:void 0);return{recordMap:l.toJson({allowVersionDowngrade:!1}),cursor:c.cursorValue}}var H=n(77546),$=n(77282),G=n(95802),J=n(88632),Y=n(77080),X=n(79167),Q=n(77144),ee=n(93220);let te=!1;(0,l.exposeDebugValue)("toggleLogLocalPageLoadFailures",(()=>{te=!te,console.info(te?"Local page load error logging enabled":"Local page load error logging disabled")}));class ne extends i.Z{constructor(){super(...arguments),this.lastTimeout=void 0,this.node=void 0,this.scrollableAncestor=void 0,this.isCollectionInPage=!1,this.trackPage=new c.EJ("trackPage"),this.aiContextActions=new c.EJ("aiContextActions"),this.storeTypes={store:ee.Z},this.handleConnectionStateChange=()=>{const{store:e}=this.stores,t=J.Z.state.online;t&&!this.lastOnlineState&&e.state.error&&(e.reset(),this.requestNextChunk()),this.lastOnlineState=t},this.onReady=h.IH(this.props.onReady?this.props.onReady:()=>{}),this.onDone=h.IH(this.props.onDone?this.props.onDone:()=>{}),this.requestNextChunk=async()=>{const{loading:e,endOfResultsReached:t,initialRequestCompleted:n,currentCursor:o,currentChunkNumber:i,ready:s,error:a}=this.stores.store.state,{incrementChunkSize:l,initialChunkSize:c}=this.props;if(e||t||n&&a)return;this.stores.store.setState({...this.stores.store.state,loading:!0});const d=n?l:c;let u;n||Q.Z.state.initialRenderCompleted||this.environment.device.isAndroid||(u=new g._W(async function(e,t){const n=e.currentUser.id;if(!n||!e.defaultRecordCache.persistedRecordCache)return Promise.resolve(void 0);(await e.defaultRecordCache.persistedRecordCache.getPageBlocksByParent({page:t,userId:n})).forEach((t=>{e.defaultRecordCache.inMemoryRecordCache.setRecord({pointer:t.pointer,userId:t.userId},t.value),e.defaultRecordCache.inMemoryRecordCache.emitRecord(t.pointer,[]),U.unsubscribeAfterDelay({environment:e,pointer:t.pointer,userId:t.userId})}))}(this.environment,{id:this.props.pageStore.id,table:this.props.pageStore.table})));try{const e=await this.requestPageChunk(d,o,i||0,u);n&&await r.default.afterNextFlush();const t=this.isScrolledToPosition()&&(!(h=this.props.scrollToBlockIds)||G.C.findSelectablesFromIds(h).length===h.length),a=s||!e||t;!s&&a&&r.default.afterNextFlush((()=>{r.default.afterNextFlush((()=>{this.onReady()}))}));const l=!e;this.stores.store.setState({...this.stores.store.state,ready:a,initialRequestCompleted:!0,loading:!1,currentCursor:e?e.cursor:void 0,currentChunkNumber:e?e.chunkNumber:void 0,endOfResultsReached:l,error:void 0}),l&&this.onDone()}catch(m){this.stores.store.setState({...this.stores.store.state,ready:!0,initialRequestCompleted:!0,loading:!1,error:(0,p.t)(m)})}var h},this.requestPageChunk=async(e,t,n,o)=>{const{device:i}=this.environment,{pageStore:r}=this.props,l=(0,u.C)(r.pointer.spaceId),c={page:{id:r.id,spaceId:l},limit:e,cursor:t||{stack:[]},chunkNumber:n,verticalColumns:i.isMobile},d=t?Promise.resolve(void 0):async function(e,t){e&&await S.Nz(t,e)}(this.props.scrollToBlockIds,this.props.pageStore),p=this.environment.prefetchCache.isEnabled&&!Q.Z.state.initialRenderCompleted||Q.Z.state.initialRenderCompleted&&Y.default.checkGate("navigation_render_parallel_requests")?this.performLocalOrRemoteLoadPageChunkInParallel({request:c,initialPreloadPromise:o}):this.performLocalOrRemoteLoadPageChunkSerially({request:c,initialPreloadPromise:o});m.setSubMetric({name:"render_end_to_await_page_chunk_start",startTime:e=>{var t;return null===(t=e.render_start_to_render_end)||void 0===t?void 0:t.endTime},endTime:performance.now()});const h=await p;if(!h)throw new Error("No successful load result found.");if(!Q.Z.state.initialRenderCompleted&&0===n){m.setSubMetric({name:"await_page_chunk_start_to_await_page_chunk_end",startTime:e=>{var t;return null===(t=e.render_end_to_await_page_chunk_start)||void 0===t?void 0:t.endTime},endTime:performance.now()});const e=this.environment.prefetchCache;m.updateMetricData({page_chunk_source:h.source,page_chunk_prefetch:e.isEnabled?e.getPrefetchAnalytic("initialLoadPageChunk"):{type:"disabled"}})}if(this.environment.currentUser.isLoggedIn()){X.Z.addFromRecordMapWithRole(h.recordMap),X.Z.isEmpty()||C.dY({environment:this.environment});const e=r.getFormat(),t=r.getType();(0,x.K)()&&t&&(0,a.dM)(t)&&((null==e?void 0:e.app_config_uri)===s.NB||(null==e?void 0:e.app_config_uri)===s.Aw)&&await async function(e,t){await y.resyncJiraCollection(e,{pagePointer:t})}(this.environment,r.pointer)}const v=performance.now();await(0,g.aM)(d,5e3),Q.Z.state.initialRenderCompleted||0!==n||m.updateMetricData({scroll_to_blocks_wait_time:performance.now()-v}),f.O({rootStore:r,cursors:[h.cursor]});const b=h.cursor.stack.length>0?h.cursor:void 0;if(b)return{cursor:b,chunkNumber:n+1}}}shouldComponentUpdate(){return!0}didMount(){super.didMount(),this.lastOnlineState=J.Z.state.online,this.node=o.findDOMNode(this),this.scrollableAncestor=(0,H.VW)(this.node),J.Z.addListener(this.handleConnectionStateChange)}didMountOrUpdate(){super.didMountOrUpdate();const{pageStore:e}=this.props,{initialRequestCompleted:t,endOfResultsReached:n,error:o}=this.stores.store.state;this.trackPage.effect((()=>{if(e.useCrdt()&&t&&!o)return $.Z.trackPage(e),()=>$.Z.untrackPage(e)}),[e.id,e.useCrdt(),t,o]),this.aiContextActions.effect((()=>{n&&!o&&w.N2({environment:this.environment,blockStore:e})}),[e,n]),this.requestNextChunk()}willUnmount(){super.willUnmount(),this.lastTimeout&&window.clearTimeout(this.lastTimeout),J.Z.removeListener(this.handleConnectionStateChange),this.trackPage.unmount(),this.aiContextActions.unmount()}renderComponent(){const{ready:e,error:t,initialRequestCompleted:n,endOfResultsReached:o}=this.stores.store.state;return this.props.render({error:t,ready:e,initialRequestCompleted:n,endOfResultsReached:o,isCollectionInPage:this.isCollectionInPage})}async performRemoteLoadPageChunk(e){const{request:t,abortSignal:n}=e,{pageStore:o,pageVisitStore:i}=this.props,r=z({environment:this.environment,request:t,abortSignal:n,prefetchCacheKey:this.prefetchCacheKey(t)});if(this.isInitialLoad(t)){v.Ri(this.environment,{block:o,pageVisitStore:i,incremental:!1}).catch((()=>{}));const e=k.A$("backlinks","section_show");await ie({environment:this.environment,blockPointer:o.pointer,shouldAwaitLoaded:!!e&&{primaryRequestPromise:r,maxMsToWaitAfterPrimaryRequestResolved:1e3}})}const s=await r;if("success"===s.type){const e=d.PF.create(s.data.recordMap);return this.isCollectionInPage=this.didLoadANonParentCollection(t.page,e,o.inMemoryRecordCache),{recordMap:e,cursor:s.data.cursor,source:"remote"}}}async performLocalLoadPageChunk(e){const{request:t,initialPreloadPromise:n,abortSignal:o,useInMemoryCacheOnly:i,isRacingWithAnotherRequest:r}=e,{pageStore:s}=this.props;try{const e=D.A.measure("localLoadPageChunk",`${t.page.id} ${t.cursor.stack.length}`,(()=>W({environment:this.environment,request:t,prefetchPromise:n,abortSignal:o,useInMemoryCacheOnly:i,isRacingWithAnotherRequest:r})));if(0===t.chunkNumber){const t=k.A$("backlinks","section_show");await ie({environment:this.environment,blockPointer:s.pointer,shouldAwaitLoaded:!!t&&{primaryRequestPromise:e,maxMsToWaitAfterPrimaryRequestResolved:1e3}})}const a=await e,l=d.PF.create(a.recordMap);return b.fL({environment:this.environment,inMemoryRecordCache:s.inMemoryRecordCache,recordMap:l,debugSource:"PageLoadaingContainer.performLocalLoadPageChunk"}),this.isCollectionInPage=this.didLoadANonParentCollection(t.page,l,s.inMemoryRecordCache),{cursor:a.cursor,recordMap:l,source:"local"}}catch(a){te&&console.error(a)}}didLoadANonParentCollection(e,t,n){var o;if(this.isCollectionInPage)return!0;const i=null===(o=n.getRecord({pointer:{table:"block",id:e.id,spaceId:e.spaceId},userId:this.environment.currentUser.id}))||void 0===o?void 0:o.value;if(i)for(const l of t.getByTable("block")){var r,s,a;if(("collection_view"===(null===(r=l.value)||void 0===r||null===(r=r.value)||void 0===r?void 0:r.type)||"collection_view_page"===(null===(s=l.value)||void 0===s||null===(s=s.value)||void 0===s?void 0:s.type))&&i.parent_id!==(null===(a=l.value)||void 0===a||null===(a=a.value)||void 0===a?void 0:a.collection_id))return!0}return!1}async performLocalOrRemoteLoadPageChunkInParallel(e){const t=await this.performLocalLoadPageChunk({...e,useInMemoryCacheOnly:!0,isRacingWithAnotherRequest:!1});if(t)return t;const n=this.prefetchCacheKey(e.request),o=n?this.environment.prefetchCache.getPrefetchStatus(n):void 0,i=new AbortController,r=this.performRemoteLoadPageChunk({...e,abortSignal:i.signal});if(!this.environment.defaultRecordCache.persistedRecordCache)return await r;if(n&&"success"===o)return await r;const s=new AbortController,a=[{promise:this.performLocalLoadPageChunk({...e,abortSignal:s.signal,isRacingWithAnotherRequest:!0}),abortController:s},{promise:r,abortController:i}],{winner:l}=await(0,g.S3)(a.map((e=>e.promise))),c=0===l?1:0,d=a[l],u=a[c],p=await d.promise;return p?(u.abortController.abort(),p):await u.promise}async performLocalOrRemoteLoadPageChunkSerially(e){const t=await this.performLocalLoadPageChunk({...e,isRacingWithAnotherRequest:!1});return t||await this.performRemoteLoadPageChunk(e)}isScrolledToPosition(){const{scrollToPosition:e}=this.props;return!this.scrollableAncestor||!h.hj(e)||e<=this.scrollableAncestor.scrollHeight-this.scrollableAncestor.clientHeight}isInitialLoad(e){return 0===e.chunkNumber}prefetchCacheKey(e){return this.isInitialLoad(e)?"initialLoadPageChunk":void 0}}ne.displayName="PageLoadingContainer";const oe=ne;async function ie(e){const{blockPointer:t,environment:n,shouldAwaitLoaded:o}=e;if(n.LocalBacklinkStore.initializeBacklinks({block:{id:t.id,spaceId:(0,u.C)(t.spaceId)},currentUserId:n.currentUser.id,environment:n}),!o)return;const i=n.LocalBacklinkStore.awaitLoaded(t.id).catch((()=>{})),{primaryRequestPromise:r,maxMsToWaitAfterPrimaryRequestResolved:s}=o;await r.then((()=>(0,g.aM)(i,s)))}},78901:(e,t,n)=>{n.d(t,{Z:()=>D});n(57658);var o=n(67294),i=n(480),r=n(86628),s=n(24405),a=n(19889),l=n(51454),c=n(9291),d=n(53965),u=n(1898),p=n(48514),h=n(83420),g=n(20095),m=n(17504),f=n(65598),v=n(439),b=n(5971),S=n(95802),y=n(80444),C=n(24229),w=n(17903),k=n(22294),x=n(42057),M=n(6258),R=n(86486),I=n(27724),P=n(24666),L=n(23063),T=n(9612),_=n(68930),A=n(45653),Z=n(65200),j=n(85893);const B={position:"absolute",top:0,left:0,zIndex:l.eu},V=18,E=20,q=24,K=38,O=15;const D=function(e){const{pageVisitStore:t,presenceStore:n}=e,s=(0,i.O7)(),{isMobile:a}=s.device,l=(0,o.useRef)(null),c=(0,b.E)("block_attribution"),u=(0,r.SI)((()=>{var t;if(!c)return[];const o=e.isPeekView?x.Z:w.Z,i=o.state.scrollTop-5e3,r=i+((null===(t=o.state.clientRect)||void 0===t?void 0:t.height)||0)+5e3,s=function(e){var t;const{blockAttributionEnabled:n,containerEl:o,presenceStore:i}=e,{currentUserSettingsStore:r}=y.default.state,s=(null==r||null===(t=r.getSettings())||void 0===t?void 0:t.show_block_attribution)??!0;if(!n||!s)return[];const{rootStore:a}=i.state;if(!o||!a||"editing"!==P.default.state.mode||p.Z.state.open||C.Z.state.open||k.Z.state.isKeyboardMode)return[];let l;for(const d of I.default.state.stores){const e=d.findRecordStoreUIAncestor((e=>e instanceof M.G&&e.isTransclusionType())).ancestor;e&&e instanceof M.G&&"transclusion_container"===e.getType()&&(l=e)}const c=S.C.getMembersByDOMOrder({filter:()=>!0}),u=o.getBoundingClientRect(),h=f.MI({blockStore:a,traverseTransclusionReferences:!1}).flatMap((e=>{const t=[];if(e.isInsideTransclusion()||e.isTransclusionType()){let n=e;if("transclusion_reference"===e.getType()){const t=e.getTransclusionReferenceTargetStore();t&&(n=t)}"transclusion_reference"!==e.getType()&&"transclusion_container"!==e.getType()||(n!==l?t.push(U(e,c,u)):f.MI({blockStore:n,traverseTransclusionReferences:!1}).map((e=>t.push(U(e,c,u)))))}else t.push(U(e,c,u));return t})).filter((e=>!d.o8(e)));h.sort(((e,t)=>e.top-t.top));const g=h.filter(((e,t,n)=>0===t||e.actor.id!==n[t-1].actor.id));if(1===g.length)return[];return g}({blockAttributionEnabled:c,containerEl:l.current,presenceStore:n});s.sort(((e,t)=>e.top-t.top));const a=[];return s.every((e=>e.top>=i&&e.top<=r&&(a.push(e),!0))),a}),[c,n,e.isPeekView],{debugName:"attributionAvatarStore",useDeepEqual:!0});(0,o.useEffect)((()=>{let e;const t=d.Ds(u.recompute,100);return c&&(window.addEventListener("resize",t),e=setInterval(t,1e3)),()=>{window.removeEventListener("resize",t),clearInterval(e)}}),[u,c]);const h=(0,r.Kw)(u),m=[...(0,r.VK)((()=>function(e){const{attributionAvatars:t,pageVisitStore:n,presenceStore:o,environment:i,containerEl:r}=e,s=new Set(t.map((e=>{let{blockStore:t}=e;return t.id}))),{rootStore:a}=o.state;if(!a)return[];if(!r)return[];const l=i.currentUser.id,c=(0,g.AQ)(n,o).filter((e=>e.userId!==l&&(0,g.MR)(i,e)));if(c.length>0){const e={},t=S.C.getMembersByDOMOrder({filter:()=>!0}),n=r.getBoundingClientRect(),o=R.default.state;return d.oA(c.map((i=>{const r=(0,g.EB)(i),l=null==i?void 0:i.blockPath;let c;if(l&&l.length>0?c=function(e,t,n){const o=new Map(t.map(((e,t)=>[e,t])));let i,r;for(const s of e){const e=s.props.store,t=o.get(e.id);if(void 0!==t&&((void 0===r||t<r)&&n.uiContains(e)&&s.props.shouldShowHalo&&(i=s,r=t),0===r))return i}return i}(t,l,a):r&&(c=N(t,r,a)),!c)return;const d=c.props.store.id;e.hasOwnProperty(d)||(e[d]=0),e[d]++;const u=c.getNode();if(!(u&&u instanceof Element))return;const p=u.getBoundingClientRect(),h=o.isOpen&&o.currentStore.id===d?K:0,m=s.has(d)?1:0;if(p){let t=p.left-n.left-h;const o=c.getContextHorizontalScroller();if(o){const e=o.stores.store.state.clientRect,i=null==e?void 0:e.left,r=null==e?void 0:e.right;if(r&&p.left>r)return;i&&(t=Math.max(i-n.left-h,t))}return{type:"presence",userId:i.userId,left:t,top:p.top-n.top+(e[d]+m-1)*O,blockType:c.props.store.getType()}}})))}return[]}({attributionAvatars:h,pageVisitStore:t,presenceStore:n,environment:s,containerEl:l.current})),[s,t,n,h],{debugName:"presenceAvatars",useDeepEqual:!0}),...h];return(0,j.jsx)("div",{className:"notion-presence-container",style:B,ref:l,children:(0,j.jsx)(T.Z,{render:()=>m.map((t=>{const{left:n,top:o}=t,i={avatarWrapperAnimation:{translateX:a?n-21:n-28,translateY:a?o+5:o+3,scale:1,opacity:1},avatarEnterExitAnimation:{scale:.7,opacity:0}},r={...i.avatarWrapperAnimation,...i.avatarEnterExitAnimation};return(0,j.jsx)(L.Z,{isVisible:!0,enterAnimationStyle:r,exitAnimationStyle:r,animationStyle:i.avatarWrapperAnimation,render:()=>(0,j.jsx)(F,{avatar:t,presenceStore:e.presenceStore})},"attribution"===t.type?t.uniqueId:t.userId)}))})})};function N(e,t,n){return e.find((e=>{const o=e.props.store;return Boolean(o&&o.id===t&&n.uiContains(o)&&e.props.shouldShowHalo)}))}function U(e,t,n){const o=e.getLastEditedByPointer(),i=R.default.state;if(!o||o.table!==a.KJ)return;const r=N(t,e.id,e);if(!r)return;const s=e.getType();if("collection_view"===s||"collection_view_page"===s||"divider"===s||"table"===s||"table_row"===s||"tab"===s)return;if(e.isEmptyEditableBlock())return;const l=r.getNode();if(!(l&&l instanceof Element))return;const c=l.getBoundingClientRect();if(!c)return;const d=i.isOpen&&i.currentStore===e?K:0,u=(0,v.zt)((0,v.oJ)(e),e),p=(Z.Z.height-V)/2,h=c.top-n.top+u-p,g=c.left-n.left;return d>0?{type:"attribution",actor:o,left:g-d,top:h,uniqueId:`${String(e.key)}+left`,blockStore:e}:{type:"attribution",actor:o,left:g,top:h,uniqueId:String(e.key),blockStore:e}}function F(e){const{device:t}=(0,i.O7)(),{isMobile:n}=t,{avatar:o}=e,l=(0,c.useIntl)(),d=(0,b.E)("presence_avatar_tooltips"),p="presence"===o.type&&o.blockType?o.blockType:void 0,g=n?E:q,f=(0,s.yK)((()=>{const e=p&&["breadcrumb","bulleted_list","numbered_list","toggle"].includes(p);return{avatarWrapper:{position:"absolute",top:0,left:n&&e?3:0,width:g,height:g},avatar:{width:g,height:g}}}),[n,p,g]),v=(0,r.VK)((()=>{const{rootStore:t}=e.presenceStore.state;if(t){if("presence"===o.type){const e=M.U6.createChildStore(t,{table:a.KJ,id:o.userId});return e.isDefined()?{type:"presence",userStore:e}:null}if("attribution"===o.type){const e=(0,h.nc)({parentStore:t,pointer:o.actor,debugSrc:"PresenceAvatar attribution"});return e.isDefined()?{type:"attribution",userId:e.id,name:e.getDisplayName(l),blockStore:o.blockStore}:null}(0,u.t1)(o)}return null}),[o,l,e.presenceStore]);return v?(0,m.Z)((e=>(0,j.jsx)("div",{style:f.avatarWrapper,...e,children:"presence"===v.type?(0,j.jsx)(A.Z,{hasTooltip:d,userStore:v.userStore,style:f.avatar,size:g,avatarShouldShowShadow:!0}):(0,j.jsx)(_.Z,{userId:v.userId,name:v.name,style:f.avatar,size:q,tooltipStore:v.blockStore})}))):null}},7401:(e,t,n)=>{n.d(t,{at:()=>r,vo:()=>s});var o=n(77907);const i=o.deps.dictation,r=(0,o.lazyComponent)(i,(e=>e.StopDictationButton)),s=(0,o.lazyComponent)(i,(e=>e.DictationBubble))},64286:(e,t,n)=>{n.d(t,{u:()=>s});var o=n(80444),i=n(77080),r=n(15010);function s(e){const{currentUserSettingsStore:t}=o.default.state;if(!t)return!1;const n=(0,r.e2)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===i.default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},34232:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(67294);function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const[r,s]=(0,o.useState)(i),a=(0,o.useRef)(null),l=(0,o.useRef)(null);return(0,o.useLayoutEffect)((()=>{null!==l.current&&window.clearTimeout(l.current),null!==a.current&&window.clearTimeout(a.current),l.current=null,a.current=null,e?0===t?s(!0):a.current=window.setTimeout((()=>{a.current=null,s(!0)}),t):0===n?s(!1):l.current=window.setTimeout((()=>{l.current=null,s(!1)}),n)}),[e,t,n]),r}},758:(e,t,n)=>{n.d(t,{P:()=>d,x:()=>c});var o=n(27117),i=n.n(o),r=n(54153),s=n(53965),a=n(47839);const l="spellcheckEnabled";function c(e){return e instanceof d}class d{constructor(e){this.langCache=new(i())(100),this.enabled=void 0,this.currentInputElement=void 0,this.handleSelectionChange=()=>{if(this.enabled){const e=this.getInputElement();e&&e!==this.currentInputElement?(this.currentInputElement=e,this.handleDetectLanguageChange(e)):e&&this.handleDetectLanguageChangeThrottled(e)}},this.handleDetectLanguageChange=e=>{const t=e.textContent;if(t){let e=this.detectLanguages(t);void 0!==e&&(e=e.map((e=>navigator.language.startsWith(e)?navigator.language:e))),this.setLanguages(e)}},this.handleDetectLanguageChangeThrottled=s.P2(this.handleDetectLanguageChange,500),this.currentLanguages=void 0;const t=r.Z.get(l);this.setEnabled(void 0===t||t);const{isMac:n}=e.device;!n&&a.electronApi&&a.electronApi.loadSpellcheck&&(a.electronApi.loadSpellcheck(),document.addEventListener("selectionchange",this.handleSelectionChange))}setEnabled(e){this.enabled=e,r.Z.set(l,e),a.electronApi&&a.electronApi.setSpellCheckerLanguages&&(e?a.electronApi.setSpellCheckerLanguages(this.getLanguages()):a.electronApi.setSpellCheckerLanguages([]))}isEnabled(){return this.enabled}detectLanguages(e){let t;return this.langCache.cache[e]?(t=this.langCache.get(e),t):(a.electronApi&&a.electronApi.cld&&a.electronApi.cld.detect(e,((e,n)=>{n&&n.reliable&&n.languages&&(t=n.languages.map((e=>e.code)))})),this.langCache.set(e,t),t)}getCorrections(e){return e.dictionarySuggestions}setLanguages(e){s.Xy(this.currentLanguages,e)||(this.currentLanguages=e,a.electronApi&&a.electronApi.setSpellCheckerLanguages&&a.electronApi.setSpellCheckerLanguages(e||[]))}getInputElement(){const e=document.activeElement;if(e instanceof HTMLElement&&("input"===e.tagName||"true"===e.contentEditable))return e}getLanguages(){return navigator.languages.filter((e=>e.includes("-")))}}},33293:(e,t,n)=>{n.d(t,{q:()=>g});var o=n(67294),i=n(86628),r=n(24405),s=n(64275),a=n(9291),l=n(1898),c=n(64921),d=n(50506),u=n(33929),p=n(61254),h=n(85893);function g(e){const{isOpen:t,children:n,onDismiss:a,onClosed:g,style:f,dismissUsing:v}=e,b=function(e){switch(e){case"onlyCloseButton":case"closeButtonOrEscape":return!0;case"onlyEscape":case"none":return!1;default:(0,l.t1)(e)}}(v),[S,y]=function(e,t,n){const r=(0,o.useMemo)((()=>new p.Z),[]),[s,a]=(0,o.useState)(t),l=(0,i.VK)((()=>r.state.open),[r]);return(0,o.useEffect)((()=>{e?a(t):l||(a(void 0),n&&n())}),[e,l,t,n]),[r,s]}(t,n,g),C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.yK)((t=>({cancelButton:{alignItems:"center",background:t.buttonHoveredBackground,borderRadius:"100%",display:"flex",height:20,justifyContent:"center",position:"absolute",right:12,top:12,width:20,zIndex:10},cancelButtonHovered:{background:t.buttonPressedBackground},cancelIcon:{fill:t.mediumTextColor,width:14},innerModal:{borderRadius:10,height:"auto",overflow:"auto",width:300,minHeight:40,padding:"12px 16px",position:"relative",...e}})),[e])}(f),w=(0,o.useCallback)((()=>(0,h.jsxs)(h.Fragment,{children:[b?(0,h.jsx)(c.Z,{hoveredStyle:C.cancelButtonHovered,onClick:()=>a(),style:C.cancelButton,ariaLabel:u.default.formatMessage(m.closeModalAriaLabel),children:(0,s.D)(C.cancelIcon)}):null,y]})),[y,a,b,C.cancelButton,C.cancelButtonHovered,C.cancelIcon]),k=(0,o.useCallback)((()=>{(function(e){switch(e){case"closeButtonOrEscape":case"onlyEscape":return!0;case"onlyCloseButton":case"none":return!1;default:(0,l.t1)(e)}})(v)&&a()}),[v,a]);return(0,h.jsx)(d.Z,{innerStyle:C.innerModal,onDismiss:k,open:t,preventHideChildrenWhileOpening:!0,render:w,store:S,trapFocus:!0})}const m=(0,a.defineMessages)({closeModalAriaLabel:{id:"subscriptions.BillingModal.closeButtonLabel",defaultMessage:"Close modal"}})},49204:(e,t,n)=>{n.d(t,{Id:()=>w,Ng:()=>k,Px:()=>y,ow:()=>C,t_:()=>S,um:()=>b});var o=n(15145),i=n(19889),r=n(9291),s=n(17224),a=n(54642),l=n(9953),c=n(64964),d=n(29974),u=n(13447),p=n(33929),h=n(48779),g=n(80444),m=n(9867),f=n(28517);const v=(0,r.defineMessages)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function b(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const r=o.getSpaceId();if(!r)return;await m.Cj({environment:t,teamId:o.id,spaceId:r,teamMemberInfos:i,isSettingDefaultTeam:!1,inviterId:n})&&(s.UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await S({environment:t,userId:n,teamStore:o}),c.oV({label:p.default.formatMessage(v.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function S(e){let{environment:t,userId:n,teamStore:i}=e;const r=g.default.state.currentUserRootStore,s=i.getSpaceId();if(!s||!r)return;const a=r.getSpaceViewStores().filter((e=>e.getSpaceId()===s))[0];await d.y3({environment:t,spaceViewStore:a,userSettingsStore:void 0,userRootStore:r,pageVisitSource:o.tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await f.I({environment:t,spaceId:s,userId:n}),m.hI({environment:t,teamStore:i,shouldScroll:!0})}async function y(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a.requestAccess(t,{type:"current-actor-to-team",teamId:n,message:o})).type?(s.LB(t,{teamId:n}),await w({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c.oV({label:p.default.formatMessage(v.requestTeamSuccessMessage)})}))):c.oV({label:p.default.formatMessage(v.requestTeamFailureMessage)})}async function C(e){let{environment:t,teamStore:n,accessRequestStore:o,status:r}=e;const a=o.getForActorId();if(!a)return;const c=o.getRecordModel({table:i.KJ,id:a});if(c){if("approved"===r){const e=[{type:"member",entity_type:"user",user_id:c.id}];if(!(await m.Uj({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}u.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{l.sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i.KJ,resolved_by_id:t.currentUser.id,status:r}})}}),s.co(t,{store:n,resolution:r})}}async function w(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:r}=await(0,h.iX)({environment:t,disableRedirectUrl:!1});n?await d.y3({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:r,pageVisitSource:o.tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d.L5({environment:t,userRootStore:i,userSettingsStore:r,pageVisitSource:o.tY.BackForward})}async function k(e){let{environment:t,teamId:n}=e;const o=await a.getTeamAccessRequestMetadata(t,{teamId:n});if("success"===o.type)return o.data}},14889:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(24405),s=n(9291),a=n(74194),l=n(50506),c=n(58297),d=n(64369),u=n(49204),p=n(74016),h=n(85893);const g=(0,s.defineMessages)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const m=function(e){const{teamStore:t,teamName:n,teamId:m,isModalOpen:f,onDismiss:v}=e,[b,S]=(0,o.useState)(""),y=(0,i.O7)(),C=(0,s.useIntl)(),w=async()=>{await u.Px({environment:y,teamId:m,message:b}),v()},k=(0,r.yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,h.jsx)(l.Z,{open:f,onDismiss:v,innerStyle:k.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:k.requestTitle,children:(0,h.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:n,icon:(0,h.jsx)(p.p,{style:k.icon,store:t,disabled:!0,size:22})}})}),(0,h.jsx)(a.Z,{textarea:!0,style:k.input,value:b,onChange:e=>{S(e.target.value)},placeholder:C.formatMessage(g.message_placeholder)}),(0,h.jsxs)("div",{style:k.footer,children:[(0,h.jsx)(d.Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,h.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,h.jsx)(c.Z,{isLarge:!0,style:k.requestInvitesButton,onClick:w,children:(0,h.jsx)(s.FormattedMessage,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},16880:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("chevronUpRounded",{viewBox:"0 0 15 9",svg:(0,i.jsx)("path",{d:"M1.258 6.5L7.203.422a.946.946 0 01.719-.32.99.99 0 01.726.32L14.586 6.5a.89.89 0 01.266.648c0 .524-.407.93-.922.93a.921.921 0 01-.672-.281L7.93 2.32 2.586 7.797a.926.926 0 01-.672.281.915.915 0 01-.922-.93c0-.25.094-.476.266-.648z"})})},64530:(e,t,n)=>{n.d(t,{y:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.IU)("settingsNotificationsAndPersonal",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M12.5361 7.54883C13.2744 7.54883 13.9033 7.09082 14.1631 6.44141H16.4258C16.7607 6.44141 17.0479 6.14746 17.0479 5.79199C17.0479 5.43652 16.7676 5.14258 16.4258 5.14258H14.1699C13.9102 4.49316 13.2744 4.03516 12.5361 4.03516C11.7979 4.03516 11.1621 4.49316 10.9023 5.14258H3.59473C3.23242 5.14258 2.95215 5.43652 2.95215 5.79199C2.95215 6.14746 3.23926 6.44141 3.59473 6.44141H10.9023C11.1621 7.09082 11.7979 7.54883 12.5361 7.54883ZM12.5361 6.62598C12.0713 6.62598 11.6953 6.25684 11.6953 5.79199C11.6953 5.31348 12.0713 4.95117 12.5361 4.95117C13.0078 4.95117 13.3701 5.31348 13.3701 5.79199C13.3701 6.25684 13.0078 6.62598 12.5361 6.62598ZM3.56738 9.40137C3.23242 9.40137 2.95215 9.68848 2.95215 10.0508C2.95215 10.3994 3.23926 10.6934 3.56738 10.6934H5.91211C6.16504 11.3428 6.80078 11.8076 7.5459 11.8076C8.27734 11.8076 8.91309 11.3428 9.17285 10.6934H16.4053C16.7607 10.6934 17.0479 10.4062 17.0479 10.0508C17.0479 9.68848 16.7676 9.40137 16.4053 9.40137H9.17285C8.91309 8.75195 8.27734 8.29395 7.5459 8.29395C6.80762 8.29395 6.17188 8.75195 5.91211 9.40137H3.56738ZM7.5459 10.8848C7.07422 10.8848 6.70508 10.5156 6.70508 10.0508C6.70508 9.57227 7.07422 9.20996 7.5459 9.20996C8.01758 9.20996 8.37988 9.57227 8.37988 10.0508C8.37988 10.5156 8.01758 10.8848 7.5459 10.8848ZM12.5361 16.0596C13.2744 16.0596 13.9102 15.6016 14.1699 14.9521H16.4258C16.7607 14.9521 17.0479 14.6582 17.0479 14.3027C17.0479 13.9404 16.7676 13.6533 16.4258 13.6533H14.1631C13.9102 13.0039 13.2744 12.5459 12.5361 12.5459C11.7979 12.5459 11.1621 13.0039 10.9023 13.6533H3.59473C3.23242 13.6533 2.95215 13.9473 2.95215 14.3027C2.95215 14.6582 3.23926 14.9521 3.59473 14.9521H10.9023C11.1621 15.6016 11.7979 16.0596 12.5361 16.0596ZM12.5361 15.1436C12.0713 15.1436 11.6953 14.7676 11.6953 14.3027C11.6953 13.8311 12.0713 13.4619 12.5361 13.4619C13.0078 13.4619 13.3701 13.8311 13.3701 14.3027C13.3701 14.7676 13.0078 15.1436 12.5361 15.1436Z"})})},72458:(e,t,n)=>{n.d(t,{A:()=>s,Z:()=>r});var o=n(31701),i=n(15095);function r(e){const t=e.name,n=e.email;let o;if(t||n){if(t){const e=t.split(" ").filter((e=>e.length>0));o=e.length>1?String(i.p4(e[0])[0])+String(i.p4(e[e.length-1])[0]):String(i.p4(t)[0])+String(i.p4(t)[1])}else o=null==n?void 0:n.substring(0,2);return o=o?o.toUpperCase():void 0,o}}function s(e,t){return e&&(0,o.iY)(e,t)}}}]);